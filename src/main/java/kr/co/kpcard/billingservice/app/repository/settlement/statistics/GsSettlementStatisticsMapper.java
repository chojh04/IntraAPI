package kr.co.kpcard.billingservice.app.repository.settlement.statistics;

import java.util.List;

import javax.annotation.Resource;

import org.apache.ibatis.annotations.Mapper;
import org.apache.ibatis.annotations.Param;
import org.apache.ibatis.annotations.Select;

import kr.co.kpcard.billingservice.app.repository.settlement.common.Summary;
import kr.co.kpcard.common.utils.JobStatusCode;

@Mapper
public interface GsSettlementStatisticsMapper {

	public static final String GS_STATISTICS_SELECT_SQL =""
		    +"SELECT DECODE(JOB_DIVIDER , 'GSPOP' , 'GS25' , JOB_DIVIDER) jobDivider"
		    +"     , WORK_DT     AS workDt"
		    +"     , STS0001_AMT AS agreeAmt"
		    +"     , STS0001_CNT AS agreeCnt"
		    +"     , STS0002_AMT AS errorAmt"
		    +"     , STS0002_CNT AS errorCnt"
		    +"     , STS0003_AMT AS kpcOnlyAmt"
		    +"     , STS0003_CNT AS kpcOnlyCnt"
		    +"     , STS0004_AMT AS gsOnlyAmt"
		    +"     , STS0004_CNT AS gsOnlyCnt"
		    +"     , CASE WHEN NVL(STS0002_CNT,0) + NVL(STS0003_CNT,0) + NVL(STS0004_CNT,0) = 0"
		    +"            THEN '일치'"
		    +"            ELSE '불일치존재'"
		    +"        END compareResult"
		    +"  FROM ("
		    +"        SELECT A.JOB_DIVIDER"
		    +"             , A.STATUS"
		    +"             , A.WORK_DT"
		    +"             , SUM(NVL(A.ORDER_AMT,0)) SUM_DEAL_AMT"
		    +"             , COUNT(NVL(A.ORDER_AMT,0)) CNT"
		    +"          FROM SETTLE_RESULT A"
		    +"             , SETTLE_GS B"
		    +"         WHERE A.JOB_DIVIDER  = #{jobDivider}"
		    +"           AND A.JOB_DIVIDER  = B.JOB_DIVIDER(+)"
		    +"           AND A.SETTLE_SEQ   = B.SEQ(+)"
		    +"           AND A.WORK_DT      = B.WORK_DT(+)"
		    +"           AND A.DEAL_TYPE    = B.DEAL_TYPE(+)"
		    +"           AND A.DEAL_DIVIDER = B.DEAL_DIVIDER(+)"
		    +"           AND A.WORK_DT BETWEEN TO_CHAR(TO_DATE(#{startDate}),'YYYYMMDD') AND TO_CHAR(TO_DATE(#{endDate}),'YYYYMMDD')"                
		    +"           AND A.STATUS     IN ('STS-0001', 'STS-0002' , 'STS-0003' , 'STS-0004')"
		    +"         GROUP BY A.JOB_DIVIDER , A.WORK_DT , A.STATUS"
		    +"        )"
		    +"  PIVOT ("
		    +"           SUM(SUM_DEAL_AMT) AS AMT , SUM(CNT) AS CNT"
		    +"           FOR STATUS IN ('STS-0001' AS STS0001 , 'STS-0002' AS STS0002 , 'STS-0003' AS STS0003 , 'STS-0004' AS STS0004)"
		    +"  )"
		    +"  ORDER BY WORK_DT ASC";
		    
	public static final String GS_POINT_STATISTICS_SELECT_SQL =""
			+"SELECT JOB_DIVIDER AS jobDivider"
			+"     , WORK_DT     AS workDt"
			+"     , STS0001_AMT AS agreeAmt"
			+"     , STS0001_CNT AS agreeCnt"
			+"     , STS0002_AMT AS errorAmt"
			+"     , STS0002_CNT AS errorCnt"
			+"     , STS0003_AMT AS kpcOnlyAmt"
			+"     , STS0003_CNT AS kpcOnlyCnt"
			+"     , STS0004_AMT AS gsOnlyAmt"
			+"     , STS0004_CNT AS gsOnlyCnt"
			+"     , CASE WHEN STS0002_CNT + STS0003_CNT + STS0004_CNT = 0"
			+"            THEN '불일치없음'"
			+"            ELSE '불일치존재'"
			+"        END compareResult"
			+"  FROM ("
			+"        SELECT A.JOB_DIVIDER"
			+"             , A.STATUS"
			+"             , A.WORK_DT"
			+"             , SUM(NVL(A.ORDER_AMT,0)) SUM_DEAL_AMT"
			+"             , COUNT(NVL(A.ORDER_AMT,0)) CNT"
			+"          FROM SETTLE_RESULT A"
			+"             , SETTLE_GSNPOINT B"
			+"         WHERE A.JOB_DIVIDER = #{jobDivider}"
			+"           AND A.SETTLE_SEQ  = B.SEQ(+)"
			+"           AND A.WORK_DT     = B.WORK_DT(+)"
			+"           AND A.DEAL_DIVIDER= B.DEAL_DIVIDER(+)"
			+"           AND A.WORK_DT BETWEEN TO_CHAR(TO_DATE(#{startDate}),'YYYYMMDD') AND TO_CHAR(TO_DATE(#{endDate}),'YYYYMMDD')"                
			+"           AND A.STATUS     IN ('STS-0001', 'STS-0002' , 'STS-0003' , 'STS-0004')"
			+"         GROUP BY A.JOB_DIVIDER , A.WORK_DT , A.STATUS"
			+"        )"
			+"  PIVOT ("
			+"           SUM(SUM_DEAL_AMT) AS AMT , SUM(CNT) AS CNT"
			+"           FOR STATUS IN ('STS-0001' AS STS0001 , 'STS-0002' AS STS0002 , 'STS-0003' AS STS0003 , 'STS-0004' AS STS0004)"
			+"  )"
	        +"  ORDER BY WORK_DT DESC";
	
	public static final String HM_STATISTICS_SELECT_SQL =""
			+"SELECT JOB_DIVIDER AS jobDivider"
			+"     , WORK_DT     AS workDt"
			+"     , STS0001_AMT AS agreeAmt"
			+"     , STS0001_CNT AS agreeCnt"
			+"     , STS0002_AMT AS errorAmt"
			+"     , STS0002_CNT AS errorCnt"
			+"     , STS0003_AMT AS kpcOnlyAmt"
			+"     , STS0003_CNT AS kpcOnlyCnt"
			+"     , STS0005_AMT AS gsOnlyAmt"
			+"     , STS0005_CNT AS gsOnlyCnt"
			+"     , CASE WHEN STS0002_CNT + STS0003_CNT + STS0005_CNT = 0"
			+"            THEN '불일치없음'"
			+"            ELSE '불일치존재'"
			+"        END compareResult"
			+"  FROM ("
			+"        SELECT A.JOB_DIVIDER"
			+"             , A.STATUS"
			+"             , A.WORK_DT"
			+"             , SUM(NVL(A.ORDER_AMT,0)) SUM_DEAL_AMT"
			+"             , COUNT(NVL(A.ORDER_AMT,0)) CNT"
			+"          FROM SETTLE_RESULT A"
			+"             , SETTLE_HM B"
			+"         WHERE A.JOB_DIVIDER = #{jobDivider}"
			+"           AND A.SETTLE_SEQ  = B.SEQ(+)"
			+"           AND A.WORK_DT     = B.WORK_DT(+)"
			+"           AND A.DEAL_TYPE   = B.STATUS(+)"
			+"           AND A.WORK_DT BETWEEN TO_CHAR(TO_DATE(#{startDate}),'YYYYMMDD') AND TO_CHAR(TO_DATE(#{endDate}),'YYYYMMDD')"                
			+"           AND A.STATUS     IN ('STS-0001', 'STS-0002' , 'STS-0003' , 'STS-0005')"
			+"         GROUP BY A.JOB_DIVIDER , A.WORK_DT , A.STATUS"
			+"        )"
			+"  PIVOT ("
			+"           SUM(SUM_DEAL_AMT) AS AMT , SUM(CNT) AS CNT"
			+"           FOR STATUS IN ('STS-0001' AS STS0001 , 'STS-0002' AS STS0002 , 'STS-0003' AS STS0003 , 'STS-0005' AS STS0005)"
			+"  )"
	        +"  ORDER BY WORK_DT DESC";	
	
	public static final String GS_SM_ERROR_DETAIL_SELECT_SQL =""
			+"SELECT Z.*"
			+"  FROM ( SELECT ROWNUM AS RNUM" 
			+"               ,DECODE(X.jobDivider , 'GSPOP' , 'GS25' , X.jobDivider) jobDivider"     
			+"               ,X.saleDt"         
			+"               ,X.storeCd"
			+"               ,(SELECT MAX(CP_NAME) FROM PG_CP WHERE CP_ID = X.storeCd) storeNm"
			+"               ,DECODE(X.dealType , 'ACT','활성화', 'CHR','재충전', 'PAY','결제', 'REF','잔액환불', 'TRN','잔액이체') dealType"
			+"               ,CASE WHEN X.jobDivider = 'GSPOINT'"
			+"                     THEN DECODE(X.dealDivider , '1' , '사용' , '2' , '취소', X.dealDivider)"
			+"                     ELSE DECODE(X.dealDivider , '0' , '승인' , '9' , '취소' ,X.dealDivider)"
			+"                 END dealDivider"
			+"               ,X.dealNo"         
			+"               ,X.approvalNo"     
			+"               ,X.approvalDt"     
			+"               ,X.approvalTime"   
			+"               ,X.dealAmt"        
			+"               ,X.cardNo"         
			+"               ,X.statusNm"       
			+"               ,X.statusDesc" 
			+"           FROM ("
			+"	                SELECT B.JOB_DIVIDER                            jobDivider"
			+"	                      ,A.SALE_DT                                saleDt"
			+"	                      ,A.STORE_CD                               storeCd"
			+"	                      ,A.DEAL_TYPE                              dealType"
			+"	                      ,A.DEAL_DIVIDER                           dealDivider"
			+"	                      ,A.DEAL_NO                                dealNo"
			+"	                      ,A.APPROVAL_NO                            approvalNo"
			+"	                      ,A.APPROVAL_DT                            approvalDt"
			+"	                      ,A.APPROVAL_TIME                          approvalTime"
			+"	                      ,A.DEAL_AMT                               dealAmt"
			+"	                      ,A.CARD_NO                                cardNo"
			+"	                      ,FNC_SETTLE_STATUS_CODE_NM(B.STATUS_DESC) statusNm"
			+"	                      ,B.STATUS_DESC                            statusDesc"
			+"	                  FROM SETTLE_GS A"   
			+"	                      ,SETTLE_RESULT B"   
			+"	                 WHERE A.JOB_DIVIDER  = #{jobDivider}"   
			+"	                   AND A.WORK_DT      = #{workDt}"   
			+"	                   AND B.JOB_DIVIDER  = A.JOB_DIVIDER"   
			+"	                   AND B.SETTLE_SEQ   = A.SEQ"   
			+"	                   AND B.WORK_DT      = A.WORK_DT"
			+"	                   AND B.STATUS     IN ('STS-0002' , 'STS-0004')"   
			+"	                 UNION ALL"   
			+"	                SELECT A.JOB_DIVIDER"   
			+"	                      ,B.SALE_DT"   
			+"	                      ,B.STORE_CD"   
			+"	                      ,B.DEAL_TYPE"   
			+"	                      ,B.DEAL_DIVIDER"   
			+"	                      ,B.DEAL_NO"   
			+"	                      ,B.APPROVAL_NO"   
			+"	                      ,B.APPROVAL_DT"   
			+"	                      ,B.APPROVAL_TIME"   
			+"	                      ,B.DEAL_AMT"   
			+"	                      ,B.CARD_NO"   
			+"	                      ,FNC_SETTLE_STATUS_CODE_NM(A.STATUS_DESC) STATUS_NM"   
			+"	                      ,A.STATUS_DESC"   
			+"	                FROM ("   
			+"	                      SELECT *"   
			+"	                        FROM SETTLE_RESULT B"   
			+"	                       WHERE JOB_DIVIDER = 'GSSM'"   
			+"	                         AND WORK_DT     = #{workDt}"   
			+"	                         AND STATUS      = 'STS-0003'"   
			+"	                         AND 'GSSM'      = #{jobDivider}"   
			+"	                    ) A"   
			+"	                  INNER JOIN"   
			+"	                   ("   
			+"	                   SELECT  SALESDATE SALE_DT"   
			+"	                           ,BRANCHCODE STORE_CD"   
			+"	                           ,ORDERNO DEAL_NO"   
			+"	                           ,APLNO APPROVAL_NO"   
			+"	                           ,APLDATE APPROVAL_DT"   
			+"	                           ,APLTIME APPROVAL_TIME"   
			+"	                           ,A.GIFT_NO"   
			+"	                           ,(SELECT EXTEND_NO"   
			+"	                               FROM GIFTEXTEND"   
			+"	                              WHERE GIFT_NO = A.GIFT_NO) AS CARD_NO"   
			+"	                           ,ORDERAMT DEAL_AMT"   
			+"	                           ,TTYPE DEAL_TYPE"   
			+"	                           ,ATYPE DEAL_DIVIDER"   
			+"	                           ,MERCHANTID"   
			+"	                     FROM   (SELECT SALESDATE,"   
			+"	                                    BRANCHCODE,"   
			+"	                                    ORDERNO,"   
			+"	                                    APLNO,"   
			+"	                                    APLDATE,"   
			+"	                                    APLTIME,"   
			+"	                                    (SELECT MAX(B.GIFT_NO)"   
			+"	                                     FROM   ORDERDETAIL A,"   
			+"	                                            (SELECT GIFT_NO,"   
			+"	                                                    SEQ_NO"   
			+"	                                             FROM   GIFTCREATE"   
			+"	                                             UNION ALL"   
			+"	                                             SELECT GIFT_NO,"   
			+"	                                                    SEQ_NO"   
			+"	                                             FROM   GIFTDELETE) B"   
			+"	                                     WHERE  A.C_SERIAL = B.SEQ_NO"   
			+"	                                     AND    A.TRANSID = ORDERLIST_POS.TRANSID ) GIFT_NO,"   
			+"	                                    (SELECT MAX(B.GIFT_CHECK)"   
			+"	                                     FROM   ORDERDETAIL A,"   
			+"	                                            (SELECT GIFT_CHECK,"   
			+"	                                                    SEQ_NO"   
			+"	                                             FROM   GIFTCREATE"   
			+"	                                             UNION ALL"   
			+"	                                             SELECT GIFT_CHECK,"   
			+"	                                                    SEQ_NO"   
			+"	                                             FROM   GIFTDELETE) B"   
			+"	                                     WHERE  A.C_SERIAL = B.SEQ_NO"   
			+"	                                     AND    A.TRANSID = ORDERLIST_POS.TRANSID ) GIFT_CHECK,"   
			+"	                                    ORDERAMT,"   
			+"	                                    DECODE(RESULTCODE, 'O1', 'PAY', 'R1', 'REF', 'D1', 'PAY', 'T1', 'REF') TTYPE,"   
			+"	                                    DECODE(RESULTCODE, 'O1', '0', 'R1', '0', 'D1', '9', 'T1', '9') ATYPE,"   
			+"	                                    '0' PTYPE,"   
			+"	                                    MERCHANTID"   
			+"	                             FROM   ORDERLIST_POS"   
			+"	                             WHERE  MERCHANTID = 'gssmpopp'"   
			+"	                             AND    SALESDATE =  TO_CHAR(TO_DATE(#{workDt}) - 1 , 'YYYYMMDD')"   
			+"	                             AND 'GSSM'      = #{jobDivider}"   
			+"	                             UNION ALL"   
			+"	                             SELECT SALESDATE,"   
			+"	                                    BRANCHCODE,"   
			+"	                                    APLORDERNO ORDERNO,"   
			+"	                                    APLNO,"   
			+"	                                    APLDATE,"   
			+"	                                    APLTIME,"   
			+"	                                    (SELECT MAX(TICKET_SNO)"   
			+"	                                     FROM   ACTIVE_APL_DETAIL"   
			+"	                                     WHERE  APLID = ACTIVE_APPROVAL.APLID ) GIFT_NO,"   
			+"	                                    (SELECT MAX(B.GIFT_CHECK)"   
			+"	                                     FROM   ACTIVE_APL_DETAIL A,"   
			+"	                                            (SELECT GIFT_CHECK,"   
			+"	                                                    GIFT_NO"   
			+"	                                             FROM   GIFTCREATE"   
			+"	                                             UNION ALL"   
			+"	                                             SELECT GIFT_CHECK,"   
			+"	                                                    GIFT_NO"   
			+"	                                             FROM   GIFTDELETE) B"   
			+"	                                     WHERE  A.TICKET_SNO = B.GIFT_NO"   
			+"	                                     AND    A.APLID = ACTIVE_APPROVAL.APLID ) GIFT_CHECK,"   
			+"	                                    (SELECT CREATE_AMT"   
			+"	                                     FROM   (SELECT GIFT_NO,"   
			+"	                                                    CREATE_AMT"   
			+"	                                             FROM   GIFTDELETE ) A"   
			+"	                                     WHERE  GIFT_NO = (SELECT MAX(TICKET_SNO)"   
			+"	                                             FROM   ACTIVE_APL_DETAIL A"   
			+"	                                             WHERE  APLID = ACTIVE_APPROVAL.APLID )"   
			+"	                                     UNION ALL"   
			+"	                                     SELECT CREATE_AMT"   
			+"	                                     FROM   (SELECT GIFT_NO,"   
			+"	                                                    CREATE_AMT"   
			+"	                                             FROM   GIFTCREATE ) A"   
			+"	                                     WHERE  GIFT_NO = (SELECT MAX(TICKET_SNO)"   
			+"	                                             FROM   ACTIVE_APL_DETAIL A"   
			+"	                                             WHERE  APLID = ACTIVE_APPROVAL.APLID ) )ORDERAMT,"   
			+"	                                    'ACT' TTYPE,"   
			+"	                                    DECODE(APLSTATUS, '1', '0', '2', '9') ATYPE,"   
			+"	                                    NVL(PAY_METHDO, '0') PTYPE,"   
			+"	                                    APLONLINEID MERCHANTID"   
			+"	                             FROM   ACTIVE_APPROVAL"   
			+"	                             WHERE  APLONLINEID = 'gssmpops'"   
			+"	                             AND    SALESDATE =  TO_CHAR(TO_DATE(#{workDt}) - 1 , 'YYYYMMDD')"   
			+"	                             AND 'GSSM'      = #{jobDivider}"   
			+"	                             UNION ALL"   
			+"	                             SELECT SALESDATE,"   
			+"	                                    BRANCHCODE,"   
			+"	                                    APLORDERNO ORDERNO,"   
			+"	                                    APLNO,"   
			+"	                                    TO_CHAR(APLDATE, 'YYYYMMDD') APLDATE,"   
			+"	                                    TO_CHAR(APLDATE, 'HH24MISS') APLTIME,"   
			+"	                                    GIFT_NO,"   
			+"	                                    (SELECT GIFT_CHECK"   
			+"	                                     FROM   (SELECT GIFT_CHECK,"   
			+"	                                                    GIFT_NO"   
			+"	                                             FROM   GIFTCREATE"   
			+"	                                             UNION ALL"   
			+"	                                             SELECT GIFT_CHECK,"   
			+"	                                                    GIFT_NO"   
			+"	                                             FROM   GIFTDELETE)"   
			+"	                                     WHERE  GIFT_NO = RC_APPROVAL.GIFT_NO ) GIFT_CHECK,"   
			+"	                                    RC_AMT ORDERAMT,"   
			+"	                                    DECODE(APLSTATUS, 'O1', 'CHR', 'D1', 'CHR', 'TS1', 'TRN') TTYPE,"   
			+"	                                    DECODE(APLSTATUS, 'O1', '0', 'D1', '9', 'TS1', '0') ATYPE,"   
			+"	                                    NVL(PAY_METHDO, '0') PTYPE,"   
			+"	                                        APLONLINEID MERCHANTID"   
			+"	                             FROM   RC_APPROVAL"   
			+"	                             WHERE  APLONLINEID = 'gssmpops'"   
			+"	                             AND    SALESDATE =  TO_CHAR(TO_DATE(#{workDt}) - 1 , 'YYYYMMDD')"   
			+"	                             AND    APLSTATUS IN ('O1','D1','TS1')"   
			+"	                             AND    'GSSM'     = #{jobDivider}"   
			+"	                             ) A"   
			+"	                     ) B"   
			+"	                  ON A.ORDER_NO = B.DEAL_NO"   
			+"	                 AND A.APPROVAL_NO = B.APPROVAL_NO"   
			+"	                 AND A.DEAL_TYPE = B.DEAL_TYPE"   
			+"	                 AND A.DEAL_DIVIDER = B.DEAL_DIVIDER"   
			+"                 ) X"
			+"           WHERE ROWNUM <= #{offset} + #{limit}"
			+"         ) Z"
			+" WHERE RNUM > #{offset}";
	
	public static final String GS_POP_ERROR_DETAIL_SELECT_SQL =""
			+"SELECT Z.*"
			+"  FROM ( SELECT ROWNUM AS RNUM" 
			+"               ,DECODE(X.jobDivider , 'GSPOP' , 'GS25' , X.jobDivider) jobDivider"     
			+"               ,X.saleDt"         
			+"               ,X.storeCd"
			+"               ,(SELECT MAX(CP_NAME) FROM PG_CP WHERE CP_ID = X.storeCd) storeNm"
			+"               ,DECODE(X.dealType , 'ACT','활성화', 'CHR','재충전', 'PAY','결제', 'REF','잔액환불', 'TRN','잔액이체') dealType"
			+"               ,CASE WHEN X.jobDivider = 'GSPOINT'"
			+"                     THEN DECODE(X.dealDivider , '1' , '사용' , '2' , '취소', X.dealDivider)"
			+"                     ELSE DECODE(X.dealDivider , '0' , '승인' , '9' , '취소' ,X.dealDivider)"
			+"                 END dealDivider"
			+"               ,X.dealNo"         
			+"               ,X.approvalNo"     
			+"               ,X.approvalDt"     
			+"               ,X.approvalTime"   
			+"               ,X.dealAmt"        
			+"               ,X.cardNo"         
			+"               ,X.statusNm"       
			+"               ,X.statusDesc"
			+"				 ,X.cancelMemo"     
			+"           FROM ("
			+"	                SELECT B.JOB_DIVIDER                            jobDivider"
			+"	                      ,A.SALE_DT                                saleDt"
			+"	                      ,A.STORE_CD                               storeCd"
			+"	                      ,A.DEAL_TYPE                              dealType"
			+"	                      ,A.DEAL_DIVIDER                           dealDivider"
			+"	                      ,A.DEAL_NO                                dealNo"
			+"	                      ,A.APPROVAL_NO                            approvalNo"
			+"	                      ,A.APPROVAL_DT                            approvalDt"
			+"	                      ,A.APPROVAL_TIME                          approvalTime"
			+"	                      ,A.DEAL_AMT                               dealAmt"
			+"	                      ,A.CARD_NO                                cardNo"
			+"	                      ,FNC_SETTLE_STATUS_CODE_NM(B.STATUS_DESC) statusNm"
			+"	                      ,B.STATUS_DESC                            statusDesc"
			+ "						  ,' ' cancelMemo"
			+"	                  FROM SETTLE_GS A"   
			+"	                      ,SETTLE_RESULT B"   
			+"	                 WHERE A.JOB_DIVIDER  = #{jobDivider}"   
			+"	                   AND A.WORK_DT      = #{workDt}"   
			+"	                   AND B.JOB_DIVIDER  = A.JOB_DIVIDER"   
			+"	                   AND B.SETTLE_SEQ   = A.SEQ"   
			+"	                   AND B.WORK_DT      = A.WORK_DT"
			+"	                   AND B.STATUS     IN ('STS-0002' , 'STS-0004')"   
			+"	                 UNION ALL"   
			+"	                SELECT A.JOB_DIVIDER"   
			+"	                      ,B.SALE_DT"   
			+"	                      ,B.STORE_CD"   
			+"	                      ,B.DEAL_TYPE"   
			+"	                      ,B.DEAL_DIVIDER"   
			+"	                      ,B.DEAL_NO"   
			+"	                      ,B.APPROVAL_NO"   
			+"	                      ,B.APPROVAL_DT"   
			+"	                      ,B.APPROVAL_TIME"   
			+"	                      ,B.DEAL_AMT"   
			+"	                      ,B.CARD_NO"   
			+"	                      ,FNC_SETTLE_STATUS_CODE_NM(A.STATUS_DESC) STATUS_NM"   
			+"	                      ,A.STATUS_DESC"
			+"						  ,B.cancelMemo"   
			+"	                 FROM ("   
			+"	                      SELECT *"   
			+"	                        FROM SETTLE_RESULT B"   
			+"	                       WHERE JOB_DIVIDER = 'GSPOP'"   
			+"	                         AND 'GSPOP'     = #{jobDivider}"   
			+"	                         AND WORK_DT     = #{workDt}"   
			+"	                         AND STATUS      = 'STS-0003'"   
			+"	                    ) A"   
			+"	                  INNER JOIN"   
			+"	                   ("   
			+"	                      SELECT  SALESDATE SALE_DT"   
			+"	                              ,BRANCHCODE STORE_CD"   
			+"	                              ,ORDERNO DEAL_NO"   
			+"	                              ,APLNO APPROVAL_NO"   
			+"	                              ,APLDATE APPROVAL_DT"   
			+"	                              ,APLTIME APPROVAL_TIME"   
			+"	                              ,A.GIFT_NO"   
			+"	                              ,(SELECT EXTEND_NO"   
			+"	                                  FROM GIFTEXTEND"   
			+"	                                 WHERE GIFT_NO = A.GIFT_NO) AS CARD_NO"   
			+"	                              ,ORDERAMT DEAL_AMT"   
			+"	                              ,TTYPE DEAL_TYPE"   
			+"	                              ,ATYPE DEAL_DIVIDER"   
			+"	                              ,MERCHANTID"
			+"								  ,cancelMemo"   
			+"	                        FROM   (SELECT SALESDATE,"   
			+"	                                       BRANCHCODE,"   
			+"	                                       ORDERNO,"   
			+"	                                       APLNO,"   
			+"	                                       APLDATE,"   
			+"	                                       APLTIME,"   
			+"	                                       (SELECT MAX(B.GIFT_NO)"   
			+"	                                        FROM   ORDERDETAIL A,"   
			+"	                                               (SELECT GIFT_NO,"   
			+"	                                                       SEQ_NO"   
			+"	                                                FROM   GIFTCREATE"   
			+"	                                                UNION ALL"   
			+"	                                                SELECT GIFT_NO,"   
			+"	                                                       SEQ_NO"   
			+"	                                                FROM   GIFTDELETE) B"   
			+"	                                        WHERE  A.C_SERIAL = B.SEQ_NO"   
			+"	                                        AND    A.TRANSID = ORDERLIST_POS.TRANSID ) GIFT_NO,"   
			+"	                                       (SELECT MAX(B.GIFT_CHECK)"   
			+"	                                        FROM   ORDERDETAIL A,"   
			+"	                                               (SELECT GIFT_CHECK,"   
			+"	                                                       SEQ_NO"   
			+"	                                                FROM   GIFTCREATE"   
			+"	                                                UNION ALL"   
			+"	                                                SELECT GIFT_CHECK,"   
			+"	                                                       SEQ_NO"   
			+"	                                                FROM   GIFTDELETE) B"   
			+"	                                        WHERE  A.C_SERIAL = B.SEQ_NO"   
			+"	                                        AND    A.TRANSID = ORDERLIST_POS.TRANSID ) GIFT_CHECK,"   
			+"	                                       ORDERAMT,"   
			+"	                                       DECODE(RESULTCODE, 'O1', 'PAY', 'R1', 'REF', 'D1', 'PAY', 'T1', 'REF') TTYPE,"   
			+"	                                       DECODE(RESULTCODE, 'O1', '0', 'R1', '0', 'D1', '9', 'T1', '9') ATYPE,"   
			+"	                                       '0' PTYPE,"   
			+"	                                       MERCHANTID,"
			+ "										   ' ' cancelMemo"   
			+"	                                FROM   ORDERLIST_POS"   
			+"	                                WHERE  MERCHANTID = 'gspopcardp'"   
			+"	                                AND    'GSPOP'     = #{jobDivider}"   
			+"	                                AND    SALESDATE =  TO_CHAR(TO_DATE(#{workDt}) - 1 , 'YYYYMMDD')"   
			+"	                                UNION ALL"   
			+"	                                SELECT SALESDATE,"   
			+"	                                       BRANCHCODE,"   
			+"	                                       APLORDERNO ORDERNO,"   
			+"	                                       APLNO,"   
			+"	                                       APLDATE,"   
			+"	                                       APLTIME,"   
			+"	                                       (SELECT MAX(TICKET_SNO)"   
			+"	                                        FROM   ACTIVE_APL_DETAIL"   
			+"	                                        WHERE  APLID = ACTIVE_APPROVAL.APLID ) GIFT_NO,"   
			+"	                                       (SELECT MAX(B.GIFT_CHECK)"   
			+"	                                        FROM   ACTIVE_APL_DETAIL A,"   
			+"	                                               (SELECT GIFT_CHECK,"   
			+"	                                                       GIFT_NO"   
			+"	                                                FROM   GIFTCREATE"   
			+"	                                                UNION ALL"   
			+"	                                                SELECT GIFT_CHECK,"   
			+"	                                                       GIFT_NO"   
			+"	                                                FROM   GIFTDELETE) B"   
			+"	                                        WHERE  A.TICKET_SNO = B.GIFT_NO"   
			+"	                                        AND    A.APLID = ACTIVE_APPROVAL.APLID ) GIFT_CHECK,"   
			+"	                                       (SELECT CREATE_AMT"   
			+"	                                        FROM   (SELECT GIFT_NO,"   
			+"	                                                       CREATE_AMT"   
			+"	                                                FROM   GIFTDELETE ) A"   
			+"	                                        WHERE  GIFT_NO = (SELECT MAX(TICKET_SNO)"   
			+"	                                                FROM   ACTIVE_APL_DETAIL A"   
			+"	                                                WHERE  APLID = ACTIVE_APPROVAL.APLID )"   
			+"	                                        UNION ALL"   
			+"	                                        SELECT CREATE_AMT"   
			+"	                                        FROM   (SELECT GIFT_NO,"   
			+"	                                                       CREATE_AMT"   
			+"	                                                FROM   GIFTCREATE ) A"   
			+"	                                        WHERE  GIFT_NO = (SELECT MAX(TICKET_SNO)"   
			+"	                                                FROM   ACTIVE_APL_DETAIL A"   
			+"	                                                WHERE  APLID = ACTIVE_APPROVAL.APLID ) )ORDERAMT,"   
			+"	                                       'ACT' TTYPE,"   
			+"	                                       DECODE(APLSTATUS, '1', '0', '2', '9') ATYPE,"   
			+"	                                       NVL(PAY_METHDO, '0') PTYPE,"   
			+"	                                       APLONLINEID MERCHANTID,"
			+ "										   NVL(CANCELREASON, ' ' ) cancelMemo"   
			+"	                                FROM   ACTIVE_APPROVAL"   
			+"	                                WHERE  APLONLINEID = 'gspopcards'"   
			+"	                                AND    SALESDATE =  TO_CHAR(TO_DATE(#{workDt}) - 1 , 'YYYYMMDD')"   
			+"	                                AND    'GSPOP'     = #{jobDivider}"   
			+"	                                UNION ALL"   
			+"	                                SELECT SALESDATE,"   
			+"	                                       BRANCHCODE,"   
			+"	                                       APLORDERNO ORDERNO,"   
			+"	                                       APLNO,"   
			+"	                                       TO_CHAR(APLDATE, 'YYYYMMDD') APLDATE,"   
			+"	                                       TO_CHAR(APLDATE, 'HH24MISS') APLTIME,"   
			+"	                                       GIFT_NO,"   
			+"	                                       (SELECT GIFT_CHECK"   
			+"	                                        FROM   (SELECT GIFT_CHECK,"   
			+"	                                                       GIFT_NO"   
			+"	                                                FROM   GIFTCREATE"   
			+"	                                                UNION ALL"   
			+"	                                                SELECT GIFT_CHECK,"   
			+"	                                                       GIFT_NO"   
			+"	                                                FROM   GIFTDELETE)"   
			+"	                                        WHERE  GIFT_NO = RC_APPROVAL.GIFT_NO ) GIFT_CHECK,"   
			+"	                                       RC_AMT ORDERAMT,"   
			+"	                                       DECODE(APLSTATUS, 'O1', 'CHR', 'D1', 'CHR', 'TS1', 'TRN') TTYPE,"   
			+"	                                       DECODE(APLSTATUS, 'O1', '0', 'D1', '9', 'TS1', '0') ATYPE,"   
			+"	                                       NVL(PAY_METHDO, '0') PTYPE,"   
			+"	                                           APLONLINEID MERCHANTID,"
			+ "										   NVL(CANCEL_MEMO, ' ' ) cancelMemo"   
			+"	                                FROM   RC_APPROVAL"   
			+"	                                WHERE  APLONLINEID = 'gspopcards'"   
			+"	                                AND    SALESDATE =  TO_CHAR(TO_DATE(#{workDt}) - 1 , 'YYYYMMDD')"   
			+"	                                AND    APLSTATUS IN ('O1','D1','TS1')"   
			+"	                                AND    'GSPOP'     = #{jobDivider}"   
			+"	                                ) A"   
			+"	                     ) B"   
			+"	                  ON A.ORDER_NO = B.DEAL_NO"   
			+"	                 AND A.APPROVAL_NO = B.APPROVAL_NO"   
			+"	                 AND A.DEAL_TYPE = B.DEAL_TYPE"   
			+"	                 AND A.DEAL_DIVIDER = B.DEAL_DIVIDER"   
			+"                 ) X"
			+"           WHERE ROWNUM <= #{offset} + #{limit}"
			+"         ) Z"
			+" WHERE RNUM > #{offset}";
	
	public static final String GSHB_ERROR_DETAIL_SELECT_SQL =""
			+"SELECT Z.*"
			+"  FROM ( SELECT ROWNUM AS RNUM" 
			+"               ,DECODE(X.jobDivider , 'GSPOP' , 'GS25' , X.jobDivider) jobDivider"     
			+"               ,X.saleDt"         
			+"               ,X.storeCd"
			+"               ,(SELECT MAX(CP_NAME) FROM PG_CP WHERE CP_ID = X.storeCd) storeNm"
			+"               ,DECODE(X.dealType , 'ACT','활성화', 'CHR','재충전', 'PAY','결제', 'REF','잔액환불', 'TRN','잔액이체') dealType"
			+"               ,CASE WHEN X.jobDivider = 'GSPOINT'"
			+"                     THEN DECODE(X.dealDivider , '1' , '사용' , '2' , '취소', X.dealDivider)"
			+"                     ELSE DECODE(X.dealDivider , '0' , '승인' , '9' , '취소' ,X.dealDivider)"
			+"                 END dealDivider"
			+"               ,X.dealNo"         
			+"               ,X.approvalNo"     
			+"               ,X.approvalDt"     
			+"               ,X.approvalTime"   
			+"               ,X.dealAmt"        
			+"               ,X.cardNo"         
			+"               ,X.statusNm"       
			+"               ,X.statusDesc"     
			+"           FROM ("
			+"	                SELECT B.JOB_DIVIDER                            jobDivider"
			+"	                      ,A.SALE_DT                                saleDt"
			+"	                      ,A.STORE_CD                               storeCd"
			+"	                      ,A.DEAL_TYPE                              dealType"
			+"	                      ,A.DEAL_DIVIDER                           dealDivider"
			+"	                      ,A.DEAL_NO                                dealNo"
			+"	                      ,A.APPROVAL_NO                            approvalNo"
			+"	                      ,A.APPROVAL_DT                            approvalDt"
			+"	                      ,A.APPROVAL_TIME                          approvalTime"
			+"	                      ,A.DEAL_AMT                               dealAmt"
			+"	                      ,A.CARD_NO                                cardNo"
			+"	                      ,FNC_SETTLE_STATUS_CODE_NM(B.STATUS_DESC) statusNm"
			+"	                      ,B.STATUS_DESC                            statusDesc"
			+"	                  FROM SETTLE_GS A"   
			+"	                      ,SETTLE_RESULT B"   
			+"	                 WHERE A.JOB_DIVIDER  = #{jobDivider}"   
			+"	                   AND A.WORK_DT      = #{workDt}"   
			+"	                   AND B.JOB_DIVIDER  = A.JOB_DIVIDER"   
			+"	                   AND B.SETTLE_SEQ   = A.SEQ"   
			+"	                   AND B.WORK_DT      = A.WORK_DT"
			+"	                   AND B.STATUS     IN ('STS-0002' , 'STS-0004')"   
			+"	                 UNION ALL"   
			+"	                SELECT A.JOB_DIVIDER"   
			+"	                      ,B.SALE_DT"   
			+"	                      ,B.STORE_CD"   
			+"	                      ,B.DEAL_TYPE"   
			+"	                      ,B.DEAL_DIVIDER"   
			+"	                      ,B.DEAL_NO"   
			+"	                      ,B.APPROVAL_NO"   
			+"	                      ,B.APPROVAL_DT"   
			+"	                      ,B.APPROVAL_TIME"   
			+"	                      ,B.DEAL_AMT"   
			+"	                      ,B.CARD_NO"   
			+"	                      ,FNC_SETTLE_STATUS_CODE_NM(A.STATUS_DESC) STATUS_NM"   
			+"	                      ,A.STATUS_DESC"   
			+"	                 FROM ("   
			+"	                      SELECT *"   
			+"	                        FROM SETTLE_RESULT B"   
			+"	                       WHERE JOB_DIVIDER = 'GSHB'"   
			+"	                         AND 'GSPOP'     = #{jobDivider}"   
			+"	                         AND WORK_DT     = #{workDt}"   
			+"	                         AND STATUS      = 'STS-0003'"   
			+"	                    ) A"   
			+"	                  INNER JOIN"   
			+"	                   ("   
			+"	                      SELECT  SALESDATE SALE_DT"   
			+"	                              ,BRANCHCODE STORE_CD"   
			+"	                              ,ORDERNO DEAL_NO"   
			+"	                              ,APLNO APPROVAL_NO"   
			+"	                              ,APLDATE APPROVAL_DT"   
			+"	                              ,APLTIME APPROVAL_TIME"   
			+"	                              ,A.GIFT_NO"   
			+"	                              ,(SELECT EXTEND_NO"   
			+"	                                  FROM GIFTEXTEND"   
			+"	                                 WHERE GIFT_NO = A.GIFT_NO) AS CARD_NO"   
			+"	                              ,ORDERAMT DEAL_AMT"   
			+"	                              ,TTYPE DEAL_TYPE"   
			+"	                              ,ATYPE DEAL_DIVIDER"   
			+"	                              ,MERCHANTID"   
			+"	                        FROM   (SELECT SALESDATE,"   
			+"	                                       BRANCHCODE,"   
			+"	                                       ORDERNO,"   
			+"	                                       APLNO,"   
			+"	                                       APLDATE,"   
			+"	                                       APLTIME,"   
			+"	                                       (SELECT MAX(B.GIFT_NO)"   
			+"	                                        FROM   ORDERDETAIL A,"   
			+"	                                               (SELECT GIFT_NO,"   
			+"	                                                       SEQ_NO"   
			+"	                                                FROM   GIFTCREATE"   
			+"	                                                UNION ALL"   
			+"	                                                SELECT GIFT_NO,"   
			+"	                                                       SEQ_NO"   
			+"	                                                FROM   GIFTDELETE) B"   
			+"	                                        WHERE  A.C_SERIAL = B.SEQ_NO"   
			+"	                                        AND    A.TRANSID = ORDERLIST_POS.TRANSID ) GIFT_NO,"   
			+"	                                       (SELECT MAX(B.GIFT_CHECK)"   
			+"	                                        FROM   ORDERDETAIL A,"   
			+"	                                               (SELECT GIFT_CHECK,"   
			+"	                                                       SEQ_NO"   
			+"	                                                FROM   GIFTCREATE"   
			+"	                                                UNION ALL"   
			+"	                                                SELECT GIFT_CHECK,"   
			+"	                                                       SEQ_NO"   
			+"	                                                FROM   GIFTDELETE) B"   
			+"	                                        WHERE  A.C_SERIAL = B.SEQ_NO"   
			+"	                                        AND    A.TRANSID = ORDERLIST_POS.TRANSID ) GIFT_CHECK,"   
			+"	                                       ORDERAMT,"   
			+"	                                       DECODE(RESULTCODE, 'O1', 'PAY', 'R1', 'REF', 'D1', 'PAY', 'T1', 'REF') TTYPE,"   
			+"	                                       DECODE(RESULTCODE, 'O1', '0', 'R1', '0', 'D1', '9', 'T1', '9') ATYPE,"   
			+"	                                       '0' PTYPE,"   
			+"	                                       MERCHANTID"   
			+"	                                FROM   ORDERLIST_POS"   
			+"	                                WHERE  MERCHANTID = 'gswatsonspop'"   
			+"	                                AND    'GSHB'     = #{jobDivider}"   
			+"	                                AND    SALESDATE =  TO_CHAR(TO_DATE(#{workDt}) - 1 , 'YYYYMMDD')"   
			+"	                                UNION ALL"   
			+"	                                SELECT SALESDATE,"   
			+"	                                       BRANCHCODE,"   
			+"	                                       APLORDERNO ORDERNO,"   
			+"	                                       APLNO,"   
			+"	                                       APLDATE,"   
			+"	                                       APLTIME,"   
			+"	                                       (SELECT MAX(TICKET_SNO)"   
			+"	                                        FROM   ACTIVE_APL_DETAIL"   
			+"	                                        WHERE  APLID = ACTIVE_APPROVAL.APLID ) GIFT_NO,"   
			+"	                                       (SELECT MAX(B.GIFT_CHECK)"   
			+"	                                        FROM   ACTIVE_APL_DETAIL A,"   
			+"	                                               (SELECT GIFT_CHECK,"   
			+"	                                                       GIFT_NO"   
			+"	                                                FROM   GIFTCREATE"   
			+"	                                                UNION ALL"   
			+"	                                                SELECT GIFT_CHECK,"   
			+"	                                                       GIFT_NO"   
			+"	                                                FROM   GIFTDELETE) B"   
			+"	                                        WHERE  A.TICKET_SNO = B.GIFT_NO"   
			+"	                                        AND    A.APLID = ACTIVE_APPROVAL.APLID ) GIFT_CHECK,"   
			+"	                                       (SELECT CREATE_AMT"   
			+"	                                        FROM   (SELECT GIFT_NO,"   
			+"	                                                       CREATE_AMT"   
			+"	                                                FROM   GIFTDELETE ) A"   
			+"	                                        WHERE  GIFT_NO = (SELECT MAX(TICKET_SNO)"   
			+"	                                                FROM   ACTIVE_APL_DETAIL A"   
			+"	                                                WHERE  APLID = ACTIVE_APPROVAL.APLID )"   
			+"	                                        UNION ALL"   
			+"	                                        SELECT CREATE_AMT"   
			+"	                                        FROM   (SELECT GIFT_NO,"   
			+"	                                                       CREATE_AMT"   
			+"	                                                FROM   GIFTCREATE ) A"   
			+"	                                        WHERE  GIFT_NO = (SELECT MAX(TICKET_SNO)"   
			+"	                                                FROM   ACTIVE_APL_DETAIL A"   
			+"	                                                WHERE  APLID = ACTIVE_APPROVAL.APLID ) )ORDERAMT,"   
			+"	                                       'ACT' TTYPE,"   
			+"	                                       DECODE(APLSTATUS, '1', '0', '2', '9') ATYPE,"   
			+"	                                       NVL(PAY_METHDO, '0') PTYPE,"   
			+"	                                       APLONLINEID MERCHANTID"   
			+"	                                FROM   ACTIVE_APPROVAL"   
			+"	                                WHERE  APLONLINEID = 'gswatsonspops'"   
			+"	                                AND    SALESDATE =  TO_CHAR(TO_DATE(#{workDt}) - 1 , 'YYYYMMDD')"   
			+"	                                AND    'GSHB'     = #{jobDivider}"   
			+"	                                UNION ALL"   
			+"	                                SELECT SALESDATE,"   
			+"	                                       BRANCHCODE,"   
			+"	                                       APLORDERNO ORDERNO,"   
			+"	                                       APLNO,"   
			+"	                                       TO_CHAR(APLDATE, 'YYYYMMDD') APLDATE,"   
			+"	                                       TO_CHAR(APLDATE, 'HH24MISS') APLTIME,"   
			+"	                                       GIFT_NO,"   
			+"	                                       (SELECT GIFT_CHECK"   
			+"	                                        FROM   (SELECT GIFT_CHECK,"   
			+"	                                                       GIFT_NO"   
			+"	                                                FROM   GIFTCREATE"   
			+"	                                                UNION ALL"   
			+"	                                                SELECT GIFT_CHECK,"   
			+"	                                                       GIFT_NO"   
			+"	                                                FROM   GIFTDELETE)"   
			+"	                                        WHERE  GIFT_NO = RC_APPROVAL.GIFT_NO ) GIFT_CHECK,"   
			+"	                                       RC_AMT ORDERAMT,"   
			+"	                                       DECODE(APLSTATUS, 'O1', 'CHR', 'D1', 'CHR', 'TS1', 'TRN') TTYPE,"   
			+"	                                       DECODE(APLSTATUS, 'O1', '0', 'D1', '9', 'TS1', '0') ATYPE,"   
			+"	                                       NVL(PAY_METHDO, '0') PTYPE,"   
			+"	                                           APLONLINEID MERCHANTID"   
			+"	                                FROM   RC_APPROVAL"   
			+"	                                WHERE  APLONLINEID = 'gswatsonspops'"   
			+"	                                AND    SALESDATE =  TO_CHAR(TO_DATE(#{workDt}) - 1 , 'YYYYMMDD')"   
			+"	                                AND    APLSTATUS IN ('O1','D1','TS1')"   
			+"	                                AND    'GSHB'     = #{jobDivider}"   
			+"	                                ) A"   
			+"	                     ) B"   
			+"	                  ON A.ORDER_NO = B.DEAL_NO"   
			+"	                 AND A.APPROVAL_NO = B.APPROVAL_NO"   
			+"	                 AND A.DEAL_TYPE = B.DEAL_TYPE"   
			+"	                 AND A.DEAL_DIVIDER = B.DEAL_DIVIDER"   
			+"                 ) X"
			+"           WHERE ROWNUM <= #{offset} + #{limit}"
			+"         ) Z"
			+" WHERE RNUM > #{offset}";
	
	public static final String GS_POINT_ERROR_DETAIL_SELECT_SQL =""
			+"SELECT Z.*"
			+"  FROM ( SELECT ROWNUM AS RNUM" 
			+"               ,DECODE(X.jobDivider , 'GSPOP' , 'GS25' , X.jobDivider) jobDivider"     
			+"               ,X.saleDt"         
			+"               ,X.storeCd"
			+"               ,(SELECT MAX(CP_NAME) FROM PG_CP WHERE CP_ID = X.storeCd) storeNm"
			+"               ,DECODE(X.dealType , 'ACT','활성화', 'CHR','재충전', 'PAY','결제', 'REF','잔액환불', 'TRN','잔액이체') dealType"
			+"               ,CASE WHEN X.jobDivider = 'GSPOINT'"
			+"                     THEN DECODE(X.dealDivider , '1' , '사용' , '2' , '취소', X.dealDivider)"
			+"                     ELSE DECODE(X.dealDivider , '0' , '승인' , '9' , '취소' ,X.dealDivider)"
			+"                 END dealDivider"
			+"               ,X.dealNo"         
			+"               ,X.approvalNo"     
			+"               ,X.approvalDt"     
			+"               ,X.approvalTime"   
			+"               ,X.dealAmt"        
			+"               ,X.cardNo"         
			+"               ,X.statusNm"       
			+"               ,X.statusDesc"
			+ "				 ,X.cancelMemo"     
			+"           FROM ("
	        +"                 SELECT B.JOB_DIVIDER                             jobDivider"
            +"                        ,SUBSTR(A.DEAL_DT,0,8)                    saleDt"
            +"                        ,A.STORE_CD                               storeCd"
            +"                        ,''                                       dealType"
            +"                        ,A.DEAL_DIVIDER                           dealDivider"
            +"                        ,''                                       dealNo"
            +"                        ,A.APPROVAL_NO                            approvalNo"
            +"                        ,A.APPROVAL_DT                            approvalDt"
            +"                        ,''                                       approvalTime"
            +"                        ,B.ORDER_AMT                              dealAmt"
            +"                        ,A.CARD_NO                                cardNo"
            +"                        ,FNC_SETTLE_STATUS_CODE_NM(B.STATUS_DESC) statusNm"
            +"                        ,B.STATUS_DESC                            statusDesc"
            + "						  ,' ' cancelMemo"
			+"                    FROM SETTLE_GSNPOINT A"   
			+"                        ,SETTLE_RESULT B"   
			+"                   WHERE 1 = 1"
			+"                     AND 'GSPOINT'     = DECODE(#{jobDivider},NULL,'GSPOINT',#{jobDivider})"
			+"                     AND A.WORK_DT     = #{workDt}"   
			+"                     AND B.JOB_DIVIDER = #{jobDivider}"   
			+"                     AND B.SETTLE_SEQ  = A.SEQ"   
			+"                     AND B.WORK_DT     = A.WORK_DT"   
			+"                     AND B.STATUS     IN ('STS-0002' , 'STS-0004')"   
			+"                 UNION ALL"
			+"                  SELECT A.JOB_DIVIDER"   
			+"                        ,SUBSTR(B.DEAL_DT,0,8) SALE_DT"   
			+"                        ,B.STORE_CD"   
			+"                        ,'' DEAL_TYPE"   
			+"                        ,B.DEAL_DIVIDER"   
			+"                        ,'' DEAL_NO"   
			+"                        ,B.APPROVAL_NO"   
			+"                        ,B.APPROVAL_DT"   
			+"                        ,'' APPROVAL_TIME"   
			+"                        ,B.USE_POINT DEAL_AMT"   
			+"                        ,B.CARD_NO"   
			+"                        ,FNC_SETTLE_STATUS_CODE_NM(A.STATUS_DESC) STATUS_NM"   
			+"                        ,A.STATUS_DESC"
			+ "						  ,B.cancelMemo"   
			+"                    FROM ("   
			+"                            SELECT *"   
			+"                              FROM SETTLE_RESULT"   
			+"                             WHERE WORK_DT     = #{workDt}"   
			+"                               AND JOB_DIVIDER = 'GSPOINT'"   
			+"                               AND 'GSPOINT'   = DECODE(#{jobDivider},NULL,'GSPOINT',#{jobDivider})"   
			+"                               AND STATUS      = 'STS-0003'"   
			+"                          ) A"   
			+"                     INNER JOIN"   
			+"                     ("   
			+"                       SELECT ROWNUM"   
			+"                             ,A.GIFT_NO"   
			+"                             ,E.EXTEND_NO CARD_NO"   
			+"                             ,'E1010' STORE_CD"   
			+"                             ,TO_CHAR(A.APLDATE, 'YYYYMMDDHH24MISS') DEAL_DT"   
			+"                             ,DECODE(A.APLSTATUS, 'O1', '1', 'D1', '2', '0') DEAL_DIVIDER"   
			+"                             ,A.RC_AMT USE_POINT"   
			+"                             ,TO_CHAR(A.APLDATE, 'YYYYMMDD') APPROVAL_DT"   
			+"                             ,NVL(A.C_APLNO, ' ') APPROVAL_NO"   
			+"                             ,A.APLORDERNO DEAL_NO"   
			+"                             ,A.APLONLINEID MERCHANTID,"
			+ "							   NVL(CANCEL_MEMO, ' ' ) cancelMemo"   
			+"                         FROM RC_APPROVAL A"   
			+"                            , GIFTEXTEND E"   
			+"                        WHERE A.GIFT_NO = E.GIFT_NO"   
			+"                          AND A.APLONLINEID = 'gsrpoppoint'"   
			+"                          AND A.SALESDATE   = TO_CHAR(TO_DATE(#{workDt}) -1,'YYYYMMDD')"   
			+"                          AND A.PAY_METHDO IN ('2', 'A2')"   
			+"                          AND 'GSPOINT'     = DECODE(#{jobDivider},NULL,'GSPOINT',#{jobDivider})"   
			+"                       ) B"   
			+"                    ON A.APPROVAL_NO = B.APPROVAL_NO"   
			+"                   AND A.DEAL_DIVIDER = B.DEAL_DIVIDER"
			+"                 ) X"
			+"           WHERE ROWNUM <= #{offset} + #{limit}"
			+"         ) Z"
			+" WHERE RNUM > #{offset}";
	
	public static final String HM_ERROR_DETAIL_SELECT_SQL =""
			+"SELECT Z.*"
			+"  FROM ( SELECT ROWNUM AS RNUM" 
			+"               ,X.jobDivider"     
			+"               ,X.saleDt"         
			+"               ,'' storeCd"
			+"               ,'' storeNm"
			+"               ,DECODE(X.dealType , 'O1','결제', 'D1','취소', 'D2','취소') dealType"
			+"               ,X.dealDivider"
			+"               ,X.dealNo"         
			+"               ,X.approvalNo"     
			+"               ,X.approvalDt"     
			+"               ,X.approvalTime"   
			+"               ,X.dealAmt"        
			+"               ,X.cardNo"         
			+"               ,X.statusNm"       
			+"               ,X.statusDesc"     
			+"           FROM ("
			+"                 SELECT  #{jobDivider}                            jobDivider"
			+"                        ,A.DEAL_DT                                saleDt"
			+"                        ,''                                       storeCd"
			+"                        ,A.STATUS                                 dealType"
			+"                        ,''                                       dealDivider"
			+"                        ,A.ORDER_NO                               dealNo"
			+"                        ,A.APPROVAL_NO                            approvalNo"
			+"                        ,B.APPROVAL_DT                            approvalDt"
			+"                        ,''                                       approvalTime"
			+"                        ,A.AMOUNT                                 dealAmt"
			+"                        ,''                                       cardNo"
			+"                        ,FNC_SETTLE_STATUS_CODE_NM(B.STATUS_DESC) statusNm"
			+"                        ,B.STATUS_DESC                            statusDesc"
			+"                    FROM SETTLE_HM A"   
			+"                        ,SETTLE_RESULT B"   
			+"                   WHERE 1 = 1"
			+"                     AND A.WORK_DT     = #{workDt}"   
			+"                     AND B.JOB_DIVIDER = #{jobDivider}"
			+"                     AND B.SETTLE_SEQ  = A.SEQ"   
			+"                     AND B.WORK_DT     = A.WORK_DT"   
			+"                     AND B.STATUS     IN ('STS-0002' , 'STS-0005')"   
			+"                 UNION ALL"
			+"                  SELECT #{jobDivider}"   
			+"                        ,B.O_DATE"   
			+"                        ,''"   
			+"                        ,B.O_RESULT"   
			+"                        ,''"   
			+"                        ,B.M_ONO DEAL_NO"   
			+"                        ,B.O_ADMITNO"   
			+"                        ,B.O_ADMITDATE"   
			+"                        ,''"   
			+"                        ,B.O_T_MONEY"   
			+"                        ,''"   
			+"                        ,FNC_SETTLE_STATUS_CODE_NM(A.STATUS_DESC) STATUS_NM"   
			+"                        ,A.STATUS_DESC"   
			+"                    FROM ("   
			+"                            SELECT *"   
			+"                              FROM SETTLE_RESULT"   
			+"                             WHERE WORK_DT     = #{workDt}"   
			+"                               AND JOB_DIVIDER = 'HAPPYMONEY'"   
			+"                               AND STATUS      = 'STS-0003'"   
			+"                          ) A"   
			+"                     INNER JOIN"   
			+"                     ORDERLIST B"   
			+"                    ON A.ORDER_NO    = B.M_ONO"   
			+"                   AND A.APPROVAL_NO = B.O_ADMITNO"
			+"                   AND A.APPROVAL_DT = B.O_ADMITDATE"
			+"                   AND A.DEAL_TYPE   = B.O_RESULT"
			+"                 ) X"
			+"           WHERE ROWNUM <= #{offset} + #{limit}"
			+"         ) Z"
			+" WHERE RNUM > #{offset}";	
	
	public static final String HM_ERROR_DETAIL_SELECT_SQL_CNT =""
			+"  SELECT COUNT(1) count" 
			+"   FROM ("
			+"         SELECT  #{jobDivider}                            jobDivider"
			+"                ,A.DEAL_DT                                saleDt"
			+"                ,''                                       storeCd"
			+"                ,A.STATUS                                 dealType"
			+"                ,''                                       dealDivider"
			+"                ,A.ORDER_NO                               dealNo"
			+"                ,A.APPROVAL_NO                            approvalNo"
			+"                ,''                                       approvalDt"
			+"                ,''                                       approvalTime"
			+"                ,A.AMOUNT                                 dealAmt"
			+"                ,''                                       cardNo"
			+"                ,FNC_SETTLE_STATUS_CODE_NM(B.STATUS_DESC) statusNm"
			+"                ,B.STATUS_DESC                            statusDesc"
			+"            FROM SETTLE_HM A"   
			+"                ,SETTLE_RESULT B"   
			+"           WHERE 1 = 1"
			+"             AND A.WORK_DT     = #{workDt}"   
			+"             AND B.SETTLE_SEQ  = A.SEQ"   
			+"             AND B.WORK_DT     = A.WORK_DT"   
			+"             AND B.JOB_DIVIDER = #{jobDivider}"
			+"             AND B.STATUS     IN ('STS-0002' , 'STS-0005')"   
			+"         UNION ALL"
			+"          SELECT #{jobDivider}"   
			+"                ,B.O_DATE"   
			+"                ,''"   
			+"                ,B.O_RESULT"   
			+"                ,''"   
			+"                ,B.M_ONO DEAL_NO"   
			+"                ,B.O_ADMITNO"   
			+"                ,B.O_ADMITDATE"   
			+"                ,''"   
			+"                ,B.O_T_MONEY"   
			+"                ,''"   
			+"                ,FNC_SETTLE_STATUS_CODE_NM(A.STATUS_DESC) STATUS_NM"   
			+"                ,A.STATUS_DESC"   
			+"            FROM ("   
			+"                    SELECT *"   
			+"                      FROM SETTLE_RESULT"   
			+"                     WHERE WORK_DT     = #{workDt}"   
			+"                       AND JOB_DIVIDER = #{jobDivider}"   
			+"                       AND STATUS      = 'STS-0003'"   
			+"                  ) A"   
			+"             INNER JOIN"   
			+"             ORDERLIST B"   
			+"            ON A.ORDER_NO    = B.M_ONO"   
			+"           AND A.APPROVAL_NO = B.O_ADMITNO"
			+"           AND A.APPROVAL_DT = B.O_ADMITDATE"
			+"           AND A.DEAL_TYPE   = B.O_RESULT"
			+"         ) X";
	
	public static final String GS_ERROR_DETAIL_SELECT_ALL_SQL =""
			+"SELECT ROWNUM AS RNUM" 
			+"      ,DECODE(X.jobDivider , 'GSPOP' , 'GS25' , X.jobDivider) jobDivider"     
			+"      ,X.saleDt"         
			+"      ,X.storeCd"        
			+"      ,(SELECT MAX(CP_NAME) FROM PG_CP WHERE CP_ID = X.storeCd) storeNm"
			+"      ,DECODE(X.dealType , 'ACT','활성화', 'CHR','재충전', 'PAY','결제', 'REF','잔액환불', 'TRN','잔액이체') dealType"
			+"      ,CASE WHEN X.jobDivider = 'GSPOINT'"
			+"            THEN DECODE(X.dealDivider , '1' , '사용' , '2' , '취소', X.dealDivider)"
			+"            ELSE DECODE(X.dealDivider , '0' , '승인' , '9' , '취소' ,X.dealDivider)"
			+"        END dealDivider"
			+"      ,X.dealNo"         
			+"      ,X.approvalNo"     
			+"      ,X.approvalDt"     
			+"      ,X.approvalTime"   
			+"      ,X.dealAmt"        
			+"      ,X.cardNo"         
			+"      ,X.statusNm"       
			+"      ,X.statusDesc"
			+ "		,X.cancelMemo"
			+" FROM ("
			+"        SELECT B.JOB_DIVIDER                            jobDivider"
			+"              ,A.SALE_DT                                saleDt"
			+"              ,A.STORE_CD                               storeCd"
			+"              ,A.DEAL_TYPE                              dealType"
			+"              ,A.DEAL_DIVIDER                           dealDivider"
			+"              ,A.DEAL_NO                                dealNo"
			+"              ,A.APPROVAL_NO                            approvalNo"
			+"              ,A.APPROVAL_DT                            approvalDt"
			+"              ,A.APPROVAL_TIME                          approvalTime"
			+"              ,A.DEAL_AMT                               dealAmt"
			+"              ,A.CARD_NO                                cardNo"
			+"              ,FNC_SETTLE_STATUS_CODE_NM(B.STATUS_DESC) statusNm"
			+"              ,B.STATUS_DESC                            statusDesc"
			+ "				,' ' cancelMemo"
			+"          FROM SETTLE_GS A"   
			+"              ,SETTLE_RESULT B"   
			+"         WHERE A.JOB_DIVIDER  = #{jobDivider}"   
			+"           AND A.WORK_DT      = #{workDt}"   
			+"           AND B.JOB_DIVIDER  = A.JOB_DIVIDER"   
			+"           AND B.SETTLE_SEQ   = A.SEQ"   
			+"           AND B.WORK_DT      = A.WORK_DT"   
			+"           AND B.STATUS     IN ('STS-0002' , 'STS-0004')"   
			+"         UNION ALL"   
			+"        SELECT A.JOB_DIVIDER"   
			+"              ,B.SALE_DT"   
			+"              ,B.STORE_CD"   
			+"              ,B.DEAL_TYPE"   
			+"              ,B.DEAL_DIVIDER"   
			+"              ,B.DEAL_NO"   
			+"              ,B.APPROVAL_NO"   
			+"              ,B.APPROVAL_DT"   
			+"              ,B.APPROVAL_TIME"   
			+"              ,B.DEAL_AMT"   
			+"              ,B.CARD_NO"   
			+"              ,FNC_SETTLE_STATUS_CODE_NM(A.STATUS_DESC) STATUS_NM"   
			+"              ,A.STATUS_DESC"
			+ "				,B.cancelMemo"   
			+"        FROM ("   
			+"              SELECT *"   
			+"                FROM SETTLE_RESULT B"   
			+"               WHERE JOB_DIVIDER = 'GSSM'"   
			+"                 AND WORK_DT     = #{workDt}"   
			+"                 AND STATUS      = 'STS-0003'"   
			+"                 AND 'GSSM'      = #{jobDivider}"   
			+"            ) A"   
			+"          INNER JOIN"   
			+"           ("   
			+"           SELECT  SALESDATE SALE_DT"   
			+"                   ,BRANCHCODE STORE_CD"   
			+"                   ,ORDERNO DEAL_NO"   
			+"                   ,APLNO APPROVAL_NO"   
			+"                   ,APLDATE APPROVAL_DT"   
			+"                   ,APLTIME APPROVAL_TIME"   
			+"                   ,A.GIFT_NO"   
			+"                   ,(SELECT EXTEND_NO"   
			+"                       FROM GIFTEXTEND"   
			+"                      WHERE GIFT_NO = A.GIFT_NO) AS CARD_NO"   
			+"                   ,ORDERAMT DEAL_AMT"   
			+"                   ,TTYPE DEAL_TYPE"   
			+"                   ,ATYPE DEAL_DIVIDER"   
			+"                   ,MERCHANTID"
			+ "					 ,cancelMemo"   
			+"             FROM   (SELECT SALESDATE,"   
			+"                            BRANCHCODE,"   
			+"                            ORDERNO,"   
			+"                            APLNO,"   
			+"                            APLDATE,"   
			+"                            APLTIME,"   
			+"                            (SELECT MAX(B.GIFT_NO)"   
			+"                             FROM   ORDERDETAIL A,"   
			+"                                    (SELECT GIFT_NO,"   
			+"                                            SEQ_NO"   
			+"                                     FROM   GIFTCREATE"   
			+"                                     UNION ALL"   
			+"                                     SELECT GIFT_NO,"   
			+"                                            SEQ_NO"   
			+"                                     FROM   GIFTDELETE) B"   
			+"                             WHERE  A.C_SERIAL = B.SEQ_NO"   
			+"                             AND    A.TRANSID = ORDERLIST_POS.TRANSID ) GIFT_NO,"   
			+"                            (SELECT MAX(B.GIFT_CHECK)"   
			+"                             FROM   ORDERDETAIL A,"   
			+"                                    (SELECT GIFT_CHECK,"   
			+"                                            SEQ_NO"   
			+"                                     FROM   GIFTCREATE"   
			+"                                     UNION ALL"   
			+"                                     SELECT GIFT_CHECK,"   
			+"                                            SEQ_NO"   
			+"                                     FROM   GIFTDELETE) B"   
			+"                             WHERE  A.C_SERIAL = B.SEQ_NO"   
			+"                             AND    A.TRANSID = ORDERLIST_POS.TRANSID ) GIFT_CHECK,"   
			+"                            ORDERAMT,"   
			+"                            DECODE(RESULTCODE, 'O1', 'PAY', 'R1', 'REF', 'D1', 'PAY', 'T1', 'REF') TTYPE,"   
			+"                            DECODE(RESULTCODE, 'O1', '0', 'R1', '0', 'D1', '9', 'T1', '9') ATYPE,"   
			+"                            '0' PTYPE,"   
			+"                            MERCHANTID,"
			+ "							  ' ' cancelMemo"   
			+"                     FROM   ORDERLIST_POS"   
			+"                     WHERE  MERCHANTID = 'gssmpopp'"   
			+"                     AND    SALESDATE =  TO_CHAR(TO_DATE(#{workDt}) - 1 , 'YYYYMMDD')"   
			+"                     AND 'GSSM'      = #{jobDivider}"   
			+"                     UNION ALL"   
			+"                     SELECT SALESDATE,"   
			+"                            BRANCHCODE,"   
			+"                            APLORDERNO ORDERNO,"   
			+"                            APLNO,"   
			+"                            APLDATE,"   
			+"                            APLTIME,"   
			+"                            (SELECT MAX(TICKET_SNO)"   
			+"                             FROM   ACTIVE_APL_DETAIL"   
			+"                             WHERE  APLID = ACTIVE_APPROVAL.APLID ) GIFT_NO,"   
			+"                            (SELECT MAX(B.GIFT_CHECK)"   
			+"                             FROM   ACTIVE_APL_DETAIL A,"   
			+"                                    (SELECT GIFT_CHECK,"   
			+"                                            GIFT_NO"   
			+"                                     FROM   GIFTCREATE"   
			+"                                     UNION ALL"   
			+"                                     SELECT GIFT_CHECK,"   
			+"                                            GIFT_NO"   
			+"                                     FROM   GIFTDELETE) B"   
			+"                             WHERE  A.TICKET_SNO = B.GIFT_NO"   
			+"                             AND    A.APLID = ACTIVE_APPROVAL.APLID ) GIFT_CHECK,"   
			+"                            (SELECT CREATE_AMT"   
			+"                             FROM   (SELECT GIFT_NO,"   
			+"                                            CREATE_AMT"   
			+"                                     FROM   GIFTDELETE ) A"   
			+"                             WHERE  GIFT_NO = (SELECT MAX(TICKET_SNO)"   
			+"                                     FROM   ACTIVE_APL_DETAIL A"   
			+"                                     WHERE  APLID = ACTIVE_APPROVAL.APLID )"   
			+"                             UNION ALL"   
			+"                             SELECT CREATE_AMT"   
			+"                             FROM   (SELECT GIFT_NO,"   
			+"                                            CREATE_AMT"   
			+"                                     FROM   GIFTCREATE ) A"   
			+"                             WHERE  GIFT_NO = (SELECT MAX(TICKET_SNO)"   
			+"                                     FROM   ACTIVE_APL_DETAIL A"   
			+"                                     WHERE  APLID = ACTIVE_APPROVAL.APLID ) )ORDERAMT,"   
			+"                            'ACT' TTYPE,"   
			+"                            DECODE(APLSTATUS, '1', '0', '2', '9') ATYPE,"   
			+"                            NVL(PAY_METHDO, '0') PTYPE,"   
			+"                            APLONLINEID MERCHANTID,"
			+"						      NVL(CANCELREASON, '') cancelMemo"   
			+"                     FROM   ACTIVE_APPROVAL"   
			+"                     WHERE  APLONLINEID = 'gssmpops'"   
			+"                     AND    SALESDATE =  TO_CHAR(TO_DATE(#{workDt}) - 1 , 'YYYYMMDD')"   
			+"                     AND 'GSSM'      = #{jobDivider}"   
			+"                     UNION ALL"   
			+"                     SELECT SALESDATE,"   
			+"                            BRANCHCODE,"   
			+"                            APLORDERNO ORDERNO,"   
			+"                            APLNO,"   
			+"                            TO_CHAR(APLDATE, 'YYYYMMDD') APLDATE,"   
			+"                            TO_CHAR(APLDATE, 'HH24MISS') APLTIME,"   
			+"                            GIFT_NO,"   
			+"                            (SELECT GIFT_CHECK"   
			+"                             FROM   (SELECT GIFT_CHECK,"   
			+"                                            GIFT_NO"   
			+"                                     FROM   GIFTCREATE"   
			+"                                     UNION ALL"   
			+"                                     SELECT GIFT_CHECK,"   
			+"                                            GIFT_NO"   
			+"                                     FROM   GIFTDELETE)"   
			+"                             WHERE  GIFT_NO = RC_APPROVAL.GIFT_NO ) GIFT_CHECK,"   
			+"                            RC_AMT ORDERAMT,"   
			+"                            DECODE(APLSTATUS, 'O1', 'CHR', 'D1', 'CHR', 'TS1', 'TRN') TTYPE,"   
			+"                            DECODE(APLSTATUS, 'O1', '0', 'D1', '9', 'TS1', '0') ATYPE,"   
			+"                            NVL(PAY_METHDO, '0') PTYPE,"   
			+"                            APLONLINEID MERCHANTID,"
			+"							  NVL(CANCEL_MEMO,' ') cancelMemo"
			+"                     FROM   RC_APPROVAL"   
			+"                     WHERE  APLONLINEID = 'gssmpops'"   
			+"                     AND    SALESDATE =  TO_CHAR(TO_DATE(#{workDt}) - 1 , 'YYYYMMDD')"   
			+"                     AND    APLSTATUS IN ('O1','D1','TS1')"   
			+"                     AND    'GSSM'     = #{jobDivider}"   
			+"                     ) A"   
			+"             ) B"   
			+"          ON A.ORDER_NO = B.DEAL_NO"   
			+"         AND A.APPROVAL_NO = B.APPROVAL_NO"   
			+"         AND A.DEAL_TYPE = B.DEAL_TYPE"   
			+"         AND A.DEAL_DIVIDER = B.DEAL_DIVIDER"   
			+"        UNION ALL"   
			+"        SELECT A.JOB_DIVIDER"   
			+"              ,B.SALE_DT"   
			+"              ,B.STORE_CD"   
			+"              ,B.DEAL_TYPE"   
			+"              ,B.DEAL_DIVIDER"   
			+"              ,B.DEAL_NO"   
			+"              ,B.APPROVAL_NO"   
			+"              ,B.APPROVAL_DT"   
			+"              ,B.APPROVAL_TIME"   
			+"              ,B.DEAL_AMT"   
			+"              ,B.CARD_NO"   
			+"              ,FNC_SETTLE_STATUS_CODE_NM(A.STATUS_DESC) STATUS_NM"   
			+"              ,A.STATUS_DESC"
			+ "				,B.cancelMemo"   
			+"         FROM ("   
			+"              SELECT *"   
			+"                FROM SETTLE_RESULT B"   
			+"               WHERE JOB_DIVIDER = 'GSPOP'"   
			+"                 AND 'GSPOP'     = #{jobDivider}"   
			+"                 AND WORK_DT     = #{workDt}"   
			+"                 AND STATUS      = 'STS-0003'"   
			+"            ) A"   
			+"          INNER JOIN"   
			+"           ("   
			+"              SELECT  SALESDATE SALE_DT"   
			+"                      ,BRANCHCODE STORE_CD"   
			+"                      ,ORDERNO DEAL_NO"   
			+"                      ,APLNO APPROVAL_NO"   
			+"                      ,APLDATE APPROVAL_DT"   
			+"                      ,APLTIME APPROVAL_TIME"   
			+"                      ,A.GIFT_NO"   
			+"                      ,(SELECT EXTEND_NO"   
			+"                          FROM GIFTEXTEND"   
			+"                         WHERE GIFT_NO = A.GIFT_NO) AS CARD_NO"   
			+"                      ,ORDERAMT DEAL_AMT"   
			+"                      ,TTYPE DEAL_TYPE"   
			+"                      ,ATYPE DEAL_DIVIDER"   
			+"                      ,MERCHANTID"
			+ "						,cancelMemo"   
			+"                FROM   (SELECT SALESDATE,"   
			+"                               BRANCHCODE,"   
			+"                               ORDERNO,"   
			+"                               APLNO,"   
			+"                               APLDATE,"   
			+"                               APLTIME,"   
			+"                               (SELECT MAX(B.GIFT_NO)"   
			+"                                FROM   ORDERDETAIL A,"   
			+"                                       (SELECT GIFT_NO,"   
			+"                                               SEQ_NO"   
			+"                                        FROM   GIFTCREATE"   
			+"                                        UNION ALL"   
			+"                                        SELECT GIFT_NO,"   
			+"                                               SEQ_NO"   
			+"                                        FROM   GIFTDELETE) B"   
			+"                                WHERE  A.C_SERIAL = B.SEQ_NO"   
			+"                                AND    A.TRANSID = ORDERLIST_POS.TRANSID ) GIFT_NO,"   
			+"                               (SELECT MAX(B.GIFT_CHECK)"   
			+"                                FROM   ORDERDETAIL A,"   
			+"                                       (SELECT GIFT_CHECK,"   
			+"                                               SEQ_NO"   
			+"                                        FROM   GIFTCREATE"   
			+"                                        UNION ALL"   
			+"                                        SELECT GIFT_CHECK,"   
			+"                                               SEQ_NO"   
			+"                                        FROM   GIFTDELETE) B"   
			+"                                WHERE  A.C_SERIAL = B.SEQ_NO"   
			+"                                AND    A.TRANSID = ORDERLIST_POS.TRANSID ) GIFT_CHECK,"   
			+"                               ORDERAMT,"   
			+"                               DECODE(RESULTCODE, 'O1', 'PAY', 'R1', 'REF', 'D1', 'PAY', 'T1', 'REF') TTYPE,"   
			+"                               DECODE(RESULTCODE, 'O1', '0', 'R1', '0', 'D1', '9', 'T1', '9') ATYPE,"   
			+"                               '0' PTYPE,"   
			+"                               MERCHANTID,"
			+ "								 ' ' cancelMemo  "   
			+"                        FROM   ORDERLIST_POS"   
			+"                        WHERE  MERCHANTID = 'gspopcardp'"   
			+"                        AND    'GSPOP'     = #{jobDivider}"   
			+"                        AND    SALESDATE =  TO_CHAR(TO_DATE(#{workDt}) - 1 , 'YYYYMMDD')"   
			+"                        UNION ALL"   
			+"                        SELECT SALESDATE,"   
			+"                               BRANCHCODE,"   
			+"                               APLORDERNO ORDERNO,"   
			+"                               APLNO,"   
			+"                               APLDATE,"   
			+"                               APLTIME,"   
			+"                               (SELECT MAX(TICKET_SNO)"   
			+"                                FROM   ACTIVE_APL_DETAIL"   
			+"                                WHERE  APLID = ACTIVE_APPROVAL.APLID ) GIFT_NO,"   
			+"                               (SELECT MAX(B.GIFT_CHECK)"   
			+"                                FROM   ACTIVE_APL_DETAIL A,"   
			+"                                       (SELECT GIFT_CHECK,"   
			+"                                               GIFT_NO"   
			+"                                        FROM   GIFTCREATE"   
			+"                                        UNION ALL"   
			+"                                        SELECT GIFT_CHECK,"   
			+"                                               GIFT_NO"   
			+"                                        FROM   GIFTDELETE) B"   
			+"                                WHERE  A.TICKET_SNO = B.GIFT_NO"   
			+"                                AND    A.APLID = ACTIVE_APPROVAL.APLID ) GIFT_CHECK,"   
			+"                               (SELECT CREATE_AMT"   
			+"                                FROM   (SELECT GIFT_NO,"   
			+"                                               CREATE_AMT"   
			+"                                        FROM   GIFTDELETE ) A"   
			+"                                WHERE  GIFT_NO = (SELECT MAX(TICKET_SNO)"   
			+"                                        FROM   ACTIVE_APL_DETAIL A"   
			+"                                        WHERE  APLID = ACTIVE_APPROVAL.APLID )"   
			+"                                UNION ALL"   
			+"                                SELECT CREATE_AMT"   
			+"                                FROM   (SELECT GIFT_NO,"   
			+"                                               CREATE_AMT"   
			+"                                        FROM   GIFTCREATE ) A"   
			+"                                WHERE  GIFT_NO = (SELECT MAX(TICKET_SNO)"   
			+"                                        FROM   ACTIVE_APL_DETAIL A"   
			+"                                        WHERE  APLID = ACTIVE_APPROVAL.APLID ) )ORDERAMT,"   
			+"                               'ACT' TTYPE,"   
			+"                               DECODE(APLSTATUS, '1', '0', '2', '9') ATYPE,"   
			+"                               NVL(PAY_METHDO, '0') PTYPE,"   
			+"                               APLONLINEID MERCHANTID,"
			+ "								 NVL(CANCELREASON, ' ') cancelMemo"   
			+"                        FROM   ACTIVE_APPROVAL"   
			+"                        WHERE  APLONLINEID = 'gspopcards'"   
			+"                        AND    SALESDATE =  TO_CHAR(TO_DATE(#{workDt}) - 1 , 'YYYYMMDD')"   
			+"                        AND    'GSPOP'     = #{jobDivider}"   
			+"                        UNION ALL"   
			+"                        SELECT SALESDATE,"   
			+"                               BRANCHCODE,"   
			+"                               APLORDERNO ORDERNO,"   
			+"                               APLNO,"   
			+"                               TO_CHAR(APLDATE, 'YYYYMMDD') APLDATE,"   
			+"                               TO_CHAR(APLDATE, 'HH24MISS') APLTIME,"   
			+"                               GIFT_NO,"   
			+"                               (SELECT GIFT_CHECK"   
			+"                                FROM   (SELECT GIFT_CHECK,"   
			+"                                               GIFT_NO"   
			+"                                        FROM   GIFTCREATE"   
			+"                                        UNION ALL"   
			+"                                        SELECT GIFT_CHECK,"   
			+"                                               GIFT_NO"   
			+"                                        FROM   GIFTDELETE)"   
			+"                                WHERE  GIFT_NO = RC_APPROVAL.GIFT_NO ) GIFT_CHECK,"   
			+"                               RC_AMT ORDERAMT,"   
			+"                               DECODE(APLSTATUS, 'O1', 'CHR', 'D1', 'CHR', 'TT1', 'TRN') TTYPE,"   
			+"                               DECODE(APLSTATUS, 'O1', '0', 'D1', '9', 'TT1', '0') ATYPE,"   
			+"                               NVL(PAY_METHDO, '0') PTYPE,"   
			+"                                   APLONLINEID MERCHANTID,"
			+ "								NVL(CANCEL_MEMO, ' ') cancelMemo"   
			+"                        FROM   RC_APPROVAL"   
			+"                        WHERE  APLONLINEID = 'gspopcards'"   
			+"                        AND    SALESDATE =  TO_CHAR(TO_DATE(#{workDt}) - 1 , 'YYYYMMDD')"   
			+"                        AND    APLSTATUS IN ('O1','D1','TT1')"   
			+"                        AND    'GSPOP'     = #{jobDivider}"   
			+"                        ) A"   
			+"             ) B"   
			+"          ON A.ORDER_NO = B.DEAL_NO"   
			+"         AND A.APPROVAL_NO = B.APPROVAL_NO"   
			+"         AND A.DEAL_TYPE = B.DEAL_TYPE"   
			+"         AND A.DEAL_DIVIDER = B.DEAL_DIVIDER"   
			+"        UNION ALL"
	        +"        SELECT B.JOB_DIVIDER                             jobDivider"
            +"               ,SUBSTR(A.DEAL_DT,0,8)                    saleDt"
            +"               ,A.STORE_CD                               storeCd"
            +"               ,''                                       dealType"
            +"               ,A.DEAL_DIVIDER                           dealDivider"
            +"               ,''                                       dealNo"
            +"               ,A.APPROVAL_NO                            approvalNo"
            +"               ,A.APPROVAL_DT                            approvalDt"
            +"               ,''                                       approvalTime"
            +"               ,B.ORDER_AMT                              dealAmt"
            +"               ,A.CARD_NO                                cardNo"
            +"               ,FNC_SETTLE_STATUS_CODE_NM(B.STATUS_DESC) statusNm"
            +"               ,B.STATUS_DESC                            statusDesc"
            + "				 ,' ' cancelMemo"
			+"           FROM SETTLE_GSNPOINT A"   
			+"               ,SETTLE_RESULT B"   
			+"          WHERE 1 = 1"
			+"            AND 'GSPOINT'     = DECODE(#{jobDivider},NULL,'GSPOINT',#{jobDivider})"
			+"            AND A.WORK_DT     = #{workDt}"   
			+"            AND B.JOB_DIVIDER = #{jobDivider}"   
			+"            AND B.SETTLE_SEQ  = A.SEQ"   
			+"            AND B.WORK_DT     = A.WORK_DT"   
			+"            AND B.STATUS     IN ('STS-0002' , 'STS-0004')"   
			+"        UNION ALL"
			+"         SELECT A.JOB_DIVIDER"   
			+"               ,SUBSTR(B.DEAL_DT,0,8) SALE_DT"   
			+"               ,B.STORE_CD"   
			+"               ,'' DEAL_TYPE"   
			+"               ,B.DEAL_DIVIDER"   
			+"               ,'' DEAL_NO"   
			+"               ,B.APPROVAL_NO"   
			+"               ,B.APPROVAL_DT"   
			+"               ,'' APPROVAL_TIME"   
			+"               ,B.USE_POINT DEAL_AMT"   
			+"               ,B.CARD_NO"   
			+"               ,FNC_SETTLE_STATUS_CODE_NM(A.STATUS_DESC) STATUS_NM"   
			+"               ,A.STATUS_DESC"
			+ "				 ,B.cancelMemo"   
			+"           FROM ("   
			+"                   SELECT *"   
			+"                     FROM SETTLE_RESULT"   
			+"                    WHERE WORK_DT     = #{workDt}"   
			+"                      AND JOB_DIVIDER = 'GSPOINT'"   
			+"                      AND 'GSPOINT'   = DECODE(#{jobDivider},NULL,'GSPOINT',#{jobDivider})"   
			+"                      AND STATUS      = 'STS-0003'"   
			+"                 ) A"   
			+"            INNER JOIN"   
			+"            ("   
			+"              SELECT ROWNUM"   
			+"                    ,A.GIFT_NO"   
			+"                    ,E.EXTEND_NO CARD_NO"   
			+"                    ,'E1010' STORE_CD"   
			+"                    ,TO_CHAR(A.APLDATE, 'YYYYMMDDHH24MISS') DEAL_DT"   
			+"                    ,DECODE(A.APLSTATUS, 'O1', '1', 'D1', '2', '0') DEAL_DIVIDER"   
			+"                    ,A.RC_AMT USE_POINT"   
			+"                    ,TO_CHAR(A.APLDATE, 'YYYYMMDD') APPROVAL_DT"   
			+"                    ,NVL(A.C_APLNO, ' ') APPROVAL_NO"   
			+"                    ,A.APLORDERNO DEAL_NO"   
			+"                    ,A.APLONLINEID MERCHANTID"
			+ "					  ,NVL(A.CANCEL_MEMO, ' ') cancelMemo"   
			+"                FROM RC_APPROVAL A"   
			+"                   , GIFTEXTEND E"   
			+"               WHERE A.GIFT_NO = E.GIFT_NO"   
			+"                 AND A.APLONLINEID = 'gsrpoppoint'"   
			+"                 AND A.SALESDATE   = TO_CHAR(TO_DATE(#{workDt}) -1,'YYYYMMDD')"   
			+"                 AND A.PAY_METHDO IN ('2', 'A2')"   
			+"                 AND 'GSPOINT'     = DECODE(#{jobDivider},NULL,'GSPOINT',#{jobDivider})"   
			+"              ) B"   
			+"           ON A.APPROVAL_NO = B.APPROVAL_NO"   
			+"          AND A.DEAL_DIVIDER = B.DEAL_DIVIDER"
			+"     ) X"
			;
	
	public static final String GSSM_ERROR_DETAIL_SELECT_TOTAL_CNT_SQL =""
			+"         SELECT COUNT(1) count"
			+"           FROM ("
			+"	                SELECT B.JOB_DIVIDER                            jobDivider"
			+"	                      ,A.SALE_DT                                saleDt"
			+"	                      ,A.STORE_CD                               storeCd"
			+"	                      ,A.DEAL_TYPE                              dealType"
			+"	                      ,A.DEAL_DIVIDER                           dealDivider"
			+"	                      ,A.DEAL_NO                                dealNo"
			+"	                      ,A.APPROVAL_NO                            approvalNo"
			+"	                      ,A.APPROVAL_DT                            approvalDt"
			+"	                      ,A.APPROVAL_TIME                          approvalTime"
			+"	                      ,A.DEAL_AMT                               dealAmt"
			+"	                      ,A.CARD_NO                                cardNo"
			+"	                      ,FNC_SETTLE_STATUS_CODE_NM(B.STATUS_DESC) statusNm"
			+"	                      ,B.STATUS_DESC                            statusDesc"
			+"	                  FROM SETTLE_GS A"   
			+"	                      ,SETTLE_RESULT B"   
			+"	                 WHERE A.JOB_DIVIDER  = #{jobDivider}"   
			+"	                   AND A.WORK_DT      = #{workDt}"   
			+"	                   AND B.JOB_DIVIDER  = A.JOB_DIVIDER"   
			+"	                   AND B.SETTLE_SEQ   = A.SEQ"   
			+"	                   AND B.WORK_DT      = A.WORK_DT"   
			+"	                   AND B.STATUS     IN ('STS-0002' , 'STS-0004')"   
			+"	                 UNION ALL"   
			+"	                SELECT A.JOB_DIVIDER"   
			+"	                      ,B.SALE_DT"   
			+"	                      ,B.STORE_CD"   
			+"	                      ,B.DEAL_TYPE"   
			+"	                      ,B.DEAL_DIVIDER"   
			+"	                      ,B.DEAL_NO"   
			+"	                      ,B.APPROVAL_NO"   
			+"	                      ,B.APPROVAL_DT"   
			+"	                      ,B.APPROVAL_TIME"   
			+"	                      ,B.DEAL_AMT"   
			+"	                      ,B.CARD_NO"   
			+"	                      ,FNC_SETTLE_STATUS_CODE_NM(A.STATUS_DESC) STATUS_NM"   
			+"	                      ,A.STATUS_DESC"   
			+"	                FROM ("   
			+"	                      SELECT *"   
			+"	                        FROM SETTLE_RESULT B"   
			+"	                       WHERE JOB_DIVIDER = 'GSSM'"   
			+"	                         AND WORK_DT     = #{workDt}"   
			+"	                         AND STATUS      = 'STS-0003'"   
			+"	                         AND 'GSSM'      = #{jobDivider}"   
			+"	                    ) A"   
			+"	                  INNER JOIN"   
			+"	                   ("   
			+"	                   SELECT  SALESDATE SALE_DT"   
			+"	                           ,BRANCHCODE STORE_CD"   
			+"	                           ,ORDERNO DEAL_NO"   
			+"	                           ,APLNO APPROVAL_NO"   
			+"	                           ,APLDATE APPROVAL_DT"   
			+"	                           ,APLTIME APPROVAL_TIME"   
			+"	                           ,A.GIFT_NO"   
			+"	                           ,(SELECT EXTEND_NO"   
			+"	                               FROM GIFTEXTEND"   
			+"	                              WHERE GIFT_NO = A.GIFT_NO) AS CARD_NO"   
			+"	                           ,ORDERAMT DEAL_AMT"   
			+"	                           ,TTYPE DEAL_TYPE"   
			+"	                           ,ATYPE DEAL_DIVIDER"   
			+"	                           ,MERCHANTID"   
			+"	                     FROM   (SELECT SALESDATE,"   
			+"	                                    BRANCHCODE,"   
			+"	                                    ORDERNO,"   
			+"	                                    APLNO,"   
			+"	                                    APLDATE,"   
			+"	                                    APLTIME,"   
			+"	                                    (SELECT MAX(B.GIFT_NO)"   
			+"	                                     FROM   ORDERDETAIL A,"   
			+"	                                            (SELECT GIFT_NO,"   
			+"	                                                    SEQ_NO"   
			+"	                                             FROM   GIFTCREATE"   
			+"	                                             UNION ALL"   
			+"	                                             SELECT GIFT_NO,"   
			+"	                                                    SEQ_NO"   
			+"	                                             FROM   GIFTDELETE) B"   
			+"	                                     WHERE  A.C_SERIAL = B.SEQ_NO"   
			+"	                                     AND    A.TRANSID = ORDERLIST_POS.TRANSID ) GIFT_NO,"   
			+"	                                    (SELECT MAX(B.GIFT_CHECK)"   
			+"	                                     FROM   ORDERDETAIL A,"   
			+"	                                            (SELECT GIFT_CHECK,"   
			+"	                                                    SEQ_NO"   
			+"	                                             FROM   GIFTCREATE"   
			+"	                                             UNION ALL"   
			+"	                                             SELECT GIFT_CHECK,"   
			+"	                                                    SEQ_NO"   
			+"	                                             FROM   GIFTDELETE) B"   
			+"	                                     WHERE  A.C_SERIAL = B.SEQ_NO"   
			+"	                                     AND    A.TRANSID = ORDERLIST_POS.TRANSID ) GIFT_CHECK,"   
			+"	                                    ORDERAMT,"   
			+"	                                    DECODE(RESULTCODE, 'O1', 'PAY', 'R1', 'REF', 'D1', 'PAY', 'T1', 'REF') TTYPE,"   
			+"	                                    DECODE(RESULTCODE, 'O1', '0', 'R1', '0', 'D1', '9', 'T1', '9') ATYPE,"   
			+"	                                    '0' PTYPE,"   
			+"	                                    MERCHANTID"   
			+"	                             FROM   ORDERLIST_POS"   
			+"	                             WHERE  MERCHANTID = 'gssmpopp'"   
			+"	                             AND    SALESDATE =  TO_CHAR(TO_DATE(#{workDt}) - 1 , 'YYYYMMDD')"   
			+"	                             AND 'GSSM'      = #{jobDivider}"   
			+"	                             UNION ALL"   
			+"	                             SELECT SALESDATE,"   
			+"	                                    BRANCHCODE,"   
			+"	                                    APLORDERNO ORDERNO,"   
			+"	                                    APLNO,"   
			+"	                                    APLDATE,"   
			+"	                                    APLTIME,"   
			+"	                                    (SELECT MAX(TICKET_SNO)"   
			+"	                                     FROM   ACTIVE_APL_DETAIL"   
			+"	                                     WHERE  APLID = ACTIVE_APPROVAL.APLID ) GIFT_NO,"   
			+"	                                    (SELECT MAX(B.GIFT_CHECK)"   
			+"	                                     FROM   ACTIVE_APL_DETAIL A,"   
			+"	                                            (SELECT GIFT_CHECK,"   
			+"	                                                    GIFT_NO"   
			+"	                                             FROM   GIFTCREATE"   
			+"	                                             UNION ALL"   
			+"	                                             SELECT GIFT_CHECK,"   
			+"	                                                    GIFT_NO"   
			+"	                                             FROM   GIFTDELETE) B"   
			+"	                                     WHERE  A.TICKET_SNO = B.GIFT_NO"   
			+"	                                     AND    A.APLID = ACTIVE_APPROVAL.APLID ) GIFT_CHECK,"   
			+"	                                    (SELECT CREATE_AMT"   
			+"	                                     FROM   (SELECT GIFT_NO,"   
			+"	                                                    CREATE_AMT"   
			+"	                                             FROM   GIFTDELETE ) A"   
			+"	                                     WHERE  GIFT_NO = (SELECT MAX(TICKET_SNO)"   
			+"	                                             FROM   ACTIVE_APL_DETAIL A"   
			+"	                                             WHERE  APLID = ACTIVE_APPROVAL.APLID )"   
			+"	                                     UNION ALL"   
			+"	                                     SELECT CREATE_AMT"   
			+"	                                     FROM   (SELECT GIFT_NO,"   
			+"	                                                    CREATE_AMT"   
			+"	                                             FROM   GIFTCREATE ) A"   
			+"	                                     WHERE  GIFT_NO = (SELECT MAX(TICKET_SNO)"   
			+"	                                             FROM   ACTIVE_APL_DETAIL A"   
			+"	                                             WHERE  APLID = ACTIVE_APPROVAL.APLID ) )ORDERAMT,"   
			+"	                                    'ACT' TTYPE,"   
			+"	                                    DECODE(APLSTATUS, '1', '0', '2', '9') ATYPE,"   
			+"	                                    NVL(PAY_METHDO, '0') PTYPE,"   
			+"	                                    APLONLINEID MERCHANTID"   
			+"	                             FROM   ACTIVE_APPROVAL"   
			+"	                             WHERE  APLONLINEID = 'gssmpops'"   
			+"	                             AND    SALESDATE =  TO_CHAR(TO_DATE(#{workDt}) - 1 , 'YYYYMMDD')"   
			+"	                             AND 'GSSM'      = #{jobDivider}"   
			+"	                             UNION ALL"   
			+"	                             SELECT SALESDATE,"   
			+"	                                    BRANCHCODE,"   
			+"	                                    APLORDERNO ORDERNO,"   
			+"	                                    APLNO,"   
			+"	                                    TO_CHAR(APLDATE, 'YYYYMMDD') APLDATE,"   
			+"	                                    TO_CHAR(APLDATE, 'HH24MISS') APLTIME,"   
			+"	                                    GIFT_NO,"   
			+"	                                    (SELECT GIFT_CHECK"   
			+"	                                     FROM   (SELECT GIFT_CHECK,"   
			+"	                                                    GIFT_NO"   
			+"	                                             FROM   GIFTCREATE"   
			+"	                                             UNION ALL"   
			+"	                                             SELECT GIFT_CHECK,"   
			+"	                                                    GIFT_NO"   
			+"	                                             FROM   GIFTDELETE)"   
			+"	                                     WHERE  GIFT_NO = RC_APPROVAL.GIFT_NO ) GIFT_CHECK,"   
			+"	                                    RC_AMT ORDERAMT,"   
			+"	                                    DECODE(APLSTATUS, 'O1', 'CHR', 'D1', 'CHR', 'TS1', 'TRN') TTYPE,"   
			+"	                                    DECODE(APLSTATUS, 'O1', '0', 'D1', '9', 'TS1', '0') ATYPE,"   
			+"	                                    NVL(PAY_METHDO, '0') PTYPE,"   
			+"	                                        APLONLINEID MERCHANTID"   
			+"	                             FROM   RC_APPROVAL"   
			+"	                             WHERE  APLONLINEID = 'gssmpops'"   
			+"	                             AND    SALESDATE =  TO_CHAR(TO_DATE(#{workDt}) - 1 , 'YYYYMMDD')"   
			+"	                             AND    APLSTATUS IN ('O1','D1','TS1')"   
			+"	                             AND    'GSSM'     = #{jobDivider}"   
			+"	                             ) A"   
			+"	                     ) B"   
			+"	                  ON A.ORDER_NO = B.DEAL_NO"   
			+"	                 AND A.APPROVAL_NO = B.APPROVAL_NO"   
			+"	                 AND A.DEAL_TYPE = B.DEAL_TYPE"   
			+"	                 AND A.DEAL_DIVIDER = B.DEAL_DIVIDER"   
			+"                 ) X";

	public static final String GSPOP_ERROR_DETAIL_SELECT_TOTAL_CNT_SQL =""
			+"         SELECT COUNT(1) count"
			+"           FROM ("
			+"	                SELECT B.JOB_DIVIDER                            jobDivider"
			+"	                      ,A.SALE_DT                                saleDt"
			+"	                      ,A.STORE_CD                               storeCd"
			+"	                      ,A.DEAL_TYPE                              dealType"
			+"	                      ,A.DEAL_DIVIDER                           dealDivider"
			+"	                      ,A.DEAL_NO                                dealNo"
			+"	                      ,A.APPROVAL_NO                            approvalNo"
			+"	                      ,A.APPROVAL_DT                            approvalDt"
			+"	                      ,A.APPROVAL_TIME                          approvalTime"
			+"	                      ,A.DEAL_AMT                               dealAmt"
			+"	                      ,A.CARD_NO                                cardNo"
			+"	                      ,FNC_SETTLE_STATUS_CODE_NM(B.STATUS_DESC) statusNm"
			+"	                      ,B.STATUS_DESC                            statusDesc"
			+"	                  FROM SETTLE_GS A"   
			+"	                      ,SETTLE_RESULT B"   
			+"	                 WHERE A.JOB_DIVIDER  = #{jobDivider}"   
			+"	                   AND A.WORK_DT      = #{workDt}"   
			+"	                   AND B.JOB_DIVIDER  = A.JOB_DIVIDER"   
			+"	                   AND B.SETTLE_SEQ   = A.SEQ"   
			+"	                   AND B.WORK_DT      = A.WORK_DT"   
			+"	                   AND B.STATUS     IN ('STS-0002' , 'STS-0004')"   
			+"	                UNION ALL"   
			+"	                SELECT A.JOB_DIVIDER"   
			+"	                      ,B.SALE_DT"   
			+"	                      ,B.STORE_CD"   
			+"	                      ,B.DEAL_TYPE"   
			+"	                      ,B.DEAL_DIVIDER"   
			+"	                      ,B.DEAL_NO"   
			+"	                      ,B.APPROVAL_NO"   
			+"	                      ,B.APPROVAL_DT"   
			+"	                      ,B.APPROVAL_TIME"   
			+"	                      ,B.DEAL_AMT"   
			+"	                      ,B.CARD_NO"   
			+"	                      ,FNC_SETTLE_STATUS_CODE_NM(A.STATUS_DESC) STATUS_NM"   
			+"	                      ,A.STATUS_DESC"   
			+"	                 FROM ("   
			+"	                      SELECT *"   
			+"	                        FROM SETTLE_RESULT B"   
			+"	                       WHERE JOB_DIVIDER = 'GSPOP'"   
			+"	                         AND 'GSPOP'     = #{jobDivider}"   
			+"	                         AND WORK_DT     = #{workDt}"   
			+"	                         AND STATUS      = 'STS-0003'"   
			+"	                    ) A"   
			+"	                  INNER JOIN"   
			+"	                   ("   
			+"	                      SELECT  SALESDATE SALE_DT"   
			+"	                              ,BRANCHCODE STORE_CD"   
			+"	                              ,ORDERNO DEAL_NO"   
			+"	                              ,APLNO APPROVAL_NO"   
			+"	                              ,APLDATE APPROVAL_DT"   
			+"	                              ,APLTIME APPROVAL_TIME"   
			+"	                              ,A.GIFT_NO"   
			+"	                              ,(SELECT EXTEND_NO"   
			+"	                                  FROM GIFTEXTEND"   
			+"	                                 WHERE GIFT_NO = A.GIFT_NO) AS CARD_NO"   
			+"	                              ,ORDERAMT DEAL_AMT"   
			+"	                              ,TTYPE DEAL_TYPE"   
			+"	                              ,ATYPE DEAL_DIVIDER"   
			+"	                              ,MERCHANTID"   
			+"	                        FROM   (SELECT SALESDATE,"   
			+"	                                       BRANCHCODE,"   
			+"	                                       ORDERNO,"   
			+"	                                       APLNO,"   
			+"	                                       APLDATE,"   
			+"	                                       APLTIME,"   
			+"	                                       (SELECT MAX(B.GIFT_NO)"   
			+"	                                        FROM   ORDERDETAIL A,"   
			+"	                                               (SELECT GIFT_NO,"   
			+"	                                                       SEQ_NO"   
			+"	                                                FROM   GIFTCREATE"   
			+"	                                                UNION ALL"   
			+"	                                                SELECT GIFT_NO,"   
			+"	                                                       SEQ_NO"   
			+"	                                                FROM   GIFTDELETE) B"   
			+"	                                        WHERE  A.C_SERIAL = B.SEQ_NO"   
			+"	                                        AND    A.TRANSID = ORDERLIST_POS.TRANSID ) GIFT_NO,"   
			+"	                                       (SELECT MAX(B.GIFT_CHECK)"   
			+"	                                        FROM   ORDERDETAIL A,"   
			+"	                                               (SELECT GIFT_CHECK,"   
			+"	                                                       SEQ_NO"   
			+"	                                                FROM   GIFTCREATE"   
			+"	                                                UNION ALL"   
			+"	                                                SELECT GIFT_CHECK,"   
			+"	                                                       SEQ_NO"   
			+"	                                                FROM   GIFTDELETE) B"   
			+"	                                        WHERE  A.C_SERIAL = B.SEQ_NO"   
			+"	                                        AND    A.TRANSID = ORDERLIST_POS.TRANSID ) GIFT_CHECK,"   
			+"	                                       ORDERAMT,"   
			+"	                                       DECODE(RESULTCODE, 'O1', 'PAY', 'R1', 'REF', 'D1', 'PAY', 'T1', 'REF') TTYPE,"   
			+"	                                       DECODE(RESULTCODE, 'O1', '0', 'R1', '0', 'D1', '9', 'T1', '9') ATYPE,"   
			+"	                                       '0' PTYPE,"   
			+"	                                       MERCHANTID"   
			+"	                                FROM   ORDERLIST_POS"   
			+"	                                WHERE  MERCHANTID = 'gspopcardp'"   
			+"	                                AND    'GSPOP'     = #{jobDivider}"   
			+"	                                AND    SALESDATE =  TO_CHAR(TO_DATE(#{workDt}) - 1 , 'YYYYMMDD')"   
			+"	                                UNION ALL"   
			+"	                                SELECT SALESDATE,"   
			+"	                                       BRANCHCODE,"   
			+"	                                       APLORDERNO ORDERNO,"   
			+"	                                       APLNO,"   
			+"	                                       APLDATE,"   
			+"	                                       APLTIME,"   
			+"	                                       (SELECT MAX(TICKET_SNO)"   
			+"	                                        FROM   ACTIVE_APL_DETAIL"   
			+"	                                        WHERE  APLID = ACTIVE_APPROVAL.APLID ) GIFT_NO,"   
			+"	                                       (SELECT MAX(B.GIFT_CHECK)"   
			+"	                                        FROM   ACTIVE_APL_DETAIL A,"   
			+"	                                               (SELECT GIFT_CHECK,"   
			+"	                                                       GIFT_NO"   
			+"	                                                FROM   GIFTCREATE"   
			+"	                                                UNION ALL"   
			+"	                                                SELECT GIFT_CHECK,"   
			+"	                                                       GIFT_NO"   
			+"	                                                FROM   GIFTDELETE) B"   
			+"	                                        WHERE  A.TICKET_SNO = B.GIFT_NO"   
			+"	                                        AND    A.APLID = ACTIVE_APPROVAL.APLID ) GIFT_CHECK,"   
			+"	                                       (SELECT CREATE_AMT"   
			+"	                                        FROM   (SELECT GIFT_NO,"   
			+"	                                                       CREATE_AMT"   
			+"	                                                FROM   GIFTDELETE ) A"   
			+"	                                        WHERE  GIFT_NO = (SELECT MAX(TICKET_SNO)"   
			+"	                                                FROM   ACTIVE_APL_DETAIL A"   
			+"	                                                WHERE  APLID = ACTIVE_APPROVAL.APLID )"   
			+"	                                        UNION ALL"   
			+"	                                        SELECT CREATE_AMT"   
			+"	                                        FROM   (SELECT GIFT_NO,"   
			+"	                                                       CREATE_AMT"   
			+"	                                                FROM   GIFTCREATE ) A"   
			+"	                                        WHERE  GIFT_NO = (SELECT MAX(TICKET_SNO)"   
			+"	                                                FROM   ACTIVE_APL_DETAIL A"   
			+"	                                                WHERE  APLID = ACTIVE_APPROVAL.APLID ) )ORDERAMT,"   
			+"	                                       'ACT' TTYPE,"   
			+"	                                       DECODE(APLSTATUS, '1', '0', '2', '9') ATYPE,"   
			+"	                                       NVL(PAY_METHDO, '0') PTYPE,"   
			+"	                                       APLONLINEID MERCHANTID"   
			+"	                                FROM   ACTIVE_APPROVAL"   
			+"	                                WHERE  APLONLINEID = 'gspopcards'"   
			+"	                                AND    SALESDATE =  TO_CHAR(TO_DATE(#{workDt}) - 1 , 'YYYYMMDD')"   
			+"	                                AND    'GSPOP'     = #{jobDivider}"   
			+"	                                UNION ALL"   
			+"	                                SELECT SALESDATE,"   
			+"	                                       BRANCHCODE,"   
			+"	                                       APLORDERNO ORDERNO,"   
			+"	                                       APLNO,"   
			+"	                                       TO_CHAR(APLDATE, 'YYYYMMDD') APLDATE,"   
			+"	                                       TO_CHAR(APLDATE, 'HH24MISS') APLTIME,"   
			+"	                                       GIFT_NO,"   
			+"	                                       (SELECT GIFT_CHECK"   
			+"	                                        FROM   (SELECT GIFT_CHECK,"   
			+"	                                                       GIFT_NO"   
			+"	                                                FROM   GIFTCREATE"   
			+"	                                                UNION ALL"   
			+"	                                                SELECT GIFT_CHECK,"   
			+"	                                                       GIFT_NO"   
			+"	                                                FROM   GIFTDELETE)"   
			+"	                                        WHERE  GIFT_NO = RC_APPROVAL.GIFT_NO ) GIFT_CHECK,"   
			+"	                                       RC_AMT ORDERAMT,"   
			+"	                                       DECODE(APLSTATUS, 'O1', 'CHR', 'D1', 'CHR', 'TT1', 'TRN') TTYPE,"   
			+"	                                       DECODE(APLSTATUS, 'O1', '0', 'D1', '9', 'TT1', '0') ATYPE,"   
			+"	                                       NVL(PAY_METHDO, '0') PTYPE,"   
			+"	                                           APLONLINEID MERCHANTID"   
			+"	                                FROM   RC_APPROVAL"   
			+"	                                WHERE  APLONLINEID = 'gspopcards'"   
			+"	                                AND    SALESDATE =  TO_CHAR(TO_DATE(#{workDt}) - 1 , 'YYYYMMDD')"   
			+"	                                AND    APLSTATUS IN ('O1','D1','TT1')"   
			+"	                                AND    'GSPOP'     = #{jobDivider}"   
			+"	                                ) A"   
			+"	                     ) B"   
			+"	                  ON A.ORDER_NO = B.DEAL_NO"   
			+"	                 AND A.APPROVAL_NO = B.APPROVAL_NO"   
			+"	                 AND A.DEAL_TYPE = B.DEAL_TYPE"   
			+"	                 AND A.DEAL_DIVIDER = B.DEAL_DIVIDER"   
			+"                 ) X";
	
	public static final String GSHB_ERROR_DETAIL_SELECT_TOTAL_CNT_SQL =""
			+"         SELECT COUNT(1) count"
			+"           FROM ("
			+"	                SELECT B.JOB_DIVIDER                            jobDivider"
			+"	                      ,A.SALE_DT                                saleDt"
			+"	                      ,A.STORE_CD                               storeCd"
			+"	                      ,A.DEAL_TYPE                              dealType"
			+"	                      ,A.DEAL_DIVIDER                           dealDivider"
			+"	                      ,A.DEAL_NO                                dealNo"
			+"	                      ,A.APPROVAL_NO                            approvalNo"
			+"	                      ,A.APPROVAL_DT                            approvalDt"
			+"	                      ,A.APPROVAL_TIME                          approvalTime"
			+"	                      ,A.DEAL_AMT                               dealAmt"
			+"	                      ,A.CARD_NO                                cardNo"
			+"	                      ,FNC_SETTLE_STATUS_CODE_NM(B.STATUS_DESC) statusNm"
			+"	                      ,B.STATUS_DESC                            statusDesc"
			+"	                  FROM SETTLE_GS A"   
			+"	                      ,SETTLE_RESULT B"   
			+"	                 WHERE A.JOB_DIVIDER  = #{jobDivider}"   
			+"	                   AND A.WORK_DT      = #{workDt}"   
			+"	                   AND B.JOB_DIVIDER  = A.JOB_DIVIDER"   
			+"	                   AND B.SETTLE_SEQ   = A.SEQ"   
			+"	                   AND B.WORK_DT      = A.WORK_DT"   
			+"	                   AND B.STATUS     IN ('STS-0002' , 'STS-0004')"   
			+"	                UNION ALL"   
			+"	                SELECT A.JOB_DIVIDER"   
			+"	                      ,B.SALE_DT"   
			+"	                      ,B.STORE_CD"   
			+"	                      ,B.DEAL_TYPE"   
			+"	                      ,B.DEAL_DIVIDER"   
			+"	                      ,B.DEAL_NO"   
			+"	                      ,B.APPROVAL_NO"   
			+"	                      ,B.APPROVAL_DT"   
			+"	                      ,B.APPROVAL_TIME"   
			+"	                      ,B.DEAL_AMT"   
			+"	                      ,B.CARD_NO"   
			+"	                      ,FNC_SETTLE_STATUS_CODE_NM(A.STATUS_DESC) STATUS_NM"   
			+"	                      ,A.STATUS_DESC"   
			+"	                 FROM ("   
			+"	                      SELECT *"   
			+"	                        FROM SETTLE_RESULT B"   
			+"	                       WHERE JOB_DIVIDER = 'GSHB'"   
			+"	                         AND 'GSPOP'     = #{jobDivider}"   
			+"	                         AND WORK_DT     = #{workDt}"   
			+"	                         AND STATUS      = 'STS-0003'"   
			+"	                    ) A"   
			+"	                  INNER JOIN"   
			+"	                   ("   
			+"	                      SELECT  SALESDATE SALE_DT"   
			+"	                              ,BRANCHCODE STORE_CD"   
			+"	                              ,ORDERNO DEAL_NO"   
			+"	                              ,APLNO APPROVAL_NO"   
			+"	                              ,APLDATE APPROVAL_DT"   
			+"	                              ,APLTIME APPROVAL_TIME"   
			+"	                              ,A.GIFT_NO"   
			+"	                              ,(SELECT EXTEND_NO"   
			+"	                                  FROM GIFTEXTEND"   
			+"	                                 WHERE GIFT_NO = A.GIFT_NO) AS CARD_NO"   
			+"	                              ,ORDERAMT DEAL_AMT"   
			+"	                              ,TTYPE DEAL_TYPE"   
			+"	                              ,ATYPE DEAL_DIVIDER"   
			+"	                              ,MERCHANTID"   
			+"	                        FROM   (SELECT SALESDATE,"   
			+"	                                       BRANCHCODE,"   
			+"	                                       ORDERNO,"   
			+"	                                       APLNO,"   
			+"	                                       APLDATE,"   
			+"	                                       APLTIME,"   
			+"	                                       (SELECT MAX(B.GIFT_NO)"   
			+"	                                        FROM   ORDERDETAIL A,"   
			+"	                                               (SELECT GIFT_NO,"   
			+"	                                                       SEQ_NO"   
			+"	                                                FROM   GIFTCREATE"   
			+"	                                                UNION ALL"   
			+"	                                                SELECT GIFT_NO,"   
			+"	                                                       SEQ_NO"   
			+"	                                                FROM   GIFTDELETE) B"   
			+"	                                        WHERE  A.C_SERIAL = B.SEQ_NO"   
			+"	                                        AND    A.TRANSID = ORDERLIST_POS.TRANSID ) GIFT_NO,"   
			+"	                                       (SELECT MAX(B.GIFT_CHECK)"   
			+"	                                        FROM   ORDERDETAIL A,"   
			+"	                                               (SELECT GIFT_CHECK,"   
			+"	                                                       SEQ_NO"   
			+"	                                                FROM   GIFTCREATE"   
			+"	                                                UNION ALL"   
			+"	                                                SELECT GIFT_CHECK,"   
			+"	                                                       SEQ_NO"   
			+"	                                                FROM   GIFTDELETE) B"   
			+"	                                        WHERE  A.C_SERIAL = B.SEQ_NO"   
			+"	                                        AND    A.TRANSID = ORDERLIST_POS.TRANSID ) GIFT_CHECK,"   
			+"	                                       ORDERAMT,"   
			+"	                                       DECODE(RESULTCODE, 'O1', 'PAY', 'R1', 'REF', 'D1', 'PAY', 'T1', 'REF') TTYPE,"   
			+"	                                       DECODE(RESULTCODE, 'O1', '0', 'R1', '0', 'D1', '9', 'T1', '9') ATYPE,"   
			+"	                                       '0' PTYPE,"   
			+"	                                       MERCHANTID"   
			+"	                                FROM   ORDERLIST_POS"   
			+"	                                WHERE  MERCHANTID = 'gswatsonspop'"   
			+"	                                AND    'GSHB'     = #{jobDivider}"   
			+"	                                AND    SALESDATE =  TO_CHAR(TO_DATE(#{workDt}) - 1 , 'YYYYMMDD')"   
			+"	                                UNION ALL"   
			+"	                                SELECT SALESDATE,"   
			+"	                                       BRANCHCODE,"   
			+"	                                       APLORDERNO ORDERNO,"   
			+"	                                       APLNO,"   
			+"	                                       APLDATE,"   
			+"	                                       APLTIME,"   
			+"	                                       (SELECT MAX(TICKET_SNO)"   
			+"	                                        FROM   ACTIVE_APL_DETAIL"   
			+"	                                        WHERE  APLID = ACTIVE_APPROVAL.APLID ) GIFT_NO,"   
			+"	                                       (SELECT MAX(B.GIFT_CHECK)"   
			+"	                                        FROM   ACTIVE_APL_DETAIL A,"   
			+"	                                               (SELECT GIFT_CHECK,"   
			+"	                                                       GIFT_NO"   
			+"	                                                FROM   GIFTCREATE"   
			+"	                                                UNION ALL"   
			+"	                                                SELECT GIFT_CHECK,"   
			+"	                                                       GIFT_NO"   
			+"	                                                FROM   GIFTDELETE) B"   
			+"	                                        WHERE  A.TICKET_SNO = B.GIFT_NO"   
			+"	                                        AND    A.APLID = ACTIVE_APPROVAL.APLID ) GIFT_CHECK,"   
			+"	                                       (SELECT CREATE_AMT"   
			+"	                                        FROM   (SELECT GIFT_NO,"   
			+"	                                                       CREATE_AMT"   
			+"	                                                FROM   GIFTDELETE ) A"   
			+"	                                        WHERE  GIFT_NO = (SELECT MAX(TICKET_SNO)"   
			+"	                                                FROM   ACTIVE_APL_DETAIL A"   
			+"	                                                WHERE  APLID = ACTIVE_APPROVAL.APLID )"   
			+"	                                        UNION ALL"   
			+"	                                        SELECT CREATE_AMT"   
			+"	                                        FROM   (SELECT GIFT_NO,"   
			+"	                                                       CREATE_AMT"   
			+"	                                                FROM   GIFTCREATE ) A"   
			+"	                                        WHERE  GIFT_NO = (SELECT MAX(TICKET_SNO)"   
			+"	                                                FROM   ACTIVE_APL_DETAIL A"   
			+"	                                                WHERE  APLID = ACTIVE_APPROVAL.APLID ) )ORDERAMT,"   
			+"	                                       'ACT' TTYPE,"   
			+"	                                       DECODE(APLSTATUS, '1', '0', '2', '9') ATYPE,"   
			+"	                                       NVL(PAY_METHDO, '0') PTYPE,"   
			+"	                                       APLONLINEID MERCHANTID"   
			+"	                                FROM   ACTIVE_APPROVAL"   
			+"	                                WHERE  APLONLINEID = 'gswatsonspops'"   
			+"	                                AND    SALESDATE =  TO_CHAR(TO_DATE(#{workDt}) - 1 , 'YYYYMMDD')"   
			+"	                                AND    'GSHB'     = #{jobDivider}"   
			+"	                                UNION ALL"   
			+"	                                SELECT SALESDATE,"   
			+"	                                       BRANCHCODE,"   
			+"	                                       APLORDERNO ORDERNO,"   
			+"	                                       APLNO,"   
			+"	                                       TO_CHAR(APLDATE, 'YYYYMMDD') APLDATE,"   
			+"	                                       TO_CHAR(APLDATE, 'HH24MISS') APLTIME,"   
			+"	                                       GIFT_NO,"   
			+"	                                       (SELECT GIFT_CHECK"   
			+"	                                        FROM   (SELECT GIFT_CHECK,"   
			+"	                                                       GIFT_NO"   
			+"	                                                FROM   GIFTCREATE"   
			+"	                                                UNION ALL"   
			+"	                                                SELECT GIFT_CHECK,"   
			+"	                                                       GIFT_NO"   
			+"	                                                FROM   GIFTDELETE)"   
			+"	                                        WHERE  GIFT_NO = RC_APPROVAL.GIFT_NO ) GIFT_CHECK,"   
			+"	                                       RC_AMT ORDERAMT,"   
			+"	                                       DECODE(APLSTATUS, 'O1', 'CHR', 'D1', 'CHR', 'TT1', 'TRN') TTYPE,"   
			+"	                                       DECODE(APLSTATUS, 'O1', '0', 'D1', '9', 'TT1', '0') ATYPE,"   
			+"	                                       NVL(PAY_METHDO, '0') PTYPE,"   
			+"	                                           APLONLINEID MERCHANTID"   
			+"	                                FROM   RC_APPROVAL"   
			+"	                                WHERE  APLONLINEID = 'gswatsonspops'"   
			+"	                                AND    SALESDATE =  TO_CHAR(TO_DATE(#{workDt}) - 1 , 'YYYYMMDD')"   
			+"	                                AND    APLSTATUS IN ('O1','D1','TT1')"   
			+"	                                AND    'GSHB'     = #{jobDivider}"   
			+"	                                ) A"   
			+"	                     ) B"   
			+"	                  ON A.ORDER_NO = B.DEAL_NO"   
			+"	                 AND A.APPROVAL_NO = B.APPROVAL_NO"   
			+"	                 AND A.DEAL_TYPE = B.DEAL_TYPE"   
			+"	                 AND A.DEAL_DIVIDER = B.DEAL_DIVIDER"   
			+"                 ) X";
	
	public static final String GS_POINT_ERROR_DETAIL_SELECT_TOTAL_CNT_SQL =""
			+"         SELECT COUNT(1) count"
			+"           FROM ("
	        +"                  SELECT B.JOB_DIVIDER                             jobDivider"
            +"                         ,SUBSTR(A.DEAL_DT,0,8)                    saleDt"
            +"                         ,A.STORE_CD                               storeCd"
            +"                         ,''                                       dealType"
            +"                         ,A.DEAL_DIVIDER                           dealDivider"
            +"                         ,''                                       dealNo"
            +"                         ,A.APPROVAL_NO                            approvalNo"
            +"                         ,A.APPROVAL_DT                            approvalDt"
            +"                         ,''                                       approvalTime"
            +"                         ,B.ORDER_AMT                              dealAmt"
            +"                         ,A.CARD_NO                                cardNo"
            +"                         ,FNC_SETTLE_STATUS_CODE_NM(B.STATUS_DESC) statusNm"
            +"                         ,B.STATUS_DESC                            statusDesc"
			+"                     FROM SETTLE_GSNPOINT A"   
			+"                         ,SETTLE_RESULT B"   
			+"                    WHERE 1 = 1"
			+"                      AND 'GSPOINT'     = DECODE(#{jobDivider},NULL,'GSPOINT',#{jobDivider})"
			+"                      AND A.WORK_DT     = #{workDt}"   
			+"                      AND B.JOB_DIVIDER = #{jobDivider}"   
			+"                      AND B.SETTLE_SEQ  = A.SEQ"   
			+"                      AND B.WORK_DT     = A.WORK_DT"   
			+"                      AND B.STATUS     IN ('STS-0002' , 'STS-0004')"   
			+"                  UNION ALL"
			+"                   SELECT A.JOB_DIVIDER"   
			+"                         ,SUBSTR(B.DEAL_DT,0,8) SALE_DT"   
			+"                         ,B.STORE_CD"   
			+"                         ,'' DEAL_TYPE"   
			+"                         ,B.DEAL_DIVIDER"   
			+"                         ,'' DEAL_NO"   
			+"                         ,B.APPROVAL_NO"   
			+"                         ,B.APPROVAL_DT"   
			+"                         ,'' APPROVAL_TIME"   
			+"                         ,B.USE_POINT DEAL_AMT"   
			+"                         ,B.CARD_NO"   
			+"                         ,FNC_SETTLE_STATUS_CODE_NM(A.STATUS_DESC) STATUS_NM"   
			+"                         ,A.STATUS_DESC"   
			+"                     FROM ("   
			+"                             SELECT *"   
			+"                               FROM SETTLE_RESULT"   
			+"                              WHERE WORK_DT     = #{workDt}"   
			+"                                AND JOB_DIVIDER = 'GSPOINT'"   
			+"                                AND 'GSPOINT'   = DECODE(#{jobDivider},NULL,'GSPOINT',#{jobDivider})"   
			+"                                AND STATUS      = 'STS-0003'"   
			+"                           ) A"   
			+"                      INNER JOIN"   
			+"                      ("   
			+"                        SELECT ROWNUM"   
			+"                              ,A.GIFT_NO"   
			+"                              ,E.EXTEND_NO CARD_NO"   
			+"                              ,'E1010' STORE_CD"   
			+"                              ,TO_CHAR(A.APLDATE, 'YYYYMMDDHH24MISS') DEAL_DT"   
			+"                              ,DECODE(A.APLSTATUS, 'O1', '1', 'D1', '2', '0') DEAL_DIVIDER"   
			+"                              ,A.RC_AMT USE_POINT"   
			+"                              ,TO_CHAR(A.APLDATE, 'YYYYMMDD') APPROVAL_DT"   
			+"                              ,NVL(A.C_APLNO, ' ') APPROVAL_NO"   
			+"                              ,A.APLORDERNO DEAL_NO"   
			+"                              ,A.APLONLINEID MERCHANTID"   
			+"                          FROM RC_APPROVAL A"   
			+"                             , GIFTEXTEND E"   
			+"                         WHERE A.GIFT_NO = E.GIFT_NO"   
			+"                           AND A.APLONLINEID = 'gsrpoppoint'"   
			+"                           AND A.SALESDATE   = TO_CHAR(TO_DATE(#{workDt}) -1,'YYYYMMDD')"   
			+"                           AND A.PAY_METHDO IN ('2', 'A2')"   
			+"                           AND 'GSPOINT'     = DECODE(#{jobDivider},NULL,'GSPOINT',#{jobDivider})"   
			+"                        ) B"   
			+"                     ON A.APPROVAL_NO = B.APPROVAL_NO"   
			+"                    AND A.DEAL_DIVIDER = B.DEAL_DIVIDER"
			+"                 ) X";	
	
	public static final String GS_SM_INCONSISTENCY_SELECT_SQL ="<script>"
			+"with DATE_TMP AS ("
			+"		   SELECT TO_CHAR(TO_DATE(#{startDate} , 'YYYYMMDD') + LEVEL -1 , 'YYYYMMDD') searchDate"
			+"		     FROM DUAL"
			+"		  CONNECT BY LEVEL &lt;= TO_DATE(#{endDate}, 'YYYYMMDD')+1 - TO_DATE(#{startDate} , 'YYYYMMDD')"
			+"		 )"			
			+" SELECT Z.*"
			+"  FROM ( SELECT ROWNUM AS RNUM"  
			+"      ,DECODE(X.jobDivider , 'GSPOP' , 'GS25' , X.jobDivider) jobDivider"     
			+"      ,X.saleDt"         
			+"      ,X.storeCd"        
			+"      ,(SELECT MAX(CP_NAME) FROM PG_CP WHERE CP_ID = X.storeCd) storeNm"
			+"      ,DECODE(X.dealType , 'ACT','활성화', 'CHR','재충전', 'PAY','결제', 'REF','잔액환불', 'TRN','잔액이체') dealType"
			+"      ,CASE WHEN X.jobDivider = 'GSPOINT'"
			+"            THEN DECODE(X.dealDivider , '1' , '사용' , '2' , '취소', X.dealDivider)"
			+"            ELSE DECODE(X.dealDivider , '0' , '승인' , '9' , '취소' ,X.dealDivider)"
			+"        END dealDivider"
			+"      ,X.dealNo"         
			+"      ,X.approvalNo"     
			+"      ,X.approvalDt"     
			+"      ,X.approvalTime"   
			+"      ,X.dealAmt"        
			+"      ,X.cardNo"         
			+"      ,X.statusNm"       
			+"      ,X.statusDesc"
			+ "     ,X.cancelMemo"
			+" FROM ("
			+"        SELECT B.JOB_DIVIDER                            jobDivider"
			+"              ,A.SALE_DT                                saleDt"
			+"              ,A.STORE_CD                               storeCd"
			+"              ,A.DEAL_TYPE                              dealType"
			+"              ,A.DEAL_DIVIDER                           dealDivider"
			+"              ,A.DEAL_NO                                dealNo"
			+"              ,A.APPROVAL_NO                            approvalNo"
			+"              ,A.APPROVAL_DT                            approvalDt"
			+"              ,A.APPROVAL_TIME                          approvalTime"
			+"              ,A.DEAL_AMT                               dealAmt"
			+"              ,A.CARD_NO                                cardNo"
			+"              ,FNC_SETTLE_STATUS_CODE_NM(B.STATUS_DESC) statusNm"
			+"              ,B.STATUS_DESC                            statusDesc"
			+ "				,' ' cancelMemo"
			+"          FROM SETTLE_GS A"   
			+"              ,SETTLE_RESULT B"   
			+"              ,DATE_TMP C"   
			+"         WHERE 1 = 1"
			+"           AND A.JOB_DIVIDER = DECODE(#{jobDivider},NULL,A.JOB_DIVIDER,#{jobDivider})"
			+"          <if test=\"dateType.equals('DATE-0001')\">"
            +"           AND A.SALE_DT    = C.searchDate" // 영업일자
            +"          </if>"
            +"          <if test=\"dateType.equals('DATE-0002')\">"
            +"           AND A.APPROVAL_DT = C.searchDate" // 승인일자
            +"          </if>"
            +"          <if test=\"dealType != null and !dealType.equals('')\">"
            +"           AND B.DEAL_TYPE    = #{dealType}"
            +"          </if>"
            +"          <if test=\"dealDivider != null and !dealDivider.equals('')\">"
            +"           AND B.DEAL_DIVIDER = #{dealDivider}"            
            +"          </if>"
            +"          <if test=\"orderNo != null and !orderNo.equals('')\">"
            +"           AND B.ORDER_NO     = #{orderNo}"            
            +"          </if>"
			+"           AND B.JOB_DIVIDER = A.JOB_DIVIDER"   
			+"           AND B.SETTLE_SEQ  = A.SEQ"   
			+"           AND B.WORK_DT     = A.WORK_DT"   
			+"           AND B.STATUS     IN ('STS-0002' , 'STS-0004')"   
			+"         UNION ALL"   
			+"        SELECT A.JOB_DIVIDER"   
			+"              ,B.SALE_DT"   
			+"              ,B.STORE_CD"   
			+"              ,B.DEAL_TYPE"   
			+"              ,B.DEAL_DIVIDER"   
			+"              ,B.DEAL_NO"   
			+"              ,B.APPROVAL_NO"   
			+"              ,B.APPROVAL_DT"   
			+"              ,B.APPROVAL_TIME"   
			+"              ,B.DEAL_AMT"   
			+"              ,B.CARD_NO"   
			+"              ,FNC_SETTLE_STATUS_CODE_NM(A.STATUS_DESC) STATUS_NM"   
			+"              ,A.STATUS_DESC"
			+"				,B.cancelMemo"   
			+"        FROM ("   
			+"              SELECT *"   
			+"                FROM SETTLE_RESULT B"   
			+"               WHERE JOB_DIVIDER = 'GSSM'"   
			+"                 AND STATUS      = 'STS-0003'"   
			+"                 AND 'GSSM'      = DECODE(#{jobDivider},NULL,'GSSM',#{jobDivider})"
            +"          <if test=\"dealType != null and !dealType.equals('')\">"
            +"                 AND DEAL_TYPE    = #{dealType}"
            +"          </if>"
            +"          <if test=\"dealDivider != null and !dealDivider.equals('')\">"
            +"                 AND DEAL_DIVIDER = #{dealDivider}"            
            +"          </if>"  			
            +"          <if test=\"orderNo != null and !orderNo.equals('')\">"
            +"                 AND ORDER_NO     = #{orderNo}"            
            +"          </if>"            
			+"            ) A"   
			+"          INNER JOIN"   
			+"           ("   
			+"           SELECT  SALESDATE SALE_DT"   
			+"                   ,BRANCHCODE STORE_CD"   
			+"                   ,ORDERNO DEAL_NO"   
			+"                   ,APLNO APPROVAL_NO"   
			+"                   ,APLDATE APPROVAL_DT"   
			+"                   ,APLTIME APPROVAL_TIME"   
			+"                   ,A.GIFT_NO"   
			+"                   ,(SELECT EXTEND_NO"   
			+"                       FROM GIFTEXTEND"   
			+"                      WHERE GIFT_NO = A.GIFT_NO) AS CARD_NO"   
			+"                   ,ORDERAMT DEAL_AMT"   
			+"                   ,TTYPE DEAL_TYPE"   
			+"                   ,ATYPE DEAL_DIVIDER"   
			+"                   ,MERCHANTID"
			+ " 				 ,cancelMemo"   
			+"             FROM   (SELECT OLP.SALESDATE,"   
			+"                            OLP.BRANCHCODE,"   
			+"                            OLP.ORDERNO,"   
			+"                            OLP.APLNO,"   
			+"                            OLP.APLDATE,"   
			+"                            OLP.APLTIME,"   
			+"                            (SELECT MAX(B.GIFT_NO)"   
			+"                             FROM   ORDERDETAIL A,"   
			+"                                    (SELECT GIFT_NO,"   
			+"                                            SEQ_NO"   
			+"                                     FROM   GIFTCREATE"   
			+"                                     UNION ALL"   
			+"                                     SELECT GIFT_NO,"   
			+"                                            SEQ_NO"   
			+"                                     FROM   GIFTDELETE) B"   
			+"                             WHERE  A.C_SERIAL = B.SEQ_NO"   
			+"                             AND    A.TRANSID = OLP.TRANSID ) GIFT_NO,"   
			+"                            (SELECT MAX(B.GIFT_CHECK)"   
			+"                             FROM   ORDERDETAIL A,"   
			+"                                    (SELECT GIFT_CHECK,"   
			+"                                            SEQ_NO"   
			+"                                     FROM   GIFTCREATE"   
			+"                                     UNION ALL"   
			+"                                     SELECT GIFT_CHECK,"   
			+"                                            SEQ_NO"   
			+"                                     FROM   GIFTDELETE) B"   
			+"                             WHERE  A.C_SERIAL = B.SEQ_NO"   
			+"                             AND    A.TRANSID = OLP.TRANSID ) GIFT_CHECK,"   
			+"                            OLP.ORDERAMT,"   
			+"                            DECODE(RESULTCODE, 'O1', 'PAY', 'R1', 'REF', 'D1', 'PAY', 'T1', 'REF') TTYPE,"   
			+"                            DECODE(RESULTCODE, 'O1', '0', 'R1', '0', 'D1', '9', 'T1', '9') ATYPE,"   
			+"                            '0' PTYPE,"   
			+"                            OLP.MERCHANTID,"
			+"							  NVL(CD.MEMO, ' ') cancelMemo"   
			+"                     FROM   ORDERLIST_POS OLP"
			+ "							 ,CANCELDETAIL CD"   
			+"                     WHERE  OLP.TRANSID=CD.TRANSID(+)"
			+ "					   		AND	OLP.MERCHANTID = 'gssmpopp'"
			+"          <if test=\"dateType.equals('DATE-0001')\">"
			+"                     AND    OLP.SALESDATE  BETWEEN TO_CHAR(TO_DATE(#{startDate}),'YYYYMMDD') AND TO_CHAR(TO_DATE(#{endDate}),'YYYYMMDD')"
			+"          </if>"
			+"          <if test=\"dateType.equals('DATE-0002')\">"
			+"                     AND    OLP.APLDATE    BETWEEN TO_CHAR(TO_DATE(#{startDate}),'YYYYMMDD') AND TO_CHAR(TO_DATE(#{endDate}),'YYYYMMDD')"  // 승인일자
			+"          </if>"
            +"          <if test=\"orderNo != null and !orderNo.equals('')\">"
            +"                     AND OLP.ORDERNO     = #{orderNo}"            
            +"          </if>"			
			+"                     AND    'GSSM'      = DECODE(#{jobDivider},NULL,'GSSM',#{jobDivider})"   
			+"                     UNION ALL"   
			+"                     SELECT SALESDATE,"   
			+"                            BRANCHCODE,"   
			+"                            APLORDERNO ORDERNO,"   
			+"                            APLNO,"   
			+"                            APLDATE,"   
			+"                            APLTIME,"   
			+"                            (SELECT MAX(TICKET_SNO)"   
			+"                             FROM   ACTIVE_APL_DETAIL"   
			+"                             WHERE  APLID = ACTIVE_APPROVAL.APLID ) GIFT_NO,"   
			+"                            (SELECT MAX(B.GIFT_CHECK)"   
			+"                             FROM   ACTIVE_APL_DETAIL A,"   
			+"                                    (SELECT GIFT_CHECK,"   
			+"                                            GIFT_NO"   
			+"                                     FROM   GIFTCREATE"   
			+"                                     UNION ALL"   
			+"                                     SELECT GIFT_CHECK,"   
			+"                                            GIFT_NO"   
			+"                                     FROM   GIFTDELETE) B"   
			+"                             WHERE  A.TICKET_SNO = B.GIFT_NO"   
			+"                             AND    A.APLID = ACTIVE_APPROVAL.APLID ) GIFT_CHECK,"   
			+"                            (SELECT CREATE_AMT"   
			+"                             FROM   (SELECT GIFT_NO,"   
			+"                                            CREATE_AMT"   
			+"                                     FROM   GIFTDELETE ) A"   
			+"                             WHERE  GIFT_NO = (SELECT MAX(TICKET_SNO)"   
			+"                                     FROM   ACTIVE_APL_DETAIL A"   
			+"                                     WHERE  APLID = ACTIVE_APPROVAL.APLID )"   
			+"                             UNION ALL"   
			+"                             SELECT CREATE_AMT"   
			+"                             FROM   (SELECT GIFT_NO,"   
			+"                                            CREATE_AMT"   
			+"                                     FROM   GIFTCREATE ) A"   
			+"                             WHERE  GIFT_NO = (SELECT MAX(TICKET_SNO)"   
			+"                                     FROM   ACTIVE_APL_DETAIL A"   
			+"                                     WHERE  APLID = ACTIVE_APPROVAL.APLID ) )ORDERAMT,"   
			+"                            'ACT' TTYPE,"   
			+"                            DECODE(APLSTATUS, '1', '0', '2', '9') ATYPE,"   
			+"                            NVL(PAY_METHDO, '0') PTYPE,"   
			+"                            APLONLINEID MERCHANTID,"
			+ "							  NVL(CANCELREASON, ' ') cancelMemo"   
			+"                     FROM   ACTIVE_APPROVAL"   
			+"                     WHERE  APLONLINEID = 'gssmpops'"   
			+"          <if test=\"dateType.equals('DATE-0001')\">"
            +"                       AND    SALESDATE  BETWEEN TO_CHAR(TO_DATE(#{startDate}),'YYYYMMDD') AND TO_CHAR(TO_DATE(#{endDate}),'YYYYMMDD')" // 영업일자
			+"          </if>"
			+"          <if test=\"dateType.equals('DATE-0002')\">"
            +"                       AND    APLDATE   BETWEEN TO_CHAR(TO_DATE(#{startDate}),'YYYYMMDD') AND TO_CHAR(TO_DATE(#{endDate}),'YYYYMMDD')"  // 승인일자	   
            +"          </if>"
            +"          <if test=\"orderNo != null and !orderNo.equals('')\">"
            +"                       AND APLORDERNO     = #{orderNo}"            
            +"          </if>"		            
			+"                       AND    'GSSM'      = DECODE(#{jobDivider},NULL,'GSSM',#{jobDivider})"   
			+"                     UNION ALL"   
			+"                     SELECT SALESDATE,"   
			+"                            BRANCHCODE,"   
			+"                            APLORDERNO ORDERNO,"   
			+"                            APLNO,"   
			+"                            TO_CHAR(APLDATE, 'YYYYMMDD') APLDATE,"   
			+"                            TO_CHAR(APLDATE, 'HH24MISS') APLTIME,"   
			+"                            GIFT_NO,"   
			+"                            (SELECT GIFT_CHECK"   
			+"                             FROM   (SELECT GIFT_CHECK,"   
			+"                                            GIFT_NO"   
			+"                                     FROM   GIFTCREATE"   
			+"                                     UNION ALL"   
			+"                                     SELECT GIFT_CHECK,"   
			+"                                            GIFT_NO"   
			+"                                     FROM   GIFTDELETE)"   
			+"                             WHERE  GIFT_NO = RC_APPROVAL.GIFT_NO ) GIFT_CHECK,"   
			+"                            RC_AMT ORDERAMT,"   
			+"                            DECODE(APLSTATUS, 'O1', 'CHR', 'D1', 'CHR', 'TS1', 'TRN') TTYPE,"   
			+"                            DECODE(APLSTATUS, 'O1', '0', 'D1', '9', 'TS1', '0') ATYPE,"   
			+"                            NVL(PAY_METHDO, '0') PTYPE,"   
			+"                                APLONLINEID MERCHANTID,"
			+ "							  NVL(CANCEL_MEMO, ' ') cancelMemo"   
			+"                     FROM   RC_APPROVAL"   
			+"                     WHERE  APLONLINEID = 'gssmpops'"   
			+"          <if test=\"dateType.equals('DATE-0001')\">"
            +"                     AND    SALESDATE BETWEEN TO_CHAR(TO_DATE(#{startDate}),'YYYYMMDD') AND TO_CHAR(TO_DATE(#{endDate}),'YYYYMMDD')" // 영업일자
			+"          </if>"
			+"          <if test=\"dateType.equals('DATE-0002')\">"
            +"                     AND    APLDATE  BETWEEN TO_CHAR(TO_DATE(#{startDate}),'YYYYMMDD') AND TO_CHAR(TO_DATE(#{endDate}),'YYYYMMDD')"  // 승인일자	      
            +"          </if>"
            +"          <if test=\"orderNo != null and !orderNo.equals('')\">"
            +"                     AND APLORDERNO     = #{orderNo}"            
            +"          </if>"		            
			+"                     AND    APLSTATUS IN ('O1','D1','TS1')"   
			+"                     AND    'GSSM'     = DECODE(#{jobDivider},NULL,'GSSM',#{jobDivider})"   
			+"                     ) A"   
			+"             ) B"   
			+"          ON A.ORDER_NO = B.DEAL_NO"   
			+"         AND A.APPROVAL_NO = B.APPROVAL_NO"   
			+"         AND A.DEAL_TYPE = B.DEAL_TYPE"   
			+"         AND A.DEAL_DIVIDER = B.DEAL_DIVIDER "
			+"          <if test=\"isExcel != null and isExcel.equals('Y')\">"
			+ "		  ORDER BY SALEDT ASC"               
            +"          </if>"
            +"          <if test=\"isExcel != null and isExcel.equals('N')\">"
            + "		  ORDER BY STORECD, SALEDT, APPROVALTIME ASC"               
            +"          </if>"
			+"         ) X"
			+"  WHERE ROWNUM &lt;= #{offset} + #{limit}"
			+" ) Z"
			+" WHERE RNUM &gt; #{offset}"
			+" </script>"
			;	

	public static final String GS_POP_INCONSISTENCY_SELECT_SQL ="<script>"
			+"with DATE_TMP AS ("
			+"		   SELECT TO_CHAR(TO_DATE(#{startDate} , 'YYYYMMDD') + LEVEL -1 , 'YYYYMMDD') searchDate"
			+"		     FROM DUAL"
			+"		  CONNECT BY LEVEL &lt;= TO_DATE(#{endDate}, 'YYYYMMDD')+1 - TO_DATE(#{startDate} , 'YYYYMMDD')"
			+"		 )"			
			+" SELECT Z.*"
			+"  FROM ( SELECT ROWNUM AS RNUM"  
			+"      ,DECODE(X.jobDivider , 'GSPOP' , 'GS25' , X.jobDivider) jobDivider"     
			+"      ,X.saleDt"         
			+"      ,X.storeCd"
			+"		,PG.CP_NAME storeNm"        
			+"      ,DECODE(X.dealType , 'ACT','활성화', 'CHR','재충전', 'PAY','결제', 'REF','잔액환불', 'TRN','잔액이체') dealType"
			+"      ,CASE WHEN X.jobDivider = 'GSPOINT'"
			+"            THEN DECODE(X.dealDivider , '1' , '사용' , '2' , '취소', X.dealDivider)"
			+"            ELSE DECODE(X.dealDivider , '0' , '승인' , '9' , '취소' ,X.dealDivider)"
			+"        END dealDivider"
			+"      ,X.dealNo"         
			+"      ,X.approvalNo"     
			+"      ,X.approvalDt"     
			+"      ,X.approvalTime"   
			+"      ,X.dealAmt"        
			+"      ,X.cardNo"         
			+"      ,X.statusNm"       
			+"      ,X.statusDesc"
			+ "		,X.cancelMemo"
			+" FROM ("
			+"        SELECT B.JOB_DIVIDER                            jobDivider"
			+"              ,A.SALE_DT                                saleDt"
			+"              ,A.STORE_CD                               storeCd"
			+"              ,A.DEAL_TYPE                              dealType"
			+"              ,A.DEAL_DIVIDER                           dealDivider"
			+"              ,A.DEAL_NO                                dealNo"
			+"              ,A.APPROVAL_NO                            approvalNo"
			+"              ,A.APPROVAL_DT                            approvalDt"
			+"              ,A.APPROVAL_TIME                          approvalTime"
			+"              ,A.DEAL_AMT                               dealAmt"
			+"              ,A.CARD_NO                                cardNo"
			+"              ,FNC_SETTLE_STATUS_CODE_NM(B.STATUS_DESC) statusNm"
			+"              ,B.STATUS_DESC                            statusDesc"
			+"				,' ' cancelMemo"
			+"          FROM SETTLE_GS A"   
			+"              ,SETTLE_RESULT B"   
			+"              ,DATE_TMP C"   
			+"         WHERE 1 = 1"
			+"           AND A.JOB_DIVIDER = DECODE(#{jobDivider},NULL,A.JOB_DIVIDER,#{jobDivider})"
			+"          <if test=\"dateType.equals('DATE-0001')\">"
            +"           AND A.SALE_DT    = C.searchDate" // 영업일자
            +"          </if>"
            +"          <if test=\"dateType.equals('DATE-0002')\">"
            +"           AND A.APPROVAL_DT = C.searchDate" // 승인일자
            +"          </if>"
            +"          <if test=\"dealType != null and !dealType.equals('')\">"
            +"           AND B.DEAL_TYPE    = #{dealType}"
            +"          </if>"
            +"          <if test=\"dealDivider != null and !dealDivider.equals('')\">"
            +"           AND B.DEAL_DIVIDER = #{dealDivider}"            
            +"          </if>"
            +"          <if test=\"orderNo != null and !orderNo.equals('')\">"
            +"           AND B.ORDER_NO     = #{orderNo}"            
            +"          </if>"
			+"           AND B.JOB_DIVIDER = A.JOB_DIVIDER"   
			+"           AND B.SETTLE_SEQ  = A.SEQ"   
			+"           AND B.WORK_DT     = A.WORK_DT"   
			+"           AND B.STATUS     IN ('STS-0002' , 'STS-0004')"   
			+"        UNION ALL"   
			+"        SELECT A.JOB_DIVIDER"   
			+"              ,B.SALE_DT"   
			+"              ,B.STORE_CD"   
			+"              ,B.DEAL_TYPE"   
			+"              ,B.DEAL_DIVIDER"   
			+"              ,B.DEAL_NO"   
			+"              ,B.APPROVAL_NO"   
			+"              ,B.APPROVAL_DT"   
			+"              ,B.APPROVAL_TIME"   
			+"              ,B.DEAL_AMT"   
			+"              ,B.CARD_NO"   
			+"              ,FNC_SETTLE_STATUS_CODE_NM(A.STATUS_DESC) STATUS_NM"   
			+"              ,A.STATUS_DESC"
			+ "				,B.cancelMemo"   
			+"         FROM ("   
			+"              SELECT *"   
			+"                FROM SETTLE_RESULT B"   
			+"               WHERE JOB_DIVIDER = 'GSPOP'"   
			+"                 AND 'GSPOP'     = DECODE(#{jobDivider},NULL,'GSPOP',#{jobDivider})"
            +"          <if test=\"dealType != null and !dealType.equals('')\">"
            +"                 AND DEAL_TYPE    = #{dealType}"
            +"          </if>"
            +"          <if test=\"dealDivider != null and !dealDivider.equals('')\">"
            +"                 AND DEAL_DIVIDER = #{dealDivider}"            
            +"          </if>"  			
            +"          <if test=\"orderNo != null and !orderNo.equals('')\">"
            +"                 AND ORDER_NO     = #{orderNo}"            
            +"          </if>"		            
			+"                 AND STATUS      = 'STS-0003'"   
			+"            ) A"   
			+"          INNER JOIN"   
			+"           ("   
			+"              SELECT  SALESDATE SALE_DT"   
			+"                      ,BRANCHCODE STORE_CD"   
			+"                      ,ORDERNO DEAL_NO"   
			+"                      ,APLNO APPROVAL_NO"   
			+"                      ,APLDATE APPROVAL_DT"   
			+"                      ,APLTIME APPROVAL_TIME"   
			+"                      ,A.GIFT_NO"   
			+"                      ,(SELECT EXTEND_NO"   
			+"                          FROM GIFTEXTEND"   
			+"                         WHERE GIFT_NO = A.GIFT_NO) AS CARD_NO"   
			+"                      ,ORDERAMT DEAL_AMT"   
			+"                      ,TTYPE DEAL_TYPE"   
			+"                      ,ATYPE DEAL_DIVIDER"   
			+"                      ,MERCHANTID"
			+ "						,cancelMemo"   
			+"                FROM   (SELECT OLP.SALESDATE,"   
			+"                               OLP.BRANCHCODE,"   
			+"                               OLP.ORDERNO,"   
			+"                               OLP.APLNO,"   
			+"                               OLP.APLDATE,"   
			+"                               OLP.APLTIME,"   
			+"                               (SELECT MAX(B.GIFT_NO)"   
			+"                                FROM   ORDERDETAIL A,"   
			+"                                       (SELECT GIFT_NO,"   
			+"                                               SEQ_NO"   
			+"                                        FROM   GIFTCREATE"   
			+"                                        UNION ALL"   
			+"                                        SELECT GIFT_NO,"   
			+"                                               SEQ_NO"   
			+"                                        FROM   GIFTDELETE) B"   
			+"                                WHERE  A.C_SERIAL = B.SEQ_NO"   
			+"                                AND    A.TRANSID = OLP.TRANSID ) GIFT_NO,"   
			+"                               (SELECT MAX(B.GIFT_CHECK)"   
			+"                                FROM   ORDERDETAIL A,"   
			+"                                       (SELECT GIFT_CHECK,"   
			+"                                               SEQ_NO"   
			+"                                        FROM   GIFTCREATE"   
			+"                                        UNION ALL"   
			+"                                        SELECT GIFT_CHECK,"   
			+"                                               SEQ_NO"   
			+"                                        FROM   GIFTDELETE) B"   
			+"                                WHERE  A.C_SERIAL = B.SEQ_NO"   
			+"                                AND    A.TRANSID = OLP.TRANSID ) GIFT_CHECK,"   
			+"                               ORDERAMT,"   
			+"                               DECODE(OLP.RESULTCODE, 'O1', 'PAY', 'R1', 'REF', 'D1', 'PAY', 'T1', 'REF') TTYPE,"   
			+"                               DECODE(OLP.RESULTCODE, 'O1', '0', 'R1', '0', 'D1', '9', 'T1', '9') ATYPE,"   
			+"                               '0' PTYPE,"   
			+"                               OLP.MERCHANTID,"
			+ "								 NVL(CD.MEMO, ' ') cancelMemo"   
			+"                        FROM   ORDERLIST_POS OLP"
			+ "								,CANCELDETAIL CD"   
			+"                        WHERE  OLP.MERCHANTID = 'gspopcardp'"
			+ "						  AND OLP.TRANSID=CD.TRANSID(+)"   
			+"                        AND    'GSPOP'    = DECODE(#{jobDivider},NULL,'GSPOP',#{jobDivider})"
			+"          <if test=\"dateType.equals('DATE-0001')\">"			
            +"                        AND    OLP.SALESDATE BETWEEN TO_CHAR(TO_DATE(#{startDate}),'YYYYMMDD') AND TO_CHAR(TO_DATE(#{endDate}),'YYYYMMDD')" // 영업일자
			+"          </if>"
			+"          <if test=\"dateType.equals('DATE-0002')\">"			
            +"                        AND    OLP.APLDATE BETWEEN TO_CHAR(TO_DATE(#{startDate}),'YYYYMMDD') AND TO_CHAR(TO_DATE(#{endDate}),'YYYYMMDD')"  // 승인일자	        
            +"          </if>"
            +"          <if test=\"orderNo != null and !orderNo.equals('')\">"
            +"                        AND OLP.ORDERNO     = #{orderNo}"            
            +"          </if>"		                   
			+"                        UNION ALL"   
			+"                        SELECT SALESDATE,"   
			+"                               BRANCHCODE,"   
			+"                               APLORDERNO ORDERNO,"   
			+"                               APLNO,"   
			+"                               APLDATE,"   
			+"                               APLTIME,"   
			+"                               (SELECT MAX(TICKET_SNO)"   
			+"                                FROM   ACTIVE_APL_DETAIL"   
			+"                                WHERE  APLID = ACTIVE_APPROVAL.APLID ) GIFT_NO,"   
			+"                               (SELECT MAX(B.GIFT_CHECK)"   
			+"                                FROM   ACTIVE_APL_DETAIL A,"   
			+"                                       (SELECT GIFT_CHECK,"   
			+"                                               GIFT_NO"   
			+"                                        FROM   GIFTCREATE"   
			+"                                        UNION ALL"   
			+"                                        SELECT GIFT_CHECK,"   
			+"                                               GIFT_NO"   
			+"                                        FROM   GIFTDELETE) B"   
			+"                                WHERE  A.TICKET_SNO = B.GIFT_NO"   
			+"                                AND    A.APLID = ACTIVE_APPROVAL.APLID ) GIFT_CHECK,"   
			+"                               (SELECT CREATE_AMT"   
			+"                                FROM   (SELECT GIFT_NO,"   
			+"                                               CREATE_AMT"   
			+"                                        FROM   GIFTDELETE ) A"   
			+"                                WHERE  GIFT_NO = (SELECT MAX(TICKET_SNO)"   
			+"                                        FROM   ACTIVE_APL_DETAIL A"   
			+"                                        WHERE  APLID = ACTIVE_APPROVAL.APLID )"   
			+"                                UNION ALL"   
			+"                                SELECT CREATE_AMT"   
			+"                                FROM   (SELECT GIFT_NO,"   
			+"                                               CREATE_AMT"   
			+"                                        FROM   GIFTCREATE ) A"   
			+"                                WHERE  GIFT_NO = (SELECT MAX(TICKET_SNO)"   
			+"                                        FROM   ACTIVE_APL_DETAIL A"   
			+"                                        WHERE  APLID = ACTIVE_APPROVAL.APLID ) )ORDERAMT,"   
			+"                               'ACT' TTYPE,"   
			+"                               DECODE(APLSTATUS, '1', '0', '2', '9') ATYPE,"   
			+"                               NVL(PAY_METHDO, '0') PTYPE,"   
			+"                               APLONLINEID MERCHANTID,"
			+ "								 NVL(CANCELREASON, ' ') cancelMemo"   
			+"                        FROM   ACTIVE_APPROVAL"   
			+"                        WHERE  APLONLINEID = 'gspopcards'"   
			+"          <if test=\"dateType.equals('DATE-0001')\">"
            +"                        AND    SALESDATE BETWEEN TO_CHAR(TO_DATE(#{startDate}),'YYYYMMDD') AND TO_CHAR(TO_DATE(#{endDate}),'YYYYMMDD')" // 영업일자
			+"          </if>"
			+"          <if test=\"dateType.equals('DATE-0002')\">"
            +"                        AND    APLDATE BETWEEN TO_CHAR(TO_DATE(#{startDate}),'YYYYMMDD') AND TO_CHAR(TO_DATE(#{endDate}),'YYYYMMDD')"  // 승인일자	        
            +"          </if>"
            +"          <if test=\"orderNo != null and !orderNo.equals('')\">"
            +"                        AND APLORDERNO     = #{orderNo}"            
            +"          </if>"		              
			+"                        AND    'GSPOP'     = DECODE(#{jobDivider},NULL,'GSPOP',#{jobDivider})"   
			+"                        UNION ALL"   
			+"                        SELECT SALESDATE,"   
			+"                               BRANCHCODE,"   
			+"                               APLORDERNO ORDERNO,"   
			+"                               APLNO,"   
			+"                               TO_CHAR(APLDATE, 'YYYYMMDD') APLDATE,"   
			+"                               TO_CHAR(APLDATE, 'HH24MISS') APLTIME,"   
			+"                               GIFT_NO,"   
			+"                               (SELECT GIFT_CHECK"   
			+"                                FROM   (SELECT GIFT_CHECK,"   
			+"                                               GIFT_NO"   
			+"                                        FROM   GIFTCREATE"   
			+"                                        UNION ALL"   
			+"                                        SELECT GIFT_CHECK,"   
			+"                                               GIFT_NO"   
			+"                                        FROM   GIFTDELETE)"   
			+"                                WHERE  GIFT_NO = RC_APPROVAL.GIFT_NO ) GIFT_CHECK,"   
			+"                               RC_AMT ORDERAMT,"   
			+"                               DECODE(APLSTATUS, 'O1', 'CHR', 'D1', 'CHR', 'TT1', 'TRN') TTYPE,"   
			+"                               DECODE(APLSTATUS, 'O1', '0', 'D1', '9', 'TT1', '0') ATYPE,"   
			+"                               NVL(PAY_METHDO, '0') PTYPE,"   
			+"                                   APLONLINEID MERCHANTID,"
			+ "								 NVL(CANCEL_MEMO, ' ') cancelMemo"   
			+"                        FROM   RC_APPROVAL"   
			+"                        WHERE  APLONLINEID = 'gspopcards'"   
			+"          <if test=\"dateType.equals('DATE-0001')\">"
            +"                        AND    SALESDATE  BETWEEN TO_CHAR(TO_DATE(#{startDate}),'YYYYMMDD') AND TO_CHAR(TO_DATE(#{endDate}) ,'YYYYMMDD')" // 영업일자
			+"          </if>"
			+"          <if test=\"dateType.equals('DATE-0002')\">"
            +"                        AND    APLDATE    BETWEEN TO_CHAR(TO_DATE(#{startDate}),'YYYYMMDD') AND TO_CHAR(TO_DATE(#{endDate}) ,'YYYYMMDD')"  // 승인일자	        
            +"          </if>"   
            +"          <if test=\"orderNo != null and !orderNo.equals('')\">"
            +"                        AND APLORDERNO     = #{orderNo}"            
            +"          </if>"		                  
			+"                        AND    APLSTATUS IN ('O1','D1','TT1')"   
			+"                        AND    'GSPOP'     = DECODE(#{jobDivider},NULL,'GSPOP',#{jobDivider})"   
			+"                        ) A"   
			+"             ) B"   
			+"          ON A.ORDER_NO = B.DEAL_NO"   
			+"         AND A.APPROVAL_NO = B.APPROVAL_NO"   
			+"         AND A.DEAL_TYPE = B.DEAL_TYPE"   
			+"         AND A.DEAL_DIVIDER = B.DEAL_DIVIDER"
			+"          <if test=\"isExcel != null and isExcel.equals('Y')\">"
			+ "		  ORDER BY SALEDT ASC"               
            +"          </if>"
            +"          <if test=\"isExcel != null and isExcel.equals('N')\">"
            + "		  ORDER BY STORECD, SALEDT, APPROVALTIME ASC"               
            +"          </if>"
			+"         ) X"
			+ "		,PG_CP PG"
			+"  WHERE "
			+" 		X.storeCd=PG.CP_ID"	
			+" 		AND ROWNUM &lt;= #{offset} + #{limit}"
			+" ) Z"
			+" WHERE RNUM &gt; #{offset}"
			+" </script>"
			;	
	
	public static final String GSHB_INCONSISTENCY_SELECT_SQL ="<script>"
			+"with DATE_TMP AS ("
			+"		   SELECT TO_CHAR(TO_DATE(#{startDate} , 'YYYYMMDD') + LEVEL -1 , 'YYYYMMDD') searchDate"
			+"		     FROM DUAL"
			+"		  CONNECT BY LEVEL &lt;= TO_DATE(#{endDate}, 'YYYYMMDD')+1 - TO_DATE(#{startDate} , 'YYYYMMDD')"
			+"		 )"			
			+" SELECT Z.*"
			+"  FROM ( SELECT ROWNUM AS RNUM"  
			+"      ,DECODE(X.jobDivider , 'GSPOP' , 'GS25' , X.jobDivider) jobDivider"     
			+"      ,X.saleDt"         
			+"      ,X.storeCd"        
			+"      ,(SELECT MAX(CP_NAME) FROM PG_CP WHERE CP_ID = X.storeCd) storeNm"
			+"      ,DECODE(X.dealType , 'ACT','활성화', 'CHR','재충전', 'PAY','결제', 'REF','잔액환불', 'TRN','잔액이체') dealType"
			+"      ,CASE WHEN X.jobDivider = 'GSPOINT'"
			+"            THEN DECODE(X.dealDivider , '1' , '사용' , '2' , '취소', X.dealDivider)"
			+"            ELSE DECODE(X.dealDivider , '0' , '승인' , '9' , '취소' ,X.dealDivider)"
			+"        END dealDivider"
			+"      ,X.dealNo"         
			+"      ,X.approvalNo"     
			+"      ,X.approvalDt"     
			+"      ,X.approvalTime"   
			+"      ,X.dealAmt"        
			+"      ,X.cardNo"         
			+"      ,X.statusNm"       
			+"      ,X.statusDesc"
			+ "		,X.cancelMemo"
			+" FROM ("
			+"        SELECT B.JOB_DIVIDER                            jobDivider"
			+"              ,A.SALE_DT                                saleDt"
			+"              ,A.STORE_CD                               storeCd"
			+"              ,A.DEAL_TYPE                              dealType"
			+"              ,A.DEAL_DIVIDER                           dealDivider"
			+"              ,A.DEAL_NO                                dealNo"
			+"              ,A.APPROVAL_NO                            approvalNo"
			+"              ,A.APPROVAL_DT                            approvalDt"
			+"              ,A.APPROVAL_TIME                          approvalTime"
			+"              ,A.DEAL_AMT                               dealAmt"
			+"              ,A.CARD_NO                                cardNo"
			+"              ,FNC_SETTLE_STATUS_CODE_NM(B.STATUS_DESC) statusNm"
			+"              ,B.STATUS_DESC                            statusDesc"
			+ "				,' ' cancelMemo"
			+"          FROM SETTLE_GS A"   
			+"              ,SETTLE_RESULT B"   
			+"              ,DATE_TMP C"   
			+"         WHERE 1 = 1"
			+"           AND A.JOB_DIVIDER = DECODE(#{jobDivider},NULL,A.JOB_DIVIDER,#{jobDivider})"
			+"          <if test=\"dateType.equals('DATE-0001')\">"
            +"           AND A.SALE_DT    = C.searchDate" // 영업일자
            +"          </if>"
            +"          <if test=\"dateType.equals('DATE-0002')\">"
            +"           AND A.APPROVAL_DT = C.searchDate" // 승인일자
            +"          </if>"
            +"          <if test=\"dealType != null and !dealType.equals('')\">"
            +"           AND B.DEAL_TYPE    = #{dealType}"
            +"          </if>"
            +"          <if test=\"dealDivider != null and !dealDivider.equals('')\">"
            +"           AND B.DEAL_DIVIDER = #{dealDivider}"            
            +"          </if>"
            +"          <if test=\"orderNo != null and !orderNo.equals('')\">"
            +"           AND B.ORDER_NO     = #{orderNo}"            
            +"          </if>"
			+"           AND B.JOB_DIVIDER = A.JOB_DIVIDER"   
			+"           AND B.SETTLE_SEQ  = A.SEQ"   
			+"           AND B.WORK_DT     = A.WORK_DT"   
			+"           AND B.STATUS     IN ('STS-0002' , 'STS-0004')"   
			+"        UNION ALL"   
			+"        SELECT A.JOB_DIVIDER"   
			+"              ,B.SALE_DT"   
			+"              ,B.STORE_CD"   
			+"              ,B.DEAL_TYPE"   
			+"              ,B.DEAL_DIVIDER"   
			+"              ,B.DEAL_NO"   
			+"              ,B.APPROVAL_NO"   
			+"              ,B.APPROVAL_DT"   
			+"              ,B.APPROVAL_TIME"   
			+"              ,B.DEAL_AMT"   
			+"              ,B.CARD_NO"   
			+"              ,FNC_SETTLE_STATUS_CODE_NM(A.STATUS_DESC) STATUS_NM"   
			+"              ,A.STATUS_DESC"
			+ "				,B.cancelMemo"   
			+"         FROM ("   
			+"              SELECT *"   
			+"                FROM SETTLE_RESULT B"   
			+"               WHERE JOB_DIVIDER = 'GSHB'"   
			+"                 AND 'GSHB'     = DECODE(#{jobDivider},NULL,'GSHB',#{jobDivider})"
            +"          <if test=\"dealType != null and !dealType.equals('')\">"
            +"                 AND DEAL_TYPE    = #{dealType}"
            +"          </if>"
            +"          <if test=\"dealDivider != null and !dealDivider.equals('')\">"
            +"                 AND DEAL_DIVIDER = #{dealDivider}"            
            +"          </if>"  			
            +"          <if test=\"orderNo != null and !orderNo.equals('')\">"
            +"                 AND ORDER_NO     = #{orderNo}"            
            +"          </if>"		            
			+"                 AND STATUS      = 'STS-0003'"   
			+"            ) A"   
			+"          INNER JOIN"   
			+"           ("   
			+"              SELECT  SALESDATE SALE_DT"   
			+"                      ,BRANCHCODE STORE_CD"   
			+"                      ,ORDERNO DEAL_NO"   
			+"                      ,APLNO APPROVAL_NO"   
			+"                      ,APLDATE APPROVAL_DT"   
			+"                      ,APLTIME APPROVAL_TIME"   
			+"                      ,A.GIFT_NO"   
			+"                      ,(SELECT EXTEND_NO"   
			+"                          FROM GIFTEXTEND"   
			+"                         WHERE GIFT_NO = A.GIFT_NO) AS CARD_NO"   
			+"                      ,ORDERAMT DEAL_AMT"   
			+"                      ,TTYPE DEAL_TYPE"   
			+"                      ,ATYPE DEAL_DIVIDER"   
			+"                      ,MERCHANTID"
			+ "					    ,cancelMemo"   
			+"                FROM   (SELECT OLP.SALESDATE,"   
			+"                               OLP.BRANCHCODE,"   
			+"                               OLP.ORDERNO,"   
			+"                               OLP.APLNO,"   
			+"                               OLP.APLDATE,"   
			+"                               OLP.APLTIME,"   
			+"                               (SELECT MAX(B.GIFT_NO)"   
			+"                                FROM   ORDERDETAIL A,"   
			+"                                       (SELECT GIFT_NO,"   
			+"                                               SEQ_NO"   
			+"                                        FROM   GIFTCREATE"   
			+"                                        UNION ALL"   
			+"                                        SELECT GIFT_NO,"   
			+"                                               SEQ_NO"   
			+"                                        FROM   GIFTDELETE) B"   
			+"                                WHERE  A.C_SERIAL = B.SEQ_NO"   
			+"                                AND    A.TRANSID = OLP.TRANSID ) GIFT_NO,"   
			+"                               (SELECT MAX(B.GIFT_CHECK)"   
			+"                                FROM   ORDERDETAIL A,"   
			+"                                       (SELECT GIFT_CHECK,"   
			+"                                               SEQ_NO"   
			+"                                        FROM   GIFTCREATE"   
			+"                                        UNION ALL"   
			+"                                        SELECT GIFT_CHECK,"   
			+"                                               SEQ_NO"   
			+"                                        FROM   GIFTDELETE) B"   
			+"                                WHERE  A.C_SERIAL = B.SEQ_NO"   
			+"                                AND    A.TRANSID = OLP.TRANSID ) GIFT_CHECK,"   
			+"                               OLP.ORDERAMT,"   
			+"                               DECODE(OLP.RESULTCODE, 'O1', 'PAY', 'R1', 'REF', 'D1', 'PAY', 'T1', 'REF') TTYPE,"   
			+"                               DECODE(OLP.RESULTCODE, 'O1', '0', 'R1', '0', 'D1', '9', 'T1', '9') ATYPE,"   
			+"                               '0' PTYPE,"   
			+"                               OLP.MERCHANTID,"
			+ "								 NVL(CD.MEMO, ' ') cancelMemo"   
			+"                        FROM   ORDERLIST_POS OLP"
			+ "								,CANCELDETAIL CD"   
			+"                        WHERE  OLP.MERCHANTID = 'gswatsonspop'"
			+ "						  AND OLP.TRANSID=CD.TRANSID(+)"   
			+"                        AND    'GSHB'    = DECODE(#{jobDivider},NULL,'GSHB',#{jobDivider})"
			+"          <if test=\"dateType.equals('DATE-0001')\">"
            +"                        AND    SALESDATE  BETWEEN TO_CHAR(TO_DATE(#{startDate}),'YYYYMMDD') AND TO_CHAR(TO_DATE(#{endDate}) ,'YYYYMMDD')" // 영업일자
			+"          </if>"
			+"          <if test=\"dateType.equals('DATE-0002')\">"
            +"                        AND    APLDATE    BETWEEN TO_CHAR(TO_DATE(#{startDate}),'YYYYMMDD') AND TO_CHAR(TO_DATE(#{endDate}) ,'YYYYMMDD')"  // 승인일자	        
            +"          </if>"   
            +"          <if test=\"orderNo != null and !orderNo.equals('')\">"
            +"                        AND OLP.ORDERNO     = #{orderNo}"            
            +"          </if>"		                   
			+"                        UNION ALL"   
			+"                        SELECT SALESDATE,"   
			+"                               BRANCHCODE,"   
			+"                               APLORDERNO ORDERNO,"   
			+"                               APLNO,"   
			+"                               APLDATE,"   
			+"                               APLTIME,"   
			+"                               (SELECT MAX(TICKET_SNO)"   
			+"                                FROM   ACTIVE_APL_DETAIL"   
			+"                                WHERE  APLID = ACTIVE_APPROVAL.APLID ) GIFT_NO,"   
			+"                               (SELECT MAX(B.GIFT_CHECK)"   
			+"                                FROM   ACTIVE_APL_DETAIL A,"   
			+"                                       (SELECT GIFT_CHECK,"   
			+"                                               GIFT_NO"   
			+"                                        FROM   GIFTCREATE"   
			+"                                        UNION ALL"   
			+"                                        SELECT GIFT_CHECK,"   
			+"                                               GIFT_NO"   
			+"                                        FROM   GIFTDELETE) B"   
			+"                                WHERE  A.TICKET_SNO = B.GIFT_NO"   
			+"                                AND    A.APLID = ACTIVE_APPROVAL.APLID ) GIFT_CHECK,"   
			+"                               (SELECT CREATE_AMT"   
			+"                                FROM   (SELECT GIFT_NO,"   
			+"                                               CREATE_AMT"   
			+"                                        FROM   GIFTDELETE ) A"   
			+"                                WHERE  GIFT_NO = (SELECT MAX(TICKET_SNO)"   
			+"                                        FROM   ACTIVE_APL_DETAIL A"   
			+"                                        WHERE  APLID = ACTIVE_APPROVAL.APLID )"   
			+"                                UNION ALL"   
			+"                                SELECT CREATE_AMT"   
			+"                                FROM   (SELECT GIFT_NO,"   
			+"                                               CREATE_AMT"   
			+"                                        FROM   GIFTCREATE ) A"   
			+"                                WHERE  GIFT_NO = (SELECT MAX(TICKET_SNO)"   
			+"                                        FROM   ACTIVE_APL_DETAIL A"   
			+"                                        WHERE  APLID = ACTIVE_APPROVAL.APLID ) )ORDERAMT,"   
			+"                               'ACT' TTYPE,"   
			+"                               DECODE(APLSTATUS, '1', '0', '2', '9') ATYPE,"   
			+"                               NVL(PAY_METHDO, '0') PTYPE,"   
			+"                               APLONLINEID MERCHANTID,"
			+ "								 NVL(CANCELREASON, ' ') cancelMemo"   
			+"                        FROM   ACTIVE_APPROVAL"   
			+"                        WHERE  APLONLINEID = 'gswatsonspops'"   
			+"          <if test=\"dateType.equals('DATE-0001')\">"
            +"                        AND    SALESDATE  BETWEEN TO_CHAR(TO_DATE(#{startDate}),'YYYYMMDD') AND TO_CHAR(TO_DATE(#{endDate}),'YYYYMMDD')" // 영업일자
			+"          </if>"
			+"          <if test=\"dateType.equals('DATE-0002')\">"
            +"                        AND    APLDATE    BETWEEN TO_CHAR(TO_DATE(#{startDate}),'YYYYMMDD') AND TO_CHAR(TO_DATE(#{endDate}),'YYYYMMDD')"  // 승인일자	        
            +"          </if>"   
            +"          <if test=\"orderNo != null and !orderNo.equals('')\">"
            +"                        AND APLORDERNO     = #{orderNo}"            
            +"          </if>"		              
			+"                        AND    'GSHB'     = DECODE(#{jobDivider},NULL,'GSHB',#{jobDivider})"   
			+"                        UNION ALL"   
			+"                        SELECT SALESDATE,"   
			+"                               BRANCHCODE,"   
			+"                               APLORDERNO ORDERNO,"   
			+"                               APLNO,"   
			+"                               TO_CHAR(APLDATE, 'YYYYMMDD') APLDATE,"   
			+"                               TO_CHAR(APLDATE, 'HH24MISS') APLTIME,"   
			+"                               GIFT_NO,"   
			+"                               (SELECT GIFT_CHECK"   
			+"                                FROM   (SELECT GIFT_CHECK,"   
			+"                                               GIFT_NO"   
			+"                                        FROM   GIFTCREATE"   
			+"                                        UNION ALL"   
			+"                                        SELECT GIFT_CHECK,"   
			+"                                               GIFT_NO"   
			+"                                        FROM   GIFTDELETE)"   
			+"                                WHERE  GIFT_NO = RC_APPROVAL.GIFT_NO ) GIFT_CHECK,"   
			+"                               RC_AMT ORDERAMT,"   
			+"                               DECODE(APLSTATUS, 'O1', 'CHR', 'D1', 'CHR', 'TT1', 'TRN') TTYPE,"   
			+"                               DECODE(APLSTATUS, 'O1', '0', 'D1', '9', 'TT1', '0') ATYPE,"   
			+"                               NVL(PAY_METHDO, '0') PTYPE,"   
			+"                                   APLONLINEID MERCHANTID,"
			+ "								 NVL(CANCEL_MEMO, ' ') cancelMemo"   
			+"                        FROM   RC_APPROVAL"   
			+"                        WHERE  APLONLINEID = 'gswatsonspops'"   
			+"          <if test=\"dateType.equals('DATE-0001')\">"
            +"                        AND    SALESDATE  BETWEEN TO_CHAR(TO_DATE(#{startDate}),'YYYYMMDD') AND TO_CHAR(TO_DATE(#{endDate}) ,'YYYYMMDD')" // 영업일자
			+"          </if>"
			+"          <if test=\"dateType.equals('DATE-0002')\">"
            +"                        AND    APLDATE    BETWEEN TO_CHAR(TO_DATE(#{startDate}),'YYYYMMDD') AND TO_CHAR(TO_DATE(#{endDate}) ,'YYYYMMDD')"  // 승인일자	        
            +"          </if>"   
            +"          <if test=\"orderNo != null and !orderNo.equals('')\">"
            +"                        AND APLORDERNO     = #{orderNo}"            
            +"          </if>"		                  
			+"                        AND    APLSTATUS IN ('O1','D1','TT1')"   
			+"                        AND    'GSHB'     = DECODE(#{jobDivider},NULL,'GSHB',#{jobDivider})"   
			+"                        ) A"   
			+"             ) B"   
			+"          ON A.ORDER_NO = B.DEAL_NO"   
			+"         AND A.APPROVAL_NO = B.APPROVAL_NO"   
			+"         AND A.DEAL_TYPE = B.DEAL_TYPE"   
			+"         AND A.DEAL_DIVIDER = B.DEAL_DIVIDER"
			+"          <if test=\"isExcel != null and isExcel.equals('Y')\">"
			+ "		  ORDER BY SALEDT ASC"               
            +"          </if>"
            +"          <if test=\"isExcel != null and isExcel.equals('N')\">"
            + "		  ORDER BY STORECD, SALEDT, APPROVALTIME ASC"               
            +"          </if>"
			+"         ) X"
			+"  WHERE ROWNUM &lt;= #{offset} + #{limit}"
			+" ) Z"
			+" WHERE RNUM &gt; #{offset}"
			+" </script>"
			;	
		
	public static final String GS_POINT_INCONSISTENCY_SELECT_SQL ="<script>"
			+" SELECT Z.*"
			+"  FROM ( SELECT ROWNUM AS RNUM"  
			+"      ,DECODE(X.jobDivider , 'GSPOP' , 'GS25' , X.jobDivider) jobDivider"     
			+"      ,X.saleDt"         
			+"      ,X.storeCd"        
			+"      ,(SELECT MAX(CP_NAME) FROM PG_CP WHERE CP_ID = X.storeCd) storeNm"
			+"      ,DECODE(X.dealType , 'ACT','활성화', 'CHR','재충전', 'PAY','결제', 'REF','잔액환불', 'TRN','잔액이체') dealType"
			+"      ,CASE WHEN X.jobDivider = 'GSPOINT'"
			+"            THEN DECODE(X.dealDivider , '1' , '사용' , '2' , '취소', X.dealDivider)"
			+"            ELSE DECODE(X.dealDivider , '0' , '승인' , '9' , '취소' ,X.dealDivider)"
			+"        END dealDivider"
			+"      ,X.dealNo"         
			+"      ,X.approvalNo"     
			+"      ,X.approvalDt"     
			+"      ,X.approvalTime"   
			+"      ,X.dealAmt"        
			+"      ,X.cardNo"         
			+"      ,X.statusNm"       
			+"      ,X.statusDesc"
			+ "		,X.cancelMemo"
			+" FROM ("
	        +"       SELECT B.JOB_DIVIDER                             jobDivider"
            +"              ,SUBSTR(A.DEAL_DT,0,8)                    saleDt"
            +"              ,A.STORE_CD                               storeCd"
            +"              ,''                                       dealType"
            +"              ,A.DEAL_DIVIDER                           dealDivider"
            +"              ,''                                       dealNo"
            +"              ,A.APPROVAL_NO                            approvalNo"
            +"              ,A.APPROVAL_DT                            approvalDt"
            +"              ,''                                       approvalTime"
            +"              ,B.ORDER_AMT                              dealAmt"
            +"              ,A.CARD_NO                                cardNo"
            +"              ,FNC_SETTLE_STATUS_CODE_NM(B.STATUS_DESC) statusNm"
            +"              ,B.STATUS_DESC                            statusDesc"
            + "				,' ' cancelMemo"
			+"          FROM SETTLE_GSNPOINT A"   
			+"              ,SETTLE_RESULT B"   
			+"         WHERE 1 = 1"
			+"           AND 'GSPOINT'     = DECODE(#{jobDivider},NULL,'GSPOINT',#{jobDivider})"
			+"          <if test=\"dateType.equals('DATE-0001')\">"
			+"            AND A.DEAL_DT      BETWEEN #{startDate} || '000000' AND #{endDate} || '999999'" // 영업일자
			+"          </if>"
			+"          <if test=\"dateType.equals('DATE-0002')\">"
            +"           AND A.APPROVAL_DT   BETWEEN #{startDate} AND #{endDate}" //승인일자
			+"          </if>"
			+"          <if test=\"dealDivider != null and !dealDivider.equals('')\">"
			+"           AND B.DEAL_DIVIDER = #{dealDivider}"
			+"          </if>"
            +"          <if test=\"orderNo != null and !orderNo.equals('')\">"
            +"           AND B.APPROVAL_NO = #{orderNo}"            
            +"          </if>"   						
			+"           AND B.JOB_DIVIDER = #{jobDivider}"   
			+"           AND B.SETTLE_SEQ  = A.SEQ"   
			+"           AND B.WORK_DT     = A.WORK_DT"   
			+"           AND B.STATUS     IN ('STS-0002' , 'STS-0004')"   
			+"       UNION ALL"
			+"        SELECT A.JOB_DIVIDER"   
			+"              ,SUBSTR(B.DEAL_DT,0,8) SALE_DT"   
			+"              ,B.STORE_CD"   
			+"              ,'' DEAL_TYPE"   
			+"              ,B.DEAL_DIVIDER"   
			+"              ,'' DEAL_NO"   
			+"              ,B.APPROVAL_NO"   
			+"              ,B.APPROVAL_DT"   
			+"              ,'' APPROVAL_TIME"   
			+"              ,B.USE_POINT DEAL_AMT"   
			+"              ,B.CARD_NO"   
			+"              ,FNC_SETTLE_STATUS_CODE_NM(A.STATUS_DESC) STATUS_NM"   
			+"              ,A.STATUS_DESC"
			+ "				,B.cancelMemo"   
			+"          FROM ("   
			+"                  SELECT *"   
			+"                    FROM SETTLE_RESULT"   
			+"                   WHERE JOB_DIVIDER = 'GSPOINT'"   
			+"                     AND 'GSPOINT'   = DECODE(#{jobDivider},NULL,'GSPOINT',#{jobDivider})"   
			+"                     AND STATUS      = 'STS-0003'"
			+"          <if test=\"dealDivider != null and !dealDivider.equals('')\">"
			+"                     AND DEAL_DIVIDER = #{dealDivider}"
			+"          </if>"			
            +"          <if test=\"orderNo != null and !orderNo.equals('')\">"
            +"                     AND APPROVAL_NO     = #{orderNo}"            
            +"          </if>"
			+"                ) A"   
			+"           INNER JOIN"   
			+"           ("   
			+"             SELECT ROWNUM"   
			+"                   ,A.GIFT_NO"   
			+"                   ,E.EXTEND_NO CARD_NO"   
			+"                   ,'E1010' STORE_CD"   
			+"                   ,TO_CHAR(A.APLDATE, 'YYYYMMDDHH24MISS') DEAL_DT"   
			+"                   ,DECODE(A.APLSTATUS, 'O1', '1', 'D1', '2', '0') DEAL_DIVIDER"   
			+"                   ,A.RC_AMT USE_POINT"   
			+"                   ,TO_CHAR(A.APLDATE, 'YYYYMMDD') APPROVAL_DT"   
			+"                   ,NVL(A.C_APLNO, ' ') APPROVAL_NO"   
			+"                   ,A.APLORDERNO DEAL_NO"   
			+"                   ,A.APLONLINEID MERCHANTID"
			+"					 ,NVL(CANCEL_MEMO, ' ') cancelMemo"   
			+"               FROM RC_APPROVAL A"   
			+"                  , GIFTEXTEND E"   
			+"              WHERE A.GIFT_NO = E.GIFT_NO"   
			+"                AND A.APLONLINEID = 'gsrpoppoint'"   
			+"          <if test=\"dateType.equals('DATE-0001')\">"
            +"                AND    SALESDATE  BETWEEN TO_CHAR(TO_DATE(#{startDate}),'YYYYMMDD') AND TO_CHAR(TO_DATE(#{endDate}) ,'YYYYMMDD')" // 영업일자
			+"          </if>"
			+"          <if test=\"dateType.equals('DATE-0002')\">"
            +"                 AND    APLDATE    BETWEEN TO_CHAR(TO_DATE(#{startDate}),'YYYYMMDD') AND TO_CHAR(TO_DATE(#{endDate}) ,'YYYYMMDD')"  // 승인일자	        
            +"          </if>"      
            +"          <if test=\"orderNo != null and !orderNo.equals('')\">"
            +"                AND A.C_APLNO     = #{orderNo}"            
            +"          </if>"            
			+"                AND A.PAY_METHDO IN ('2', 'A2')"   
			+"                AND 'GSPOINT'     = DECODE(#{jobDivider},NULL,'GSPOINT',#{jobDivider})"   
			+"             ) B"   
			+"          ON A.APPROVAL_NO = B.APPROVAL_NO"   
			+"         AND A.DEAL_DIVIDER = B.DEAL_DIVIDER"
			+"          <if test=\"isExcel != null and isExcel.equals('Y')\">"
			+ "		  ORDER BY SALEDT ASC"               
            +"          </if>"
            +"          <if test=\"isExcel != null and isExcel.equals('N')\">"
            + "		  ORDER BY STORECD, SALEDT, APPROVALTIME ASC"               
            +"          </if>"
			+"         ) X"
			+"  WHERE ROWNUM &lt;= #{offset} + #{limit}"
			+" ) Z"
			+" WHERE RNUM &gt; #{offset}"
			+" </script>"
			;
	
	public static final String HM_INCONSISTENCY_SELECT_SQL ="<script>"
			+"with DATE_TMP AS ("
			+"		   SELECT TO_CHAR(TO_DATE(#{startDate} , 'YYYYMMDD') + LEVEL -1 , 'YYYYMMDD') searchDate"
			+"		     FROM DUAL"
			+"		  CONNECT BY LEVEL &lt;= TO_DATE(#{endDate}, 'YYYYMMDD')+1 - TO_DATE(#{startDate} , 'YYYYMMDD')"
			+"		 )"			
			+" SELECT Z.*"
			+"  FROM ( SELECT ROWNUM AS RNUM"  
			+"      ,DECODE(X.jobDivider , 'GSPOP' , 'GS25' , X.jobDivider) jobDivider"     
			+"      ,X.saleDt"         
			+"      ,X.storeCd"        
			+"      ,(SELECT MAX(CP_NAME) FROM PG_CP WHERE CP_ID = X.storeCd) storeNm"
			+"      ,DECODE(X.dealType , 'O1','결제', 'D1','취소', 'D2','취소') dealType"
			+"      ,X.dealDivider"
			+"      ,X.dealNo"         
			+"      ,X.approvalNo"     
			+"      ,X.approvalDt"     
			+"      ,X.approvalTime"   
			+"      ,X.dealAmt"        
			+"      ,X.cardNo"         
			+"      ,X.statusNm"       
			+"      ,X.statusDesc"
			+ "		,X.cancelMemo"
			+" FROM ("
	        +"       SELECT B.JOB_DIVIDER                             jobDivider"
            +"              ,A.DEAL_DT                                saleDt"
            +"              ,''                                       storeCd"
            +"              ,A.STATUS                                 dealType"
            +"              ,''                                       dealDivider"
            +"              ,A.ORDER_NO                               dealNo"
            +"              ,A.APPROVAL_NO                            approvalNo"
            +"              ,''                                       approvalDt"
            +"              ,''                                       approvalTime"
            +"              ,A.AMOUNT                                 dealAmt"
            +"              ,''                                       cardNo"
            +"              ,FNC_SETTLE_STATUS_CODE_NM(B.STATUS_DESC) statusNm"
            +"              ,B.STATUS_DESC                            statusDesc"
            + "				,' ' cancelMemo"
			+"          FROM SETTLE_HM A"   
			+"              ,SETTLE_RESULT B"
			+"              ,DATE_TMP C"
			+"         WHERE 1 = 1"
			+"           AND A.DEAL_DT = C.SEARCHDATE"
			+"          <if test=\"dealType != null and !dealType.equals('')\">"
			+"           AND A.STATUS = #{dealType}"
			+"          </if>"
            +"          <if test=\"orderNo != null and !orderNo.equals('')\">"
            +"           AND A.ORDER_NO = #{orderNo}"            
            +"          </if>"   			
			+"           AND B.JOB_DIVIDER = #{jobDivider}"   
			+"           AND B.SETTLE_SEQ  = A.SEQ"   
			+"           AND B.WORK_DT     = A.WORK_DT"   
			+"           AND B.STATUS     IN ('STS-0002' , 'STS-0005')"   
			+"       UNION ALL"
			+"        SELECT A.JOB_DIVIDER"   
			+"              ,B.O_DATE"   
			+"              ,''"   
			+"              ,B.O_RESULT"   
			+"              ,''"   
			+"              ,B.M_ONO"   
			+"              ,B.O_ADMITNO"   
			+"              ,B.O_ADMITDATE"   
			+"              ,''"   
			+"              ,B.O_T_MONEY"   
			+"              ,'' "   
			+"              ,FNC_SETTLE_STATUS_CODE_NM(A.STATUS_DESC)"   
			+"              ,A.STATUS_DESC"
			+ "				,C.MEMO calcelMemo"
			+"          FROM ("   
			+"                  SELECT *"   
			+"                    FROM SETTLE_RESULT"   
			+"                   WHERE JOB_DIVIDER = #{jobDivider}"   
			+"                     AND STATUS      = 'STS-0003'"
			+"          <if test=\"dealType != null and !dealType.equals('')\">"
			+"                     AND DEAL_TYPE = #{dealType}"
			+"          </if>"			
            +"          <if test=\"orderNo != null and !orderNo.equals('')\">"
            +"                     AND ORDER_NO  = #{orderNo}"            
            +"          </if>"      			
			+"                ) A"   
			+"           INNER JOIN"   
			+"           ("   
			+"             SELECT *"   
			+"               FROM ORDERLIST A"   
			+"              WHERE A.M_ID = 'happymoney_pop'"
            +"                AND A.O_DATE  BETWEEN TO_CHAR(TO_DATE(#{startDate}),'YYYYMMDD') AND TO_CHAR(TO_DATE(#{endDate}) ,'YYYYMMDD')" // 영업일자
            +"          <if test=\"orderNo != null and !orderNo.equals('')\">"
            +"                AND A.M_ONO   = #{orderNo}"            
            +"          </if>"
			+"          <if test=\"dealType != null and !dealType.equals('')\">"
			+"                AND O_RESULT = #{dealType}"
			+"          </if>"            
			+"             ) B "
			+ "				ON A.ORDER_NO  = B.M_ONO"
			+ "				AND A.DEAL_TYPE = B.O_RESULT"
			+ "				INNER JOIN"
			+ "				("
			+ "					SELECT * FROM CANCELDETAIL"
			+ "				) C ON B.TRANSID   = C.TRANSID"   
			+"         ) X"
			+"  WHERE ROWNUM &lt;= #{offset} + #{limit}"
			+" ) Z"
			+" WHERE RNUM &gt; #{offset}"
			+" </script>"
			;	
	
	public static final String GS_POP_INCONSISTENCY_SELECT_TOTAL_CNT_SQL ="<script>"
			+"with DATE_TMP AS ("
			+"		   SELECT TO_CHAR(TO_DATE(#{startDate} , 'YYYYMMDD') + LEVEL -1 , 'YYYYMMDD') searchDate"
			+"		     FROM DUAL"
			+"		  CONNECT BY LEVEL &lt;= TO_DATE(#{endDate}, 'YYYYMMDD')+1 - TO_DATE(#{startDate} , 'YYYYMMDD')"
			+"		 )"
			+" SELECT COUNT(1) count"
			+" FROM ("
			+"        SELECT B.JOB_DIVIDER                            jobDivider"
			+"              ,A.SALE_DT                                saleDt"
			+"              ,A.STORE_CD                               storeCd"
			+"              ,A.DEAL_TYPE                              dealType"
			+"              ,A.DEAL_DIVIDER                           dealDivider"
			+"              ,A.DEAL_NO                                dealNo"
			+"              ,A.APPROVAL_NO                            approvalNo"
			+"              ,A.APPROVAL_DT                            approvalDt"
			+"              ,A.APPROVAL_TIME                          approvalTime"
			+"              ,A.DEAL_AMT                               dealAmt"
			+"              ,A.CARD_NO                                cardNo"
			+"              ,FNC_SETTLE_STATUS_CODE_NM(B.STATUS_DESC) statusNm"
			+"              ,B.STATUS_DESC                            statusDesc"
			+"          FROM SETTLE_GS A"   
			+"              ,SETTLE_RESULT B"   
			+"              ,DATE_TMP C"   
			+"         WHERE 1 = 1"
			+"           AND A.JOB_DIVIDER = DECODE(#{jobDivider},NULL,A.JOB_DIVIDER,#{jobDivider})"
			+"          <if test=\"dateType.equals('DATE-0001')\">"
            +"           AND A.SALE_DT    = C.searchDate" // 영업일자
            +"          </if>"
            +"          <if test=\"dateType.equals('DATE-0002')\">"
            +"           AND A.APPROVAL_DT = C.searchDate" // 승인일자
            +"          </if>"
            +"          <if test=\"dealType != null and !dealType.equals('')\">"
            +"           AND B.DEAL_TYPE    = #{dealType}"
            +"          </if>"
            +"          <if test=\"dealDivider != null and !dealDivider.equals('')\">"
            +"           AND B.DEAL_DIVIDER = #{dealDivider}"            
            +"          </if>"
            +"          <if test=\"orderNo != null and !orderNo.equals('')\">"
            +"           AND B.ORDER_NO     = #{orderNo}"            
            +"          </if>"
			+"           AND B.JOB_DIVIDER = A.JOB_DIVIDER"   
			+"           AND B.SETTLE_SEQ  = A.SEQ"   
			+"           AND B.WORK_DT     = A.WORK_DT"   
			+"           AND B.STATUS     IN ('STS-0002' , 'STS-0004')"   
			+"         UNION ALL"   
			+"        SELECT A.JOB_DIVIDER"   
			+"              ,B.SALE_DT"   
			+"              ,B.STORE_CD"   
			+"              ,B.DEAL_TYPE"   
			+"              ,B.DEAL_DIVIDER"   
			+"              ,B.DEAL_NO"   
			+"              ,B.APPROVAL_NO"   
			+"              ,B.APPROVAL_DT"   
			+"              ,B.APPROVAL_TIME"   
			+"              ,B.DEAL_AMT"   
			+"              ,B.CARD_NO"   
			+"              ,FNC_SETTLE_STATUS_CODE_NM(A.STATUS_DESC) STATUS_NM"   
			+"              ,A.STATUS_DESC"   
			+"         FROM ("   
			+"              SELECT *"   
			+"                FROM SETTLE_RESULT B"   
			+"               WHERE JOB_DIVIDER = 'GSPOP'"   
			+"                 AND 'GSPOP'     = DECODE(#{jobDivider},NULL,'GSPOP',#{jobDivider})"
            +"          <if test=\"dealType != null and !dealType.equals('')\">"
            +"                 AND DEAL_TYPE    = #{dealType}"
            +"          </if>"
            +"          <if test=\"dealDivider != null and !dealDivider.equals('')\">"
            +"                 AND DEAL_DIVIDER = #{dealDivider}"            
            +"          </if>"  			
            +"          <if test=\"orderNo != null and !orderNo.equals('')\">"
            +"                 AND ORDER_NO     = #{orderNo}"            
            +"          </if>"		            
			+"                 AND STATUS      = 'STS-0003'"   
			+"            ) A"   
			+"          INNER JOIN"   
			+"           ("   
			+"              SELECT  SALESDATE SALE_DT"   
			+"                      ,BRANCHCODE STORE_CD"   
			+"                      ,ORDERNO DEAL_NO"   
			+"                      ,APLNO APPROVAL_NO"   
			+"                      ,APLDATE APPROVAL_DT"   
			+"                      ,APLTIME APPROVAL_TIME"   
			+"                      ,A.GIFT_NO"   
			+"                      ,(SELECT EXTEND_NO"   
			+"                          FROM GIFTEXTEND"   
			+"                         WHERE GIFT_NO = A.GIFT_NO) AS CARD_NO"   
			+"                      ,ORDERAMT DEAL_AMT"   
			+"                      ,TTYPE DEAL_TYPE"   
			+"                      ,ATYPE DEAL_DIVIDER"   
			+"                      ,MERCHANTID"   
			+"                FROM   (SELECT SALESDATE,"   
			+"                               BRANCHCODE,"   
			+"                               ORDERNO,"   
			+"                               APLNO,"   
			+"                               APLDATE,"   
			+"                               APLTIME,"   
			+"                               (SELECT MAX(B.GIFT_NO)"   
			+"                                FROM   ORDERDETAIL A,"   
			+"                                       (SELECT GIFT_NO,"   
			+"                                               SEQ_NO"   
			+"                                        FROM   GIFTCREATE"   
			+"                                        UNION ALL"   
			+"                                        SELECT GIFT_NO,"   
			+"                                               SEQ_NO"   
			+"                                        FROM   GIFTDELETE) B"   
			+"                                WHERE  A.C_SERIAL = B.SEQ_NO"   
			+"                                AND    A.TRANSID = ORDERLIST_POS.TRANSID ) GIFT_NO,"   
			+"                               (SELECT MAX(B.GIFT_CHECK)"   
			+"                                FROM   ORDERDETAIL A,"   
			+"                                       (SELECT GIFT_CHECK,"   
			+"                                               SEQ_NO"   
			+"                                        FROM   GIFTCREATE"   
			+"                                        UNION ALL"   
			+"                                        SELECT GIFT_CHECK,"   
			+"                                               SEQ_NO"   
			+"                                        FROM   GIFTDELETE) B"   
			+"                                WHERE  A.C_SERIAL = B.SEQ_NO"   
			+"                                AND    A.TRANSID = ORDERLIST_POS.TRANSID ) GIFT_CHECK,"   
			+"                               ORDERAMT,"   
			+"                               DECODE(RESULTCODE, 'O1', 'PAY', 'R1', 'REF', 'D1', 'PAY', 'T1', 'REF') TTYPE,"   
			+"                               DECODE(RESULTCODE, 'O1', '0', 'R1', '0', 'D1', '9', 'T1', '9') ATYPE,"   
			+"                               '0' PTYPE,"   
			+"                               MERCHANTID"   
			+"                        FROM   ORDERLIST_POS"   
			+"                        WHERE  MERCHANTID = 'gspopcardp'"   
			+"                        AND    'GSPOP'    = DECODE(#{jobDivider},NULL,'GSPOP',#{jobDivider})"
			+"          <if test=\"dateType.equals('DATE-0001')\">"
            +"                        AND    SALESDATE  BETWEEN TO_CHAR(TO_DATE(#{startDate}),'YYYYMMDD') AND TO_CHAR(TO_DATE(#{endDate}) ,'YYYYMMDD')" // 영업일자
			+"          </if>"
			+"          <if test=\"dateType.equals('DATE-0002')\">"
            +"                        AND    APLDATE    BETWEEN TO_CHAR(TO_DATE(#{startDate}),'YYYYMMDD') AND TO_CHAR(TO_DATE(#{endDate}) ,'YYYYMMDD')"  // 승인일자	        
            +"          </if>"   
            +"          <if test=\"orderNo != null and !orderNo.equals('')\">"
            +"                        AND ORDERNO     = #{orderNo}"            
            +"          </if>"		                   
			+"                        UNION ALL"   
			+"                        SELECT SALESDATE,"   
			+"                               BRANCHCODE,"   
			+"                               APLORDERNO ORDERNO,"   
			+"                               APLNO,"   
			+"                               APLDATE,"   
			+"                               APLTIME,"   
			+"                               (SELECT MAX(TICKET_SNO)"   
			+"                                FROM   ACTIVE_APL_DETAIL"   
			+"                                WHERE  APLID = ACTIVE_APPROVAL.APLID ) GIFT_NO,"   
			+"                               (SELECT MAX(B.GIFT_CHECK)"   
			+"                                FROM   ACTIVE_APL_DETAIL A,"   
			+"                                       (SELECT GIFT_CHECK,"   
			+"                                               GIFT_NO"   
			+"                                        FROM   GIFTCREATE"   
			+"                                        UNION ALL"   
			+"                                        SELECT GIFT_CHECK,"   
			+"                                               GIFT_NO"   
			+"                                        FROM   GIFTDELETE) B"   
			+"                                WHERE  A.TICKET_SNO = B.GIFT_NO"   
			+"                                AND    A.APLID = ACTIVE_APPROVAL.APLID ) GIFT_CHECK,"   
			+"                               (SELECT CREATE_AMT"   
			+"                                FROM   (SELECT GIFT_NO,"   
			+"                                               CREATE_AMT"   
			+"                                        FROM   GIFTDELETE ) A"   
			+"                                WHERE  GIFT_NO = (SELECT MAX(TICKET_SNO)"   
			+"                                        FROM   ACTIVE_APL_DETAIL A"   
			+"                                        WHERE  APLID = ACTIVE_APPROVAL.APLID )"   
			+"                                UNION ALL"   
			+"                                SELECT CREATE_AMT"   
			+"                                FROM   (SELECT GIFT_NO,"   
			+"                                               CREATE_AMT"   
			+"                                        FROM   GIFTCREATE ) A"   
			+"                                WHERE  GIFT_NO = (SELECT MAX(TICKET_SNO)"   
			+"                                        FROM   ACTIVE_APL_DETAIL A"   
			+"                                        WHERE  APLID = ACTIVE_APPROVAL.APLID ) )ORDERAMT,"   
			+"                               'ACT' TTYPE,"   
			+"                               DECODE(APLSTATUS, '1', '0', '2', '9') ATYPE,"   
			+"                               NVL(PAY_METHDO, '0') PTYPE,"   
			+"                               APLONLINEID MERCHANTID"   
			+"                        FROM   ACTIVE_APPROVAL"   
			+"                        WHERE  APLONLINEID = 'gspopcards'"   
			+"          <if test=\"dateType.equals('DATE-0001')\">"
            +"                        AND    SALESDATE  BETWEEN TO_CHAR(TO_DATE(#{startDate}),'YYYYMMDD') AND TO_CHAR(TO_DATE(#{endDate}) ,'YYYYMMDD')" // 영업일자
			+"          </if>"
			+"          <if test=\"dateType.equals('DATE-0002')\">"
            +"                        AND    APLDATE    BETWEEN TO_CHAR(TO_DATE(#{startDate}),'YYYYMMDD') AND TO_CHAR(TO_DATE(#{endDate}) ,'YYYYMMDD')"  // 승인일자	        
            +"          </if>"   
            +"          <if test=\"orderNo != null and !orderNo.equals('')\">"
            +"                        AND APLORDERNO     = #{orderNo}"            
            +"          </if>"		              
			+"                        AND    'GSPOP'     = DECODE(#{jobDivider},NULL,'GSPOP',#{jobDivider})"   
			+"                        UNION ALL"   
			+"                        SELECT SALESDATE,"   
			+"                               BRANCHCODE,"   
			+"                               APLORDERNO ORDERNO,"   
			+"                               APLNO,"   
			+"                               TO_CHAR(APLDATE, 'YYYYMMDD') APLDATE,"   
			+"                               TO_CHAR(APLDATE, 'HH24MISS') APLTIME,"   
			+"                               GIFT_NO,"   
			+"                               (SELECT GIFT_CHECK"   
			+"                                FROM   (SELECT GIFT_CHECK,"   
			+"                                               GIFT_NO"   
			+"                                        FROM   GIFTCREATE"   
			+"                                        UNION ALL"   
			+"                                        SELECT GIFT_CHECK,"   
			+"                                               GIFT_NO"   
			+"                                        FROM   GIFTDELETE)"   
			+"                                WHERE  GIFT_NO = RC_APPROVAL.GIFT_NO ) GIFT_CHECK,"   
			+"                               RC_AMT ORDERAMT,"   
			+"                               DECODE(APLSTATUS, 'O1', 'CHR', 'D1', 'CHR', 'TT1', 'TRN') TTYPE,"   
			+"                               DECODE(APLSTATUS, 'O1', '0', 'D1', '9', 'TT1', '0') ATYPE,"   
			+"                               NVL(PAY_METHDO, '0') PTYPE,"   
			+"                                   APLONLINEID MERCHANTID"   
			+"                        FROM   RC_APPROVAL"   
			+"                        WHERE  APLONLINEID = 'gspopcards'"   
			+"          <if test=\"dateType.equals('DATE-0001')\">"
            +"                        AND    SALESDATE  BETWEEN TO_CHAR(TO_DATE(#{startDate}),'YYYYMMDD') AND TO_CHAR(TO_DATE(#{endDate}) ,'YYYYMMDD')" // 영업일자
			+"          </if>"
			+"          <if test=\"dateType.equals('DATE-0002')\">"
            +"                        AND    APLDATE    BETWEEN TO_CHAR(TO_DATE(#{startDate}),'YYYYMMDD') AND TO_CHAR(TO_DATE(#{endDate}) ,'YYYYMMDD')"  // 승인일자	        
            +"          </if>"    
            +"          <if test=\"orderNo != null and !orderNo.equals('')\">"
            +"                        AND APLORDERNO     = #{orderNo}"            
            +"          </if>"		                  
			+"                        AND    APLSTATUS IN ('O1','D1','TT1')"   
			+"                        AND    'GSPOP'     = DECODE(#{jobDivider},NULL,'GSPOP',#{jobDivider})"   
			+"                        ) A"   
			+"             ) B"   
			+"          ON A.ORDER_NO = B.DEAL_NO"   
			+"         AND A.APPROVAL_NO = B.APPROVAL_NO"   
			+"         AND A.DEAL_TYPE = B.DEAL_TYPE"   
			+"         AND A.DEAL_DIVIDER = B.DEAL_DIVIDER"   
			+"         ) X"
			+" </script>"
			;	
	
	public static final String GSHB_INCONSISTENCY_SELECT_TOTAL_CNT_SQL ="<script>"
			+"with DATE_TMP AS ("
			+"		   SELECT TO_CHAR(TO_DATE(#{startDate} , 'YYYYMMDD') + LEVEL -1 , 'YYYYMMDD') searchDate"
			+"		     FROM DUAL"
			+"		  CONNECT BY LEVEL &lt;= TO_DATE(#{endDate}, 'YYYYMMDD')+1 - TO_DATE(#{startDate} , 'YYYYMMDD')"
			+"		 )"
			+" SELECT COUNT(1) count"
			+" FROM ("
			+"        SELECT B.JOB_DIVIDER                            jobDivider"
			+"              ,A.SALE_DT                                saleDt"
			+"              ,A.STORE_CD                               storeCd"
			+"              ,A.DEAL_TYPE                              dealType"
			+"              ,A.DEAL_DIVIDER                           dealDivider"
			+"              ,A.DEAL_NO                                dealNo"
			+"              ,A.APPROVAL_NO                            approvalNo"
			+"              ,A.APPROVAL_DT                            approvalDt"
			+"              ,A.APPROVAL_TIME                          approvalTime"
			+"              ,A.DEAL_AMT                               dealAmt"
			+"              ,A.CARD_NO                                cardNo"
			+"              ,FNC_SETTLE_STATUS_CODE_NM(B.STATUS_DESC) statusNm"
			+"              ,B.STATUS_DESC                            statusDesc"
			+"          FROM SETTLE_GS A"   
			+"              ,SETTLE_RESULT B"   
			+"              ,DATE_TMP C"   
			+"         WHERE 1 = 1"
			+"           AND A.JOB_DIVIDER = DECODE(#{jobDivider},NULL,A.JOB_DIVIDER,#{jobDivider})"
			+"          <if test=\"dateType.equals('DATE-0001')\">"
            +"           AND A.SALE_DT    = C.searchDate" // 영업일자
            +"          </if>"
            +"          <if test=\"dateType.equals('DATE-0002')\">"
            +"           AND A.APPROVAL_DT = C.searchDate" // 승인일자
            +"          </if>"
            +"          <if test=\"dealType != null and !dealType.equals('')\">"
            +"           AND B.DEAL_TYPE    = #{dealType}"
            +"          </if>"
            +"          <if test=\"dealDivider != null and !dealDivider.equals('')\">"
            +"           AND B.DEAL_DIVIDER = #{dealDivider}"            
            +"          </if>"
            +"          <if test=\"orderNo != null and !orderNo.equals('')\">"
            +"           AND B.ORDER_NO     = #{orderNo}"            
            +"          </if>"
			+"           AND B.JOB_DIVIDER = A.JOB_DIVIDER"   
			+"           AND B.SETTLE_SEQ  = A.SEQ"   
			+"           AND B.WORK_DT     = A.WORK_DT"   
			+"           AND B.STATUS     IN ('STS-0002' , 'STS-0004')"   
			+"         UNION ALL"   
			+"        SELECT A.JOB_DIVIDER"   
			+"              ,B.SALE_DT"   
			+"              ,B.STORE_CD"   
			+"              ,B.DEAL_TYPE"   
			+"              ,B.DEAL_DIVIDER"   
			+"              ,B.DEAL_NO"   
			+"              ,B.APPROVAL_NO"   
			+"              ,B.APPROVAL_DT"   
			+"              ,B.APPROVAL_TIME"   
			+"              ,B.DEAL_AMT"   
			+"              ,B.CARD_NO"   
			+"              ,FNC_SETTLE_STATUS_CODE_NM(A.STATUS_DESC) STATUS_NM"   
			+"              ,A.STATUS_DESC"   
			+"         FROM ("   
			+"              SELECT *"   
			+"                FROM SETTLE_RESULT B"   
			+"               WHERE JOB_DIVIDER = 'GSHB'"   
			+"                 AND 'GSHB'     = DECODE(#{jobDivider},NULL,'GSPOP',#{jobDivider})"
            +"          <if test=\"dealType != null and !dealType.equals('')\">"
            +"                 AND DEAL_TYPE    = #{dealType}"
            +"          </if>"
            +"          <if test=\"dealDivider != null and !dealDivider.equals('')\">"
            +"                 AND DEAL_DIVIDER = #{dealDivider}"            
            +"          </if>"  			
            +"          <if test=\"orderNo != null and !orderNo.equals('')\">"
            +"                 AND ORDER_NO     = #{orderNo}"            
            +"          </if>"		            
			+"                 AND STATUS      = 'STS-0003'"   
			+"            ) A"   
			+"          INNER JOIN"   
			+"           ("   
			+"              SELECT  SALESDATE SALE_DT"   
			+"                      ,BRANCHCODE STORE_CD"   
			+"                      ,ORDERNO DEAL_NO"   
			+"                      ,APLNO APPROVAL_NO"   
			+"                      ,APLDATE APPROVAL_DT"   
			+"                      ,APLTIME APPROVAL_TIME"   
			+"                      ,A.GIFT_NO"   
			+"                      ,(SELECT EXTEND_NO"   
			+"                          FROM GIFTEXTEND"   
			+"                         WHERE GIFT_NO = A.GIFT_NO) AS CARD_NO"   
			+"                      ,ORDERAMT DEAL_AMT"   
			+"                      ,TTYPE DEAL_TYPE"   
			+"                      ,ATYPE DEAL_DIVIDER"   
			+"                      ,MERCHANTID"   
			+"                FROM   (SELECT SALESDATE,"   
			+"                               BRANCHCODE,"   
			+"                               ORDERNO,"   
			+"                               APLNO,"   
			+"                               APLDATE,"   
			+"                               APLTIME,"   
			+"                               (SELECT MAX(B.GIFT_NO)"   
			+"                                FROM   ORDERDETAIL A,"   
			+"                                       (SELECT GIFT_NO,"   
			+"                                               SEQ_NO"   
			+"                                        FROM   GIFTCREATE"   
			+"                                        UNION ALL"   
			+"                                        SELECT GIFT_NO,"   
			+"                                               SEQ_NO"   
			+"                                        FROM   GIFTDELETE) B"   
			+"                                WHERE  A.C_SERIAL = B.SEQ_NO"   
			+"                                AND    A.TRANSID = ORDERLIST_POS.TRANSID ) GIFT_NO,"   
			+"                               (SELECT MAX(B.GIFT_CHECK)"   
			+"                                FROM   ORDERDETAIL A,"   
			+"                                       (SELECT GIFT_CHECK,"   
			+"                                               SEQ_NO"   
			+"                                        FROM   GIFTCREATE"   
			+"                                        UNION ALL"   
			+"                                        SELECT GIFT_CHECK,"   
			+"                                               SEQ_NO"   
			+"                                        FROM   GIFTDELETE) B"   
			+"                                WHERE  A.C_SERIAL = B.SEQ_NO"   
			+"                                AND    A.TRANSID = ORDERLIST_POS.TRANSID ) GIFT_CHECK,"   
			+"                               ORDERAMT,"   
			+"                               DECODE(RESULTCODE, 'O1', 'PAY', 'R1', 'REF', 'D1', 'PAY', 'T1', 'REF') TTYPE,"   
			+"                               DECODE(RESULTCODE, 'O1', '0', 'R1', '0', 'D1', '9', 'T1', '9') ATYPE,"   
			+"                               '0' PTYPE,"   
			+"                               MERCHANTID"   
			+"                        FROM   ORDERLIST_POS"   
			+"                        WHERE  MERCHANTID = 'gswatsonspop'"   
			+"                        AND    'GSHB'    = DECODE(#{jobDivider},NULL,'GSPOP',#{jobDivider})"
			+"          <if test=\"dateType.equals('DATE-0001')\">"
            +"                        AND    SALESDATE  BETWEEN TO_CHAR(TO_DATE(#{startDate}),'YYYYMMDD') AND TO_CHAR(TO_DATE(#{endDate}) ,'YYYYMMDD')" // 영업일자
			+"          </if>"
			+"          <if test=\"dateType.equals('DATE-0002')\">"
            +"                        AND    APLDATE    BETWEEN TO_CHAR(TO_DATE(#{startDate}),'YYYYMMDD') AND TO_CHAR(TO_DATE(#{endDate}) ,'YYYYMMDD')"  // 승인일자	        
            +"          </if>"   
            +"          <if test=\"orderNo != null and !orderNo.equals('')\">"
            +"                        AND ORDERNO     = #{orderNo}"            
            +"          </if>"		                   
			+"                        UNION ALL"   
			+"                        SELECT SALESDATE,"   
			+"                               BRANCHCODE,"   
			+"                               APLORDERNO ORDERNO,"   
			+"                               APLNO,"   
			+"                               APLDATE,"   
			+"                               APLTIME,"   
			+"                               (SELECT MAX(TICKET_SNO)"   
			+"                                FROM   ACTIVE_APL_DETAIL"   
			+"                                WHERE  APLID = ACTIVE_APPROVAL.APLID ) GIFT_NO,"   
			+"                               (SELECT MAX(B.GIFT_CHECK)"   
			+"                                FROM   ACTIVE_APL_DETAIL A,"   
			+"                                       (SELECT GIFT_CHECK,"   
			+"                                               GIFT_NO"   
			+"                                        FROM   GIFTCREATE"   
			+"                                        UNION ALL"   
			+"                                        SELECT GIFT_CHECK,"   
			+"                                               GIFT_NO"   
			+"                                        FROM   GIFTDELETE) B"   
			+"                                WHERE  A.TICKET_SNO = B.GIFT_NO"   
			+"                                AND    A.APLID = ACTIVE_APPROVAL.APLID ) GIFT_CHECK,"   
			+"                               (SELECT CREATE_AMT"   
			+"                                FROM   (SELECT GIFT_NO,"   
			+"                                               CREATE_AMT"   
			+"                                        FROM   GIFTDELETE ) A"   
			+"                                WHERE  GIFT_NO = (SELECT MAX(TICKET_SNO)"   
			+"                                        FROM   ACTIVE_APL_DETAIL A"   
			+"                                        WHERE  APLID = ACTIVE_APPROVAL.APLID )"   
			+"                                UNION ALL"   
			+"                                SELECT CREATE_AMT"   
			+"                                FROM   (SELECT GIFT_NO,"   
			+"                                               CREATE_AMT"   
			+"                                        FROM   GIFTCREATE ) A"   
			+"                                WHERE  GIFT_NO = (SELECT MAX(TICKET_SNO)"   
			+"                                        FROM   ACTIVE_APL_DETAIL A"   
			+"                                        WHERE  APLID = ACTIVE_APPROVAL.APLID ) )ORDERAMT,"   
			+"                               'ACT' TTYPE,"   
			+"                               DECODE(APLSTATUS, '1', '0', '2', '9') ATYPE,"   
			+"                               NVL(PAY_METHDO, '0') PTYPE,"   
			+"                               APLONLINEID MERCHANTID"   
			+"                        FROM   ACTIVE_APPROVAL"   
			+"                        WHERE  APLONLINEID = 'gswatsonspops'"   
			+"          <if test=\"dateType.equals('DATE-0001')\">"
            +"                        AND    SALESDATE  BETWEEN TO_CHAR(TO_DATE(#{startDate}),'YYYYMMDD') AND TO_CHAR(TO_DATE(#{endDate}) ,'YYYYMMDD')" // 영업일자
			+"          </if>"
			+"          <if test=\"dateType.equals('DATE-0002')\">"
            +"                        AND    APLDATE    BETWEEN TO_CHAR(TO_DATE(#{startDate}),'YYYYMMDD') AND TO_CHAR(TO_DATE(#{endDate}) ,'YYYYMMDD')"  // 승인일자	        
            +"          </if>"   
            +"          <if test=\"orderNo != null and !orderNo.equals('')\">"
            +"                        AND APLORDERNO     = #{orderNo}"            
            +"          </if>"		              
			+"                        AND    'GSHB'     = DECODE(#{jobDivider},NULL,'GSHB',#{jobDivider})"   
			+"                        UNION ALL"   
			+"                        SELECT SALESDATE,"   
			+"                               BRANCHCODE,"   
			+"                               APLORDERNO ORDERNO,"   
			+"                               APLNO,"   
			+"                               TO_CHAR(APLDATE, 'YYYYMMDD') APLDATE,"   
			+"                               TO_CHAR(APLDATE, 'HH24MISS') APLTIME,"   
			+"                               GIFT_NO,"   
			+"                               (SELECT GIFT_CHECK"   
			+"                                FROM   (SELECT GIFT_CHECK,"   
			+"                                               GIFT_NO"   
			+"                                        FROM   GIFTCREATE"   
			+"                                        UNION ALL"   
			+"                                        SELECT GIFT_CHECK,"   
			+"                                               GIFT_NO"   
			+"                                        FROM   GIFTDELETE)"   
			+"                                WHERE  GIFT_NO = RC_APPROVAL.GIFT_NO ) GIFT_CHECK,"   
			+"                               RC_AMT ORDERAMT,"   
			+"                               DECODE(APLSTATUS, 'O1', 'CHR', 'D1', 'CHR', 'TT1', 'TRN') TTYPE,"   
			+"                               DECODE(APLSTATUS, 'O1', '0', 'D1', '9', 'TT1', '0') ATYPE,"   
			+"                               NVL(PAY_METHDO, '0') PTYPE,"   
			+"                                   APLONLINEID MERCHANTID"   
			+"                        FROM   RC_APPROVAL"   
			+"                        WHERE  APLONLINEID = 'gswatsonspops'"   
			+"          <if test=\"dateType.equals('DATE-0001')\">"
            +"                        AND    SALESDATE  BETWEEN TO_CHAR(TO_DATE(#{startDate}),'YYYYMMDD') AND TO_CHAR(TO_DATE(#{endDate}) ,'YYYYMMDD')" // 영업일자
			+"          </if>"
			+"          <if test=\"dateType.equals('DATE-0002')\">"
            +"                        AND    APLDATE    BETWEEN TO_CHAR(TO_DATE(#{startDate}),'YYYYMMDD') AND TO_CHAR(TO_DATE(#{endDate}) ,'YYYYMMDD')"  // 승인일자	        
            +"          </if>"     
            +"          <if test=\"orderNo != null and !orderNo.equals('')\">"
            +"                        AND APLORDERNO     = #{orderNo}"            
            +"          </if>"		                  
			+"                        AND    APLSTATUS IN ('O1','D1','TT1')"   
			+"                        AND    'GSHB'     = DECODE(#{jobDivider},NULL,'GSHB',#{jobDivider})"   
			+"                        ) A"   
			+"             ) B"   
			+"          ON A.ORDER_NO = B.DEAL_NO"   
			+"         AND A.APPROVAL_NO = B.APPROVAL_NO"   
			+"         AND A.DEAL_TYPE = B.DEAL_TYPE"   
			+"         AND A.DEAL_DIVIDER = B.DEAL_DIVIDER"   
			+"         ) X"
			+" </script>"
			;	
	
	public static final String GS_SM_INCONSISTENCY_SELECT_TOTAL_CNT_SQL ="<script>"
			+"with DATE_TMP AS ("
			+"		   SELECT TO_CHAR(TO_DATE(#{startDate} , 'YYYYMMDD') + LEVEL -1 , 'YYYYMMDD') searchDate"
			+"		     FROM DUAL"
			+"		  CONNECT BY LEVEL &lt;= TO_DATE(#{endDate}, 'YYYYMMDD')+1 - TO_DATE(#{startDate} , 'YYYYMMDD')"
			+"		 )"
			+" SELECT COUNT(1) count"
			+" FROM ("
			+"        SELECT B.JOB_DIVIDER                            jobDivider"
			+"              ,A.SALE_DT                                saleDt"
			+"              ,A.STORE_CD                               storeCd"
			+"              ,A.DEAL_TYPE                              dealType"
			+"              ,A.DEAL_DIVIDER                           dealDivider"
			+"              ,A.DEAL_NO                                dealNo"
			+"              ,A.APPROVAL_NO                            approvalNo"
			+"              ,A.APPROVAL_DT                            approvalDt"
			+"              ,A.APPROVAL_TIME                          approvalTime"
			+"              ,A.DEAL_AMT                               dealAmt"
			+"              ,A.CARD_NO                                cardNo"
			+"              ,FNC_SETTLE_STATUS_CODE_NM(B.STATUS_DESC) statusNm"
			+"              ,B.STATUS_DESC                            statusDesc"
			+"          FROM SETTLE_GS A"   
			+"              ,SETTLE_RESULT B"   
			+"              ,DATE_TMP C"   
			+"         WHERE 1 = 1"
			+"           AND A.JOB_DIVIDER = DECODE(#{jobDivider},NULL,A.JOB_DIVIDER,#{jobDivider})"
			+"          <if test=\"dateType.equals('DATE-0001')\">"
            +"           AND A.SALE_DT    = C.searchDate" // 영업일자
            +"          </if>"
            +"          <if test=\"dateType.equals('DATE-0002')\">"
            +"           AND A.APPROVAL_DT = C.searchDate" // 승인일자
            +"          </if>"
            +"          <if test=\"dealType != null and !dealType.equals('')\">"
            +"           AND B.DEAL_TYPE    = #{dealType}"
            +"          </if>"
            +"          <if test=\"dealDivider != null and !dealDivider.equals('')\">"
            +"           AND B.DEAL_DIVIDER = #{dealDivider}"            
            +"          </if>"
            +"          <if test=\"orderNo != null and !orderNo.equals('')\">"
            +"           AND B.ORDER_NO     = #{orderNo}"            
            +"          </if>"
			+"           AND B.JOB_DIVIDER = A.JOB_DIVIDER"   
			+"           AND B.SETTLE_SEQ  = A.SEQ"   
			+"           AND B.WORK_DT     = A.WORK_DT"   
			+"           AND B.STATUS     IN ('STS-0002' , 'STS-0005')"   
			+"         UNION ALL"   
			+"        SELECT A.JOB_DIVIDER"   
			+"              ,B.SALE_DT"   
			+"              ,B.STORE_CD"   
			+"              ,B.DEAL_TYPE"   
			+"              ,B.DEAL_DIVIDER"   
			+"              ,B.DEAL_NO"   
			+"              ,B.APPROVAL_NO"   
			+"              ,B.APPROVAL_DT"   
			+"              ,B.APPROVAL_TIME"   
			+"              ,B.DEAL_AMT"   
			+"              ,B.CARD_NO"   
			+"              ,FNC_SETTLE_STATUS_CODE_NM(A.STATUS_DESC) STATUS_NM"   
			+"              ,A.STATUS_DESC"   
			+"        FROM ("   
			+"              SELECT *"   
			+"                FROM SETTLE_RESULT B"   
			+"               WHERE JOB_DIVIDER = 'GSSM'"   
			+"                 AND STATUS      = 'STS-0003'"   
			+"                 AND 'GSSM'      = DECODE(#{jobDivider},NULL,'GSSM',#{jobDivider})"
            +"          <if test=\"dealType != null and !dealType.equals('')\">"
            +"                 AND DEAL_TYPE    = #{dealType}"
            +"          </if>"
            +"          <if test=\"dealDivider != null and !dealDivider.equals('')\">"
            +"                 AND DEAL_DIVIDER = #{dealDivider}"            
            +"          </if>"  			
            +"          <if test=\"orderNo != null and !orderNo.equals('')\">"
            +"                 AND ORDER_NO     = #{orderNo}"            
            +"          </if>"            
			+"            ) A"   
			+"          INNER JOIN"   
			+"           ("   
			+"           SELECT  SALESDATE SALE_DT"   
			+"                   ,BRANCHCODE STORE_CD"   
			+"                   ,ORDERNO DEAL_NO"   
			+"                   ,APLNO APPROVAL_NO"   
			+"                   ,APLDATE APPROVAL_DT"   
			+"                   ,APLTIME APPROVAL_TIME"   
			+"                   ,A.GIFT_NO"   
			+"                   ,(SELECT EXTEND_NO"   
			+"                       FROM GIFTEXTEND"   
			+"                      WHERE GIFT_NO = A.GIFT_NO) AS CARD_NO"   
			+"                   ,ORDERAMT DEAL_AMT"   
			+"                   ,TTYPE DEAL_TYPE"   
			+"                   ,ATYPE DEAL_DIVIDER"   
			+"                   ,MERCHANTID"   
			+"             FROM   (SELECT SALESDATE,"   
			+"                            BRANCHCODE,"   
			+"                            ORDERNO,"   
			+"                            APLNO,"   
			+"                            APLDATE,"   
			+"                            APLTIME,"   
			+"                            (SELECT MAX(B.GIFT_NO)"   
			+"                             FROM   ORDERDETAIL A,"   
			+"                                    (SELECT GIFT_NO,"   
			+"                                            SEQ_NO"   
			+"                                     FROM   GIFTCREATE"   
			+"                                     UNION ALL"   
			+"                                     SELECT GIFT_NO,"   
			+"                                            SEQ_NO"   
			+"                                     FROM   GIFTDELETE) B"   
			+"                             WHERE  A.C_SERIAL = B.SEQ_NO"   
			+"                             AND    A.TRANSID = ORDERLIST_POS.TRANSID ) GIFT_NO,"   
			+"                            (SELECT MAX(B.GIFT_CHECK)"   
			+"                             FROM   ORDERDETAIL A,"   
			+"                                    (SELECT GIFT_CHECK,"   
			+"                                            SEQ_NO"   
			+"                                     FROM   GIFTCREATE"   
			+"                                     UNION ALL"   
			+"                                     SELECT GIFT_CHECK,"   
			+"                                            SEQ_NO"   
			+"                                     FROM   GIFTDELETE) B"   
			+"                             WHERE  A.C_SERIAL = B.SEQ_NO"   
			+"                             AND    A.TRANSID = ORDERLIST_POS.TRANSID ) GIFT_CHECK,"   
			+"                            ORDERAMT,"   
			+"                            DECODE(RESULTCODE, 'O1', 'PAY', 'R1', 'REF', 'D1', 'PAY', 'T1', 'REF') TTYPE,"   
			+"                            DECODE(RESULTCODE, 'O1', '0', 'R1', '0', 'D1', '9', 'T1', '9') ATYPE,"   
			+"                            '0' PTYPE,"   
			+"                            MERCHANTID"   
			+"                     FROM   ORDERLIST_POS"   
			+"                     WHERE  MERCHANTID = 'gssmpopp'"
			+"          <if test=\"dateType.equals('DATE-0001')\">"
            +"                        AND    SALESDATE  BETWEEN TO_CHAR(TO_DATE(#{startDate}),'YYYYMMDD') AND TO_CHAR(TO_DATE(#{endDate}) ,'YYYYMMDD')" // 영업일자
			+"          </if>"
			+"          <if test=\"dateType.equals('DATE-0002')\">"
            +"                        AND    APLDATE    BETWEEN TO_CHAR(TO_DATE(#{startDate}),'YYYYMMDD') AND TO_CHAR(TO_DATE(#{endDate}),'YYYYMMDD')"  // 승인일자	        
            +"          </if>"   
            +"          <if test=\"orderNo != null and !orderNo.equals('')\">"
            +"                     AND ORDERNO     = #{orderNo}"            
            +"          </if>"			
			+"                     AND    'GSSM'      = DECODE(#{jobDivider},NULL,'GSSM',#{jobDivider})"   
			+"                     UNION ALL"   
			+"                     SELECT SALESDATE,"   
			+"                            BRANCHCODE,"   
			+"                            APLORDERNO ORDERNO,"   
			+"                            APLNO,"   
			+"                            APLDATE,"   
			+"                            APLTIME,"   
			+"                            (SELECT MAX(TICKET_SNO)"   
			+"                             FROM   ACTIVE_APL_DETAIL"   
			+"                             WHERE  APLID = ACTIVE_APPROVAL.APLID ) GIFT_NO,"   
			+"                            (SELECT MAX(B.GIFT_CHECK)"   
			+"                             FROM   ACTIVE_APL_DETAIL A,"   
			+"                                    (SELECT GIFT_CHECK,"   
			+"                                            GIFT_NO"   
			+"                                     FROM   GIFTCREATE"   
			+"                                     UNION ALL"   
			+"                                     SELECT GIFT_CHECK,"   
			+"                                            GIFT_NO"   
			+"                                     FROM   GIFTDELETE) B"   
			+"                             WHERE  A.TICKET_SNO = B.GIFT_NO"   
			+"                             AND    A.APLID = ACTIVE_APPROVAL.APLID ) GIFT_CHECK,"   
			+"                            (SELECT CREATE_AMT"   
			+"                             FROM   (SELECT GIFT_NO,"   
			+"                                            CREATE_AMT"   
			+"                                     FROM   GIFTDELETE ) A"   
			+"                             WHERE  GIFT_NO = (SELECT MAX(TICKET_SNO)"   
			+"                                     FROM   ACTIVE_APL_DETAIL A"   
			+"                                     WHERE  APLID = ACTIVE_APPROVAL.APLID )"   
			+"                             UNION ALL"   
			+"                             SELECT CREATE_AMT"   
			+"                             FROM   (SELECT GIFT_NO,"   
			+"                                            CREATE_AMT"   
			+"                                     FROM   GIFTCREATE ) A"   
			+"                             WHERE  GIFT_NO = (SELECT MAX(TICKET_SNO)"   
			+"                                     FROM   ACTIVE_APL_DETAIL A"   
			+"                                     WHERE  APLID = ACTIVE_APPROVAL.APLID ) )ORDERAMT,"   
			+"                            'ACT' TTYPE,"   
			+"                            DECODE(APLSTATUS, '1', '0', '2', '9') ATYPE,"   
			+"                            NVL(PAY_METHDO, '0') PTYPE,"   
			+"                            APLONLINEID MERCHANTID"   
			+"                     FROM   ACTIVE_APPROVAL"   
			+"                     WHERE  APLONLINEID = 'gssmpops'"   
			+"          <if test=\"dateType.equals('DATE-0001')\">"
            +"                        AND    SALESDATE  BETWEEN TO_CHAR(TO_DATE(#{startDate}),'YYYYMMDD') AND TO_CHAR(TO_DATE(#{endDate}) ,'YYYYMMDD')" // 영업일자
			+"          </if>"
			+"          <if test=\"dateType.equals('DATE-0002')\">"
            +"                        AND    APLDATE    BETWEEN TO_CHAR(TO_DATE(#{startDate}),'YYYYMMDD') AND TO_CHAR(TO_DATE(#{endDate}),'YYYYMMDD')"  // 승인일자	        
            +"          </if>"   
            +"          <if test=\"orderNo != null and !orderNo.equals('')\">"
            +"                       AND APLORDERNO     = #{orderNo}"            
            +"          </if>"		            
			+"                       AND    'GSSM'      = DECODE(#{jobDivider},NULL,'GSSM',#{jobDivider})"   
			+"                     UNION ALL"   
			+"                     SELECT SALESDATE,"   
			+"                            BRANCHCODE,"   
			+"                            APLORDERNO ORDERNO,"   
			+"                            APLNO,"   
			+"                            TO_CHAR(APLDATE, 'YYYYMMDD') APLDATE,"   
			+"                            TO_CHAR(APLDATE, 'HH24MISS') APLTIME,"   
			+"                            GIFT_NO,"   
			+"                            (SELECT GIFT_CHECK"   
			+"                             FROM   (SELECT GIFT_CHECK,"   
			+"                                            GIFT_NO"   
			+"                                     FROM   GIFTCREATE"   
			+"                                     UNION ALL"   
			+"                                     SELECT GIFT_CHECK,"   
			+"                                            GIFT_NO"   
			+"                                     FROM   GIFTDELETE)"   
			+"                             WHERE  GIFT_NO = RC_APPROVAL.GIFT_NO ) GIFT_CHECK,"   
			+"                            RC_AMT ORDERAMT,"   
			+"                            DECODE(APLSTATUS, 'O1', 'CHR', 'D1', 'CHR', 'TS1', 'TRN') TTYPE,"   
			+"                            DECODE(APLSTATUS, 'O1', '0', 'D1', '9', 'TS1', '0') ATYPE,"   
			+"                            NVL(PAY_METHDO, '0') PTYPE,"   
			+"                                APLONLINEID MERCHANTID"   
			+"                     FROM   RC_APPROVAL"   
			+"                     WHERE  APLONLINEID = 'gssmpops'"   
			+"          <if test=\"dateType.equals('DATE-0001')\">"
            +"                        AND    SALESDATE  BETWEEN TO_CHAR(TO_DATE(#{startDate}),'YYYYMMDD') AND TO_CHAR(TO_DATE(#{endDate}) ,'YYYYMMDD')" // 영업일자
			+"          </if>"
			+"          <if test=\"dateType.equals('DATE-0002')\">"
            +"                        AND    APLDATE    BETWEEN TO_CHAR(TO_DATE(#{startDate}),'YYYYMMDD') AND TO_CHAR(TO_DATE(#{endDate}) ,'YYYYMMDD')"  // 승인일자	        
            +"          </if>"   
            +"          <if test=\"orderNo != null and !orderNo.equals('')\">"
            +"                     AND APLORDERNO     = #{orderNo}"            
            +"          </if>"		            
			+"                     AND    APLSTATUS IN ('O1','D1','TS1')"   
			+"                     AND    'GSSM'     = DECODE(#{jobDivider},NULL,'GSSM',#{jobDivider})"   
			+"                     ) A"   
			+"             ) B"   
			+"          ON A.ORDER_NO = B.DEAL_NO"   
			+"         AND A.APPROVAL_NO = B.APPROVAL_NO"   
			+"         AND A.DEAL_TYPE = B.DEAL_TYPE"   
			+"         AND A.DEAL_DIVIDER = B.DEAL_DIVIDER"   
			+"         ) X"
			+" </script>"
			;	
		
	
	public static final String GS_POINT_INCONSISTENCY_SELECT_TOTAL_CNT_SQL ="<script>"
			+"with DATE_TMP AS ("
			+"		   SELECT TO_CHAR(TO_DATE(#{startDate} , 'YYYYMMDD') + LEVEL -1 , 'YYYYMMDD') searchDate"
			+"		     FROM DUAL"
			+"		  CONNECT BY LEVEL &lt;= TO_DATE(#{endDate}, 'YYYYMMDD')+1 - TO_DATE(#{startDate} , 'YYYYMMDD')"
			+"		 )"
			+" SELECT COUNT(1) count"
			+" FROM ("
	        +"       SELECT B.JOB_DIVIDER                             jobDivider"
            +"              ,SUBSTR(A.DEAL_DT,0,8)                    saleDt"
            +"              ,A.STORE_CD                               storeCd"
            +"              ,''                                       dealType"
            +"              ,A.DEAL_DIVIDER                           dealDivider"
            +"              ,''                                       dealNo"
            +"              ,A.APPROVAL_NO                            approvalNo"
            +"              ,A.APPROVAL_DT                            approvalDt"
            +"              ,''                                       approvalTime"
            +"              ,B.ORDER_AMT                              dealAmt"
            +"              ,A.CARD_NO                                cardNo"
            +"              ,FNC_SETTLE_STATUS_CODE_NM(B.STATUS_DESC) statusNm"
            +"              ,B.STATUS_DESC                            statusDesc"
			+"          FROM SETTLE_GSNPOINT A"   
			+"              ,SETTLE_RESULT B"   
			+"         WHERE 1 = 1"
			+"           AND 'GSPOINT'     = DECODE(#{jobDivider},NULL,'GSPOINT',#{jobDivider})"
			+"          <if test=\"dateType.equals('DATE-0001')\">"
			+"            AND A.DEAL_DT      BETWEEN #{startDate} || '000000' AND #{endDate} || '999999'" // 영업일자
			+"          </if>"
			+"          <if test=\"dateType.equals('DATE-0002')\">"
            +"           AND A.APPROVAL_DT   BETWEEN #{startDate} AND #{endDate}" //승인일자
			+"          </if>"
			+"          <if test=\"dealDivider != null and !dealDivider.equals('')\">"
			+"           AND B.DEAL_DIVIDER = #{dealDivider}"
			+"          </if>"
            +"          <if test=\"orderNo != null and !orderNo.equals('')\">"
            +"           AND B.APPROVAL_NO = #{orderNo}"            
            +"          </if>"   			
			+"           AND B.JOB_DIVIDER = #{jobDivider}"   
			+"           AND B.SETTLE_SEQ  = A.SEQ"   
			+"           AND B.WORK_DT     = A.WORK_DT"   
			+"           AND B.STATUS     IN ('STS-0002' , 'STS-0004')"   
			+"       UNION ALL"
			+"        SELECT A.JOB_DIVIDER"   
			+"              ,SUBSTR(B.DEAL_DT,0,8) SALE_DT"   
			+"              ,B.STORE_CD"   
			+"              ,'' DEAL_TYPE"   
			+"              ,B.DEAL_DIVIDER"   
			+"              ,'' DEAL_NO"   
			+"              ,B.APPROVAL_NO"   
			+"              ,B.APPROVAL_DT"   
			+"              ,'' APPROVAL_TIME"   
			+"              ,B.USE_POINT DEAL_AMT"   
			+"              ,B.CARD_NO"   
			+"              ,FNC_SETTLE_STATUS_CODE_NM(A.STATUS_DESC) STATUS_NM"   
			+"              ,A.STATUS_DESC"   
			+"          FROM ("   
			+"                  SELECT *"   
			+"                    FROM SETTLE_RESULT"   
			+"                   WHERE JOB_DIVIDER = 'GSPOINT'"   
			+"                     AND 'GSPOINT'   = DECODE(#{jobDivider},NULL,'GSPOINT',#{jobDivider})"   
			+"                     AND STATUS      = 'STS-0003'"
			+"          <if test=\"dealDivider != null and !dealDivider.equals('')\">"
			+"                     AND DEAL_DIVIDER = #{dealDivider}"
			+"          </if>"			
            +"          <if test=\"orderNo != null and !orderNo.equals('')\">"
            +"                     AND APPROVAL_NO = #{orderNo}"            
            +"          </if>"      			
			+"                ) A"   
			+"           INNER JOIN"   
			+"           ("   
			+"             SELECT ROWNUM"   
			+"                   ,A.GIFT_NO"   
			+"                   ,E.EXTEND_NO CARD_NO"   
			+"                   ,'E1010' STORE_CD"   
			+"                   ,TO_CHAR(A.APLDATE, 'YYYYMMDDHH24MISS') DEAL_DT"   
			+"                   ,DECODE(A.APLSTATUS, 'O1', '1', 'D1', '2', '0') DEAL_DIVIDER"   
			+"                   ,A.RC_AMT USE_POINT"   
			+"                   ,TO_CHAR(A.APLDATE, 'YYYYMMDD') APPROVAL_DT"   
			+"                   ,NVL(A.C_APLNO, ' ') APPROVAL_NO"   
			+"                   ,A.APLORDERNO DEAL_NO"   
			+"                   ,A.APLONLINEID MERCHANTID"   
			+"               FROM RC_APPROVAL A"   
			+"                  , GIFTEXTEND E"   
			+"              WHERE A.GIFT_NO = E.GIFT_NO"   
			+"                AND A.APLONLINEID = 'gsrpoppoint'"   
			+"          <if test=\"dateType.equals('DATE-0001')\">"
            +"                        AND    SALESDATE  BETWEEN TO_CHAR(TO_DATE(#{startDate}),'YYYYMMDD') AND TO_CHAR(TO_DATE(#{endDate}),'YYYYMMDD')" // 영업일자
			+"          </if>"
			+"          <if test=\"dateType.equals('DATE-0002')\">"
            +"                        AND    APLDATE    BETWEEN TO_CHAR(TO_DATE(#{startDate}),'YYYYMMDD') AND TO_CHAR(TO_DATE(#{endDate}) ,'YYYYMMDD')"  // 승인일자	        
            +"          </if>"    
            +"          <if test=\"orderNo != null and !orderNo.equals('')\">"
            +"                AND A.C_APLNO     = #{orderNo}"            
            +"          </if>"                  
			+"                AND A.PAY_METHDO IN ('2', 'A2')"   
			+"                AND 'GSPOINT'     = DECODE(#{jobDivider},NULL,'GSPOINT',#{jobDivider})"   
			+"             ) B"   
			+"          ON A.APPROVAL_NO  = B.APPROVAL_NO"   
			+"         AND A.DEAL_DIVIDER = B.DEAL_DIVIDER"
			+"         ) X"
			+" </script>"
			;	
	
	public static final String HM_INCONSISTENCY_SELECT_TOTAL_CNT_SQL ="<script>"
			+"with DATE_TMP AS ("
			+"		   SELECT TO_CHAR(TO_DATE(#{startDate} , 'YYYYMMDD') + LEVEL -1 , 'YYYYMMDD') SEARCHDATE"
			+"		     FROM DUAL"
			+"		  CONNECT BY LEVEL &lt;= TO_DATE(#{endDate}, 'YYYYMMDD')+1 - TO_DATE(#{startDate} , 'YYYYMMDD')"
			+"		 )"
			+" SELECT COUNT(1) count"
			+" FROM ("
	        +"       SELECT 1"
			+"          FROM SETTLE_HM A"   
			+"              ,SETTLE_RESULT B"
			+"              ,DATE_TMP C"
			+"         WHERE 1 = 1"
			+"           AND A.DEAL_DT = C.SEARCHDATE"
			+"          <if test=\"dealType != null and !dealType.equals('')\">"
			+"           AND A.STATUS = #{dealType}"
			+"          </if>"
            +"          <if test=\"orderNo != null and !orderNo.equals('')\">"
            +"           AND A.ORDER_NO = #{orderNo}"            
            +"          </if>"   			
			+"           AND B.JOB_DIVIDER = #{jobDivider}"   
			+"           AND B.SETTLE_SEQ  = A.SEQ"   
			+"           AND B.WORK_DT     = A.WORK_DT"   
			+"           AND B.STATUS     IN ('STS-0002' , 'STS-0005')"   
			+"       UNION ALL"
			+"        SELECT 1"
			+"          FROM ("   
			+"                  SELECT *"   
			+"                    FROM SETTLE_RESULT"   
			+"                   WHERE JOB_DIVIDER = #{jobDivider}"   
			+"                     AND STATUS      = 'STS-0003'"
			+"          <if test=\"dealType != null and !dealType.equals('')\">"
			+"                     AND DEAL_TYPE = #{dealType}"
			+"          </if>"			
            +"          <if test=\"orderNo != null and !orderNo.equals('')\">"
            +"                     AND ORDER_NO  = #{orderNo}"            
            +"          </if>"      			
			+"                ) A"   
			+"           INNER JOIN"   
			+"           ("   
			+"             SELECT *"   
			+"               FROM ORDERLIST A"   
			+"              WHERE M_ID = 'happymoney_pop'"
            +"                AND O_DATE  BETWEEN TO_CHAR(TO_DATE(#{startDate}),'YYYYMMDD') AND TO_CHAR(TO_DATE(#{endDate}),'YYYYMMDD')" // 영업일자
            +"          <if test=\"orderNo != null and !orderNo.equals('')\">"
            +"                AND M_ONO   = #{orderNo}"            
            +"          </if>"
			+"          <if test=\"dealType != null and !dealType.equals('')\">"
			+"                AND O_RESULT = #{dealType}"
			+"          </if>"            
			+"             ) B"   
			+"          ON A.ORDER_NO  = B.M_ONO"   
			+"         AND A.DEAL_TYPE = B.O_RESULT"
			+"         ) X"
			+" </script>"
			;		
	
	@Resource(name="approvalDataSource")
	@Select(GS_STATISTICS_SELECT_SQL)
	public List<GsSettlementStatistics> gsStatisticsSelect(@Param("jobDivider") String jobDivider, @Param("startDate") String startDate,@Param("endDate") String endDate);
	
	@Resource(name="approvalDataSource")
	@Select(GS_POINT_STATISTICS_SELECT_SQL)
	public List<GsSettlementStatistics> gspointStatisticsSelect(@Param("jobDivider") String jobDivider, @Param("startDate") String startDate,@Param("endDate") String endDate);
	
	@Resource(name="approvalDataSource")
	@Select(HM_STATISTICS_SELECT_SQL)
	public List<GsSettlementStatistics> hmStatisticsSelect(@Param("jobDivider") String jobDivider, @Param("startDate") String startDate,@Param("endDate") String endDate);
	
	@Resource(name="approvalDataSource")
	@Select(GS_SM_ERROR_DETAIL_SELECT_SQL)
	public List<GsSettlementErrorDetail> gsSmErrorDetailSelect(@Param("jobDivider") String jobDivider, @Param("workDt") String workDt, @Param("offset") int offset , @Param("limit")int limit);
	
	@Resource(name="approvalDataSource")
	@Select(GS_POP_ERROR_DETAIL_SELECT_SQL)
	public List<GsSettlementErrorDetail> gsPopErrorDetailSelect(@Param("jobDivider") String jobDivider, @Param("workDt") String workDt, @Param("offset") int offset , @Param("limit")int limit);
	
	@Resource(name="approvalDataSource")
	@Select(GSHB_ERROR_DETAIL_SELECT_SQL)
	public List<GsSettlementErrorDetail> gshbErrorDetailSelect(@Param("jobDivider") String jobDivider, @Param("workDt") String workDt, @Param("offset") int offset , @Param("limit")int limit);
	
	@Resource(name="approvalDataSource")
	@Select(GS_POINT_ERROR_DETAIL_SELECT_SQL)
	public List<GsSettlementErrorDetail> gsPointErrorDetailSelect(@Param("jobDivider") String jobDivider, @Param("workDt") String workDt, @Param("offset") int offset , @Param("limit")int limit);
	
	@Resource(name="approvalDataSource")
	@Select(HM_ERROR_DETAIL_SELECT_SQL)
	public List<GsSettlementErrorDetail> hmErrorDetailSelect(@Param("jobDivider") String jobDivider, @Param("workDt") String workDt, @Param("offset") int offset , @Param("limit")int limit);
	
	@Resource(name="approvalDataSource")
	@Select(GSSM_ERROR_DETAIL_SELECT_TOTAL_CNT_SQL)
	public Summary gsSmErrorDetailSelectTotlCnt(@Param("jobDivider")String jobDivider,@Param("workDt") String workDt, @Param("offset")int offset, @Param("limit")int limit);
	
	@Resource(name="approvalDataSource")
	@Select(GSPOP_ERROR_DETAIL_SELECT_TOTAL_CNT_SQL)
	public Summary gsPopErrorDetailSelectTotlCnt(@Param("jobDivider")String jobDivider,@Param("workDt") String workDt, @Param("offset")int offset, @Param("limit")int limit);
	
	@Resource(name="approvalDataSource")
	@Select(GSHB_ERROR_DETAIL_SELECT_TOTAL_CNT_SQL)
	public Summary gshbErrorDetailSelectTotlCnt(@Param("jobDivider")String jobDivider,@Param("workDt") String workDt, @Param("offset")int offset, @Param("limit")int limit);
	
	@Resource(name="approvalDataSource")
	@Select(GS_POINT_ERROR_DETAIL_SELECT_TOTAL_CNT_SQL)
	public Summary gsPointErrorDetailSelectTotlCnt(@Param("jobDivider")String jobDivider,@Param("workDt") String workDt, @Param("offset")int offset, @Param("limit")int limit);
	
	@Resource(name="approvalDataSource")
	@Select(GS_ERROR_DETAIL_SELECT_ALL_SQL)
	public List<GsSettlementErrorDetail> gsErrorDetailSelectAll(@Param("jobDivider") String jobDivider, @Param("workDt") String workDt);
	
	@Resource(name="approvalDataSource")
	@Select(HM_ERROR_DETAIL_SELECT_SQL_CNT)
	public Summary hmErrorDetailSelectTotlCnt(@Param("jobDivider")String jobDivider,@Param("workDt") String workDt, @Param("offset")int offset, @Param("limit")int limit);
	
	
	@Resource(name="approvalDataSource")
	@Select(GS_POP_INCONSISTENCY_SELECT_SQL)
	public List<GsSettlementErrorDetail> gsPopInconsistencySelect(@Param("jobDivider") String jobDivider, @Param("startDate") String startDate
			, @Param("endDate") String endDate , @Param("dateType") String dateType
			, @Param("dealType") String dealType , @Param("dealDivider") String dealDivider
			, @Param("orderNo") String orderNo 		
			, @Param("offset")int offset, @Param("limit")int limit
			, @Param("isExcel") String isExcel	
			);
	
	@Resource(name="approvalDataSource")
	@Select(GSHB_INCONSISTENCY_SELECT_SQL)
	public List<GsSettlementErrorDetail> gshbInconsistencySelect(@Param("jobDivider") String jobDivider, @Param("startDate") String startDate
			, @Param("endDate") String endDate , @Param("dateType") String dateType
			, @Param("dealType") String dealType , @Param("dealDivider") String dealDivider
			, @Param("orderNo") String orderNo
			, @Param("offset")int offset, @Param("limit")int limit
			, @Param("isExcel") String isExcel	
			);
	
	@Resource(name="approvalDataSource")
	@Select(GS_SM_INCONSISTENCY_SELECT_SQL)
	public List<GsSettlementErrorDetail> gsSmInconsistencySelect(@Param("jobDivider") String jobDivider, @Param("startDate") String startDate
			, @Param("endDate") String endDate , @Param("dateType") String dateType
			, @Param("dealType") String dealType , @Param("dealDivider") String dealDivider
			, @Param("orderNo") String orderNo
			, @Param("offset")int offset, @Param("limit")int limit
			, @Param("isExcel") String isExcel	
			);
	@Resource(name="approvalDataSource")
	@Select(GS_POINT_INCONSISTENCY_SELECT_SQL)
	public List<GsSettlementErrorDetail> gsPointInconsistencySelect(@Param("jobDivider") String jobDivider, @Param("startDate") String startDate
			, @Param("endDate") String endDate , @Param("dateType") String dateType
			, @Param("dealType") String dealType , @Param("dealDivider") String dealDivider
			, @Param("orderNo") String orderNo
			, @Param("offset")int offset, @Param("limit")int limit
			, @Param("isExcel") String isExcel	
			);
	
	@Resource(name="approvalDataSource")
	@Select(HM_INCONSISTENCY_SELECT_SQL)
	public List<GsSettlementErrorDetail> hmInconsistencySelect(@Param("jobDivider") String jobDivider, @Param("startDate") String startDate
			, @Param("endDate") String endDate , @Param("dealType") String dealType
			, @Param("orderNo") String orderNo , @Param("offset")int offset, @Param("limit")int limit
			);
	
	@Resource(name="approvalDataSource")
	@Select(GS_SM_INCONSISTENCY_SELECT_TOTAL_CNT_SQL)
	public Summary gsSmInconsistencySelectTotlCnt(@Param("jobDivider") String jobDivider, @Param("startDate") String startDate
			, @Param("endDate") String endDate , @Param("dateType") String dateType
			, @Param("dealType") String dealType , @Param("dealDivider") String dealDivider
			, @Param("orderNo") String orderNo 
			, @Param("offset")int offset, @Param("limit")int limit
			);
	
	@Resource(name="approvalDataSource")
	@Select(GS_POP_INCONSISTENCY_SELECT_TOTAL_CNT_SQL)
	public Summary gsPopInconsistencySelectTotlCnt(@Param("jobDivider") String jobDivider, @Param("startDate") String startDate
			, @Param("endDate") String endDate , @Param("dateType") String dateType
			, @Param("dealType") String dealType , @Param("dealDivider") String dealDivider
			, @Param("orderNo") String orderNo 
			, @Param("offset")int offset, @Param("limit")int limit
			);
	
	@Resource(name="approvalDataSource")
	@Select(GSHB_INCONSISTENCY_SELECT_TOTAL_CNT_SQL)
	public Summary gshbInconsistencySelectTotlCnt(@Param("jobDivider") String jobDivider, @Param("startDate") String startDate
			, @Param("endDate") String endDate , @Param("dateType") String dateType
			, @Param("dealType") String dealType , @Param("dealDivider") String dealDivider
			, @Param("orderNo") String orderNo 
			, @Param("offset")int offset, @Param("limit")int limit
			);
	
	@Resource(name="approvalDataSource")
	@Select(GS_POINT_INCONSISTENCY_SELECT_TOTAL_CNT_SQL)
	public Summary gsPointInconsistencySelectTotlCnt(@Param("jobDivider") String jobDivider, @Param("startDate") String startDate
			, @Param("endDate") String endDate , @Param("dateType") String dateType
			, @Param("dealType") String dealType , @Param("dealDivider") String dealDivider
			, @Param("orderNo") String orderNo 
			, @Param("offset")int offset, @Param("limit")int limit
			);
	
	@Resource(name="approvalDataSource")
	@Select(HM_INCONSISTENCY_SELECT_TOTAL_CNT_SQL)
	public Summary hmInconsistencySelectTotlCnt(@Param("jobDivider") String jobDivider, @Param("startDate") String startDate
			, @Param("endDate") String endDate , @Param("dealType") String deal
			, @Param("orderNo") String orderNo , @Param("offset")int offset, @Param("limit")int limit
			);
}
